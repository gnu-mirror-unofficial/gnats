<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- This manual is for GNU GNATS
(version 4.2.0, 8 August 2006),
the GNU Bug Tracking System.

Copyright C 1993, 1995, 2001, 2002, 2003, 2006 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and
modify this GNU Manual, like GNU software.  Copies published by the
Free Software Foundation raise funds for GNU development."

 -->
<!-- Created on March 3, 2015 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Keeping Track: GNU GNATS No value for VERSION: 3. Installing GNATS</title>

<meta name="description" content="Keeping Track: GNU GNATS No value for VERSION: 3. Installing GNATS">
<meta name="keywords" content="Keeping Track: GNU GNATS No value for VERSION: 3. Installing GNATS">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Installation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="GNATS-user-tools.html#Emacs-customization" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configure-and-make" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="GNATS-user-tools.html#GNATS-user-tools" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installing-GNATS"></a>
<h1 class="chapter">3. Installing <small>GNATS</small></h1>

<a name="index-installing-GNATS"></a>
<a name="index-configuring--GNATS"></a>
<a name="index-setting-up-GNATS"></a>
<a name="index-building-GNATS"></a>

<p>See also <a href="Locations.html#Locations">Where the tools and utilities reside</a>.
</p>
<p>There are several steps you need to follow to fully configure and
install <small>GNATS</small> on your system.  You need <code>root</code> access in order
to create a new account for <code>gnats</code> and to install the <small>GNATS</small>
utilities.  You may need <code>root</code> access on some systems in order to
set up mail aliases and to allow this new account access to
<code>cron</code> and <code>at</code>.
</p>
<p>If you are updating an older version of <small>GNATS</small> rather than installing
from scratch, see <a href="#Upgrading">Upgrading from older versions</a>.
</p>
<p><small>GNATS</small> installation relies on two other freely available software
packages, which should be installed before you go on to configure and
build <small>GNATS</small>.  These are <small>GNU</small> <code>make</code> and <code>Texinfo</code>
(version 4.2 or higher).  Both are available from the <small>GNU</small> FTP site at
<a href="ftp://ftp.gnu.org">ftp://ftp.gnu.org</a>.
</p>
<p>To build and install <small>GNATS</small>, you must:
</p>
<ul>
<li>
Run <code>configure</code>, with correct options if the defaults are
unsuitable for your site.  See section <a href="#Configure-and-make">Configuring and compiling the software</a>.  Default installation locations are in
<a href="Locations.html#Locations">Where <small>GNATS</small> lives</a>.

</li><li>
Compile the <small>GNATS</small> programs on your system.  See section <a href="#Configure-and-make">Configuring and compiling the software</a>.

</li><li>
Create an initial database by using the <code>mkdb</code> command.
See section <a href="#Setting-up-the-default-database">Installing the default database</a>.

</li><li>
Set up periodic jobs, using cron, to handle Problem Reports arriving by
mail.  See section <a href="#Setting-up-periodic-jobs">Setting up periodic jobs</a>.

</li><li>
Set up mail aliases for <small>GNATS</small>.  See section <a href="#Aliases">Setting up mail aliases</a>.

</li><li>
Install the <small>GNATS</small> tools and utilities locally, and install the user
tools (<code>query-pr</code>, <code>edit-pr</code>, <code>send-pr</code>) on every machine
in your local network.  See section <a href="#Installing-tools">Installing the user tools</a>.

</li><li>
Install the <small>GNATS</small> daemon &lsquo;<tt>gnatsd</tt>&rsquo;.  See section <a href="#Installing-the-daemon">Installing the daemon</a>.

</li><li>
If there are people outside your organization who will be submitting
PRs or who are supposed to be able to query and/or edit PRs, you may
need to instruct them to obtain and build the <small>GNATS</small> tools
<code>query-pr</code>, <code>edit-pr</code> and <code>send-pr</code> for their systems.
However, for many sites, setting up a remote access interface to
<small>GNATS</small>, such as Gnatsweb is a better solution since this requires
no configuration on the remote side.
</li></ul>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Configure-and-make">3.1 Configuring and compiling the software</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Installing-utils">3.2 Installing the utilities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Setting-up-the-default-database">3.3 Installing the default database</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Setting up the default database
</td></tr>
<tr><td align="left" valign="top"><a href="#Setting-up-periodic-jobs">3.4 Setting up periodic jobs</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Aliases">3.5 Setting up mail aliases</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Installing-the-daemon">3.6 Installing the daemon</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Installing-tools">3.7 Installing the user tools</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Upgrading">3.8 Upgrading from older versions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>

<hr size="6">
<a name="Configure-and-make"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installing-utils" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Configuring-and-compiling-the-software"></a>
<h2 class="section">3.1 Configuring and compiling the software</h2>
<a name="index-unpacking-the-distribution"></a>
<a name="index-configuring-and-compiling-the-software"></a>
<a name="index-compiling-the-software"></a>
<a name="index-configure"></a>
<a name="index-make"></a>

<ol>
<li>
First, unpack your distribution.  We provide source code in a <code>tar</code>
file which was compressed using <code>gzip</code>.  The code can be extracted
into a directory <var>unpackdir</var> using

<table><tr><td>&nbsp;</td><td><pre class="smallexample">cd <var>unpackdir</var>
gunzip gnats-4.2.0.tar.gz
tar xvf gnats-4.2.0.tar
</pre></td></tr></table>

<p>The sources reside in a directory called &lsquo;<tt>gnats-4.2.0</tt>&rsquo;
when unpacked.  We call this the <em>top level</em> of the source
directory, or <em>srcdir</em>.  The sources for the <small>GNATS</small> tools are in
the subdirectory &lsquo;<tt>gnats-4.2.0/gnats/*</tt>&rsquo;.  Lists of files
included in the distribution are in each directory in the file
&lsquo;<tt>MANIFEST</tt>&rsquo;.
</p>
<a name="index-lisp-file-installation"></a>
<a name="index-Emacs-lisp-file-installation"></a>
</li><li>
As of <small>GNATS</small> version 4, having Emacs installed on the <small>GNATS</small>
server is no longer a requirement.  If you do not have Emacs installed,
disregard this step altogether.

<p>You may wish to alter the installation directory for the Emacs lisp
files.  If your Emacs lisp library is not in
&lsquo;<tt><var>prefix</var>/share/emacs/site-lisp</tt>&rsquo;, edit the file
<code><var>srcdir</var>/gnats/Makefile.in</code>.  Change the variable
<code>lispdir</code> from &lsquo;<tt><var>prefix</var>/emacs/site-lisp</tt>&rsquo; to the
directory containing your Emacs lisp library.  For information on
<var>prefix</var>, see <a href="Locations.html#prefix"><var>prefix</var></a>.
</p>
</li><li>
<a name="index-creating-an-account-for-the-GNATS-user"></a>
Create an account for the <code>gnats</code> user.  You can actually name this
user whatever you want to, as long as it is a valid username on your
system, but we strongly recommend that you call the user <code>gnats</code>.
If you do decide to give it some other name, remember to use the option
<code>--enable-gnats-user</code> when running <code>configure</code> below.  Below, we
will anyway refer to this user by the name <code>gnats</code>.

<p>This user must have an entry in the file &lsquo;<tt>/etc/passwd</tt>&rsquo;.  As for
ordinary users, create a standard home directory for the <code>gnats</code>
user.  The default <code>PATH</code> for this user should contain
&lsquo;<tt><var>exec-prefix</var>/bin</tt>&rsquo; and
&lsquo;<tt><var>exec-prefix</var>/libexec/gnats</tt>&rsquo;.  The <var>exec-prefix</var> value
is configurable with the <code>--exec-prefix</code> configure option described
below, but for standard installations, these two directories correspond
to &lsquo;<tt>/usr/local/bin</tt>&rsquo; and &lsquo;<tt>/usr/local/libexec/gnats</tt>&rsquo;.
</p>
</li><li>
Run <code>configure</code>.  You can nearly always run <code>configure</code> with
the simple command

<table><tr><td>&nbsp;</td><td><pre class="example">./configure
</pre></td></tr></table>

<p>and the &ldquo;Right Thing&rdquo; happens:
</p>
<ul>
<li>
<small>GNATS</small> is configured in the same directory you unpacked it in;

</li><li>
when built, <small>GNATS</small> runs on the machine you&rsquo;re building it on;

</li><li>
when installed, files are installed under &lsquo;<tt>/usr/local</tt>&rsquo;
(see section <a href="Locations.html#Locations">Where <small>GNATS</small> lives</a>).

</li><li>
all <small>GNATS</small> utilities operate on the <em>default database</em>, assumed
to be named <em>default</em> and to be located in
&lsquo;<tt>/usr/local/com/default</tt>&rsquo;, unless you invoke the utilities with
<code>-d</code> <var>databasename</var> or <code>--directory=</code><var>databasename</var>, or
set the <var>GNATSDB</var> environment variable to point to some other database.
</li></ul>

<a name="index-configure-1"></a>
<p>The most common options to <code>configure</code> are listed below:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">configure [ --prefix=<var>prefix</var> ]
          [ --exec-prefix=<var>exec-prefix</var> ]
          [ --enable-gnats-service=<var>service-name</var> ]
          [ --enable-gnats-user=<var>username</var> ]
          [ --enable-gnatsd-user-access-file=<var>path</var> ]
          [ --enable-gnatsd-host-access-file=<var>path</var> ]
          [ --enable-gnats-dblist-file=<var>path</var> ]
          [ --enable-gnats-default-db=<var>path</var> ]
          [ --with-kerberos ] [ --with-krb4 ]
          [ --verbose ]
</pre></td></tr></table>

<dl compact="compact">
<dd><a name="index-prefix"></a>
</dd>
<dt> <code>--prefix=<var>prefix</var></code></dt>
<dd><p>All host-independent programs and files are to be installed under
<var>prefix</var>.  (Host-dependent programs and files are also installed in
<var>prefix</var> by default.)  The default for <var>prefix</var> is
&lsquo;<tt>/usr/local</tt>&rsquo;.  See section <a href="Locations.html#Locations">Where <small>GNATS</small> lives</a>.
</p>
<a name="index-exec_002dprefix"></a>
</dd>
<dt> <code>--exec-prefix=<var>exec-prefix</var></code></dt>
<dd><p>All host-dependent programs and files are to be installed under
<var>exec-prefix</var>.  The default for <var>exec-prefix</var> is <var>prefix</var>.
See section <a href="Locations.html#Locations">Where <small>GNATS</small> lives</a>.
</p>
<a name="index-_002d_002denable_002dgnats_002dservice"></a>
</dd>
<dt> <code>--enable-gnats-service=<var>service-name</var></code></dt>
<dd><p>Set <var>service-name</var> to be the <small>GNATS</small> network service.  Default
name is <var>support</var>.
</p>
<a name="index-_002d_002denable_002dgnats_002duser"></a>
</dd>
<dt> <code>--enable-gnats-user=<var>username</var></code></dt>
<dd><p>Set <var>username</var> to be the user name for <small>GNATS</small>.  Default username
is <var>gnats</var>.
</p>
<a name="index-_002d_002denable_002dgnatsd_002duser_002daccess_002dfile"></a>
</dd>
<dt> <code>--enable-gnatsd-user-access-file=<var>path</var></code></dt>
<dd><p>Set global (across all databases) gnatsd user access file to
<var>path</var>. Default is
&lsquo;<tt><var>/usr/local/etc/gnats/gnatsd.user_access</var></tt>&rsquo;.  Per-database
user access permissions are set in a &lsquo;<tt>gnatsd.user_access</tt>&rsquo; file in
the &lsquo;<tt>gnats-adm</tt>&rsquo; subdirectory of each database.
</p>
<a name="index-_002d_002denable_002dgnatsd_002dhost_002daccess_002dfile"></a>
</dd>
<dt> <code>--enable-gnatsd-host-access-file=<var>path</var></code></dt>
<dd><p>Set global (across all databases) gnatsd host access file to
<var>path</var>. Default is
&lsquo;<tt>/usr/local/etc/gnats/gnatsd_host.access</tt>&rsquo;.  There is currently
no way to specify host access permissions on a per-database basis.
</p>
<a name="index-_002d_002denable_002dgnats_002ddblist_002dfile"></a>
</dd>
<dt> <code>--enable-gnats-dblist-file=<var>path</var></code></dt>
<dd><p>Specify the file containing the list of databases.
</p>
<p>Default is &lsquo;<tt><var>prefix</var>/etc/gnats/databases</tt>&rsquo;.
</p>
<a name="index-_002d_002denable_002dgnats_002ddefault_002ddb"></a>
</dd>
<dt> <code>--enable-gnats-default-db=<var>path</var></code></dt>
<dd><p>Specify the default database to use when <small>GNATS</small> tools are invoked
without the <code>-d</code> or <code>--databasename</code> option, and when the
<var>GNATSDB</var> envrionment variable hasn&rsquo;t been set. Default is
&lsquo;<tt>/<var>prefix</var>/com/gnatsdb</tt>&rsquo;.
</p>
<a name="index-_002d_002dwith_002dkerberos"></a>
</dd>
<dt> <code>--with-kerberos</code></dt>
<dd><p>Include code for Kerberos authentication.
</p>
<a name="index-_002d_002dwith_002dkrb4"></a>
</dd>
<dt> <code>--with-krb4</code></dt>
<dd><p>Support Kerberos 4.
</p>
</dd>
<dt> <code>--verbose</code></dt>
<dd><p>Give verbose output while <code>configure</code> runs.
</p></dd>
</dl>

<p><code>configure</code> supports several more options which allow you to
specify in great detail where files are installed. For a complete list
of options, run <code>./configure --help</code> in the source directory.
</p>
<a name="index-building-in-a-different-directory"></a>
<a name="index-objdir"></a>
<p>You can build <small>GNATS</small> in a different directory (<var>objdir</var>) from the
source code by calling the <code>configure</code> program from the new
directory, as in
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">mkdir <var>objdir</var>
cd <var>objdir</var>
<var>srcdir</var>/configure &hellip;
</pre></td></tr></table>

<p>By default, <code>make</code> compiles the programs in the same directory
as the sources (<var>srcdir</var>).
</p>
</li><li>
Make sure you have <small>GNU</small> <code>make</code>, then run 

<table><tr><td>&nbsp;</td><td><pre class="smallexample">make all info
</pre></td></tr></table>

<p>from the directory where <code>configure</code> created a &lsquo;<tt>Makefile</tt>&rsquo;
(this is <var>objdir</var> if you used it, otherwise <var>srcdir</var>.)  These
targets indicate:
</p>
<dl compact="compact">
<dt> <code>all</code></dt>
<dd><p>Compile all programs
</p>
</dd>
<dt> <code>info</code></dt>
<dd><p>Create &lsquo;<samp>info</samp>&rsquo; files using <code>makeinfo</code>.
</p></dd>
</dl>
</li></ol>

<hr size="6">
<a name="Installing-utils"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Configure-and-make" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Setting-up-the-default-database" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installing-the-utilities"></a>
<h2 class="section">3.2 Installing the utilities</h2>
<a name="index-installing-the-utilities"></a>

<p>The following steps are necessary for a complete installation.  You may
need <code>root</code> access for these.
</p>
<ol>
<li>
Install the utilities by invoking

<table><tr><td>&nbsp;</td><td><pre class="smallexample">make install install-info
</pre></td></tr></table>

<p>These targets indicate:
</p>
<dl compact="compact">
<dt> <code>install</code></dt>
<dd><p>Installs all programs into their configured locations
(see section <a href="Locations.html#Locations">Where <small>GNATS</small> lives</a>).
</p>
</dd>
<dt> <code>install-info</code></dt>
<dd><p>Installs &lsquo;<samp>info</samp>&rsquo; files into their configured locations
(see section <a href="Locations.html#Locations">Where <small>GNATS</small> lives</a>).
</p></dd>
</dl>

<p>After you have installed <small>GNATS</small>, you can remove the object files with
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">make clean
</pre></td></tr></table>

<a name="index-autoload-commands"></a>
<a name="index-loading-_002eel-files"></a>
<a name="index-Emacs-functions"></a>
</li><li>
If you do not have Emacs installed on your <small>GNATS</small> server, this step
should be skipped.

<p>Place the following lines in the file &lsquo;<tt>default.el</tt>&rsquo; in your Emacs
lisp library, or instruct your local responsible parties to place the
lines in their &lsquo;<tt>.emacs</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">(autoload 'send-pr &quot;gnats&quot;
   &quot;Command to create and send a problem report.&quot; t)
(autoload 'edit-pr &quot;gnats&quot; 
   &quot;Command to edit a problem report.&quot; t)
(autoload 'view-pr &quot;gnats&quot;
   &quot;Command to view a problem report.&quot; t)
(autoload 'query-pr &quot;gnats&quot;
   &quot;Command to query information about problem reports.&quot; t)
(autoload 'unlock-pr &quot;gnats&quot;
   &quot;Unlock a problem report.&quot; t)
(autoload 'gnats-dbconfig-mode &quot;gnats&quot;
  &quot;Major mode for editing the `dbconfig' GNATS configuration file.&quot; t)
(add-to-list 'auto-mode-alist '(&quot;\\&lt;dbconfig$&quot; . gnats-dbconfig-mode))  
</pre></td></tr></table>

<a name="index-prepare-send_002dpr_002econf"></a>
</li><li>
If you want people who are logged into the <small>GNATS</small> server itself to
be able to use the <code>send-pr</code> tool to submit problem reports, you
need to create a configuration file for <code>send-pr</code> on the server.
See section <a href="Management.html#send_002dpr_002econf-file">The send-pr.conf configuration file</a>.

</li></ol>

<hr size="6">
<a name="Setting-up-the-default-database"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installing-utils" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Setting-up-periodic-jobs" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installing-the-default-database"></a>
<h2 class="section">3.3 Installing the default database</h2>

<p>For the following steps, log in as the user <code>gnats</code>.
</p>
<p>We are now going to initialize the default <small>GNATS</small> database.  Run the
following command:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">mkdb default
</pre></td></tr></table>

<p>This creates a database named <code>default</code>, with all its data stored
below the directory &lsquo;<tt><var>prefix</var>/com/gnatsdb</tt>&rsquo;, in a default
installation this corresponds to &lsquo;<tt>/usr/local/com/gnatsdb</tt>&rsquo;.  If
you specified the <code>--enable-gnats-default-db</code> option when running
configure, the default database will be created under the directory you
specified instead.  <code>mkdb</code> creates the database directory itself,
together with three different subdirectories<a name="DOCF2" href="gnats_fot.html#FOOT2">(2)</a>:
</p>
<ul>
<li> A directory for the mandatory <small>GNATS</small> category <var>pending</var>.

</li><li> A &lsquo;<tt>gnats-queue</tt>&rsquo; directory for queueing new messages to
<small>GNATS</small> before they are processed by <code>file-pr</code>.

</li><li> The administrative directory &lsquo;<tt>gnats-adm</tt>&rsquo;. This directory is
populated with default configuration files from the
&lsquo;<tt><var>prefix</var>/etc/gnats/defaults</tt>&rsquo; directory.
</li></ul>

<p>The next configuration step is to edit the default files copied to the
database&rsquo;s &lsquo;<tt>gnats-adm</tt>&rsquo; directory by <code>mkdb</code>.
</p>
<p>The default &lsquo;<tt>dbconfig</tt>&rsquo; file installed by <code>mkdb</code> provides a
good basis for many <small>GNATS</small> databases. The default file causes
similar behaviour to the 3.x versions of <small>GNATS</small>. However, even if
this might be precisely what you want, you should still go through the
file and check that the default settings suit your needs.
See section <a href="Management.html#dbconfig-file">The &lsquo;<tt>dbconfig</tt>&rsquo; file</a>.
</p>
<p>Then edit the files &lsquo;<tt>categories</tt>&rsquo;, &lsquo;<tt>responsible</tt>&rsquo;, and
&lsquo;<tt>submitters</tt>&rsquo; in the &lsquo;<tt>gnats-adm</tt>&rsquo; directory (see section <a href="Management.html#Other-config-files">Other database-specific config files</a>) to reflect your
local needs.  For special configurations, you may also have to edit the
&lsquo;<tt>states</tt>&rsquo; and &lsquo;<tt>classes</tt>&rsquo; files.
</p>
<p>If you used the <code>--enable-gnats-default-db</code> option in the pre-build
configure to change the location of the default database, you need to
edit the &lsquo;<tt>databases</tt>&rsquo; config file, see <a href="Management.html#databases-file">The &lsquo;<tt>databases file</tt>&rsquo;</a>.  This file is by default located in the
&lsquo;<tt><var>prefix</var>/etc/gnats</tt>&rsquo; directory, but may have been changed
by the option <code>--enable-gnats-dblist-file</code> option during configure.
</p>
<a name="index-cron"></a>
<a name="index-at"></a>
<hr size="6">
<a name="Setting-up-periodic-jobs"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Setting-up-the-default-database" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Aliases" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Setting-up-periodic-jobs-1"></a>
<h2 class="section">3.4 Setting up periodic jobs</h2>

<p>Allow the new user <code>gnats</code> access to <code>cron</code> and <code>at</code>.  To
do this, add the name <code>gnats</code> to the files &lsquo;<tt>cron.allow</tt>&rsquo; and
&lsquo;<tt>at.allow</tt>&rsquo;, which normally reside in the directory
&lsquo;<tt>/var/spool/cron</tt>&rsquo;.  If these files do not exist, make sure
<code>gnats</code> does not appear in either of the files &lsquo;<tt>cron.deny</tt>&rsquo;
and &lsquo;<tt>at.deny</tt>&rsquo; (in the same directory).  If you changed the name
of the <small>GNATS</small> user during configure, remember to substitute as
appropriate in the previous steps.
</p>
<a name="index-crontab"></a>
<p>Create a <code>crontab</code> entry that periodically runs the program
<code>queue-pr</code> with the &lsquo;<samp>--run</samp>&rsquo; option
(see section <a href="Management.html#queue_002dpr"><code>queue-pr</code></a>).  For example, to run
&lsquo;<samp>queue-pr --run</samp>&rsquo; every ten minutes, create a file called
&lsquo;<tt>.mycron</tt>&rsquo; in the home directory of the user <code>gnats</code> which
contains the line:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">0,10,20,30,40,50 * * * * <var>exec-prefix</var>/libexec/gnats/queue-pr --run
</pre></td></tr></table>

<p>(Specify the full path name for <code>queue-pr</code>.)  Then run
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">crontab .mycron
</pre></td></tr></table>

<p>See the <code>man</code> pages for <code>cron</code> and <code>crontab</code> for details
on using <code>cron</code>.
</p>
<hr size="6">
<a name="Aliases"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Setting-up-periodic-jobs" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installing-the-daemon" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Setting-up-mail-aliases"></a>
<h2 class="section">3.5 Setting up mail aliases</h2>
<a name="index-mail-aliases"></a>
<a name="index-aliases"></a>

<p>The following mail aliases must be added on the machine where the
<small>GNATS</small> server is installed.  The instructions below are for Sendmail
or Sendmail-like mail systems.  If these instructions don&rsquo;t fit your
system, particularly if you do not have an &lsquo;<tt>aliases</tt>&rsquo; file, ask your
mail administrator for advice.
</p>
<p>The following aliases should be placed in the file
&lsquo;<tt>/etc/aliases</tt>&rsquo;. Yoy may need <code>root</code> access to add these
aliases:
</p>
<ul>
<li>
<a name="index-gnats_002dadmin-alias"></a>
Create an alias for the <small>GNATS</small> administrator.  This address should
point to the address of the person in charge of administrating
<small>GNATS</small>:

<table><tr><td>&nbsp;</td><td><pre class="smallexample">gnats-admin:  <var>address</var>
</pre></td></tr></table>

</li><li>
<a name="index-bug-alias"></a>
<a name="index-incoming-alias-for-Problem-Reports"></a>
<a name="index-alias-for-incoming-Problem-Reports"></a>
<a name="index-queue_002dpr-_002dq"></a>
Create an alias to redirect incoming Problem Reports.  This alias should
redirect incoming mail via a <em>pipe</em> to the program &lsquo;<samp>queue-pr
-q</samp>&rsquo;.  For example, if Problem Reports coming to your site are to arrive
at the address &lsquo;<samp>bugs@your.company.com</samp>&rsquo;, create an alias to the
effect of:

<table><tr><td>&nbsp;</td><td><pre class="smallexample">bugs:  &quot;| <var>exec-prefix</var>/libexec/gnats/queue-pr -q&quot;
</pre></td></tr></table>

<p>This places incoming Problem Reports in
the &lsquo;<tt><var>gnats-queue</var></tt>&rsquo; directory of your database.  Remember to
fill in the full path of the <code>queue-pr</code> command as appropriate for
your installation.
</p>
</li><li>
You may also wish to forward a copy of each incoming Problem Report to a
log.  This can be accomplished with something like:

<table><tr><td>&nbsp;</td><td><pre class="smallexample">bug-q: &quot;| <var>exec-prefix</var>/libexec/gnats/queue-pr -q&quot;
bug-log:  /some/path/bugs.log
bugs:      bug-q, bug-log
</pre></td></tr></table>

<p>This configuration archives incoming Problem Reports in the file
&lsquo;<tt>bug.log</tt>&rsquo;, and also feeds them to the program <code>queue-pr</code>.
(Remember, &lsquo;<tt>bug.log</tt>&rsquo; needs to be world-writable, and should be
pruned regularly; see section <a href="Management.html#Management"><small>GNATS</small> Administration</a>.)  In
order for the log file to protect fully against data loss in case a disk
runs full, try to place it on a different disk volume than the
<small>GNATS</small> database.
</p>
</li><li>
If you want your users to be able to query the database by mail, use the
following alias:

<table><tr><td>&nbsp;</td><td><pre class="smallexample">query-pr: &quot;| <var>exec-prefix</var>/libexec/gnats/mail-query&quot;
</pre></td></tr></table>

<p>The <code>mail-query</code> program uses &lsquo;<samp>--restricted</samp>&rsquo; to search on the
database, and by default only searches for PRs that aren&rsquo;t closed
(see section <a href="GNATS-user-tools.html#query_002dpr">Querying the database</a>).
</p>
</li></ul>

<hr size="6">
<a name="Installing-the-daemon"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Aliases" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installing-tools" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installing-the-daemon-1"></a>
<h2 class="section">3.6 Installing the daemon</h2>
<a name="index-daemon"></a>
<a name="index-using-GNATS-over-a-network"></a>

<p>By default, the daemon and clients are set to use port 1529.  Add the line
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">support		1529/tcp			# GNATS
</pre></td></tr></table>

<p>to your &lsquo;<tt>/etc/services</tt>&rsquo; file.  If you want a different service
name, configure <small>GNATS</small> with
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">--enable-gnats-service=<var>servicename</var>
</pre></td></tr></table>

<p>In your &lsquo;<tt>inetd.conf</tt>&rsquo; file, add the line
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">support	stream	tcp	nowait	gnats	/usr/local/libexec/gnats/gnatsd gnatsd
</pre></td></tr></table>

<p>adjusting the path accordingly if you used configure options to make
changes to the defaults.  To make <code>inetd</code> start spawning the
<small>GNATS</small> daemon when connected on that port, send it a hangup signal
(<code>HUP</code>).
</p>
<p>Some operating systems have replaced <code>inetd</code> with the more modern
<code>xinetd</code>. Instead of editing &lsquo;<tt>inetd.conf</tt>&rsquo;, you should create
the file &lsquo;<tt>/etc/xinetd.d/support</tt>&rsquo;, containing something like the
following:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">service support
{
   disable = no
   socket_type = stream
   protocol = tcp
   wait = no
   user = gnats
   server = /usr/local/libexec/gnats/gnatsd
}
</pre></td></tr></table>

<p>If you specified a different service name when running <code>configure</code>,
you need to give the file the same name as the service name, and you
need to adjust the <code>service</code> line above.  If the <code>--prefix</code> or
<code>--exec-prefix</code> options were passed to <code>configure</code>, adjust the
<code>server</code> line above, and if you used the <code>--enable-gnats-user</code>
option, adjust the <code>user</code> line.
</p>
<p>Then restart <code>xinetd</code> to make the new configuration current.
</p>
<p>If you use an Internet superserver different from <code>inetd</code> or
<code>xinetd</code>, please refer to its documentation for information how
to configure it.
</p>
<p>At this point, you will probably want to set the access permissions of
the different hosts that are going to be accessing your databases.  The
access permissions can currently only be set on a global scale (that is,
across all the databases on a <small>GNATS</small> server).  The location and name
of the global host access configuration file can be set during the
pre-build configure as shown above, but by default the file is
&lsquo;<tt>/usr/local/etc/gnats/gnatsd_host.access</tt>&rsquo;.  It lists the hosts
allowed to access your server, and what their default access levels are.
Each line in the file denotes one server, or one part of a network
domain.  There are three fields on each line, but only two are currently
used.  To grant all hosts from the domain <var>site.com</var> edit access,
use this line:
</p>
<p><var>site.com</var>:<var>edit</var>
</p>
<p>If you run a <small>GNATS</small> web interface or similar tool on the same
machine as the server is running on, you probably want to grant
<var>localhost</var> edit access:
</p>
<p><var>localhost</var>:<var>edit</var>
</p>
<p>If you are using Kerberos, the &lsquo;<tt>gnatsd_host.access</tt>&rsquo; file shows the
sites that don&rsquo;t require Kerberos authentication.
</p>
<p>The third field might in the future be used for things like controlling
what categories, submitter-id&rsquo;s PRs, etc., can be accessed from that
site.  Access attempts that are denied are logged to the syslog messages
file (&lsquo;<tt>/var/adm/messages</tt>&rsquo; on many systems).
</p>

<hr size="6">
<a name="Installing-tools"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installing-the-daemon" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-tools-on-a-local-network" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installing-the-user-tools"></a>
<h2 class="section">3.7 Installing the user tools</h2>
<a name="index-networks"></a>
<a name="index-using-GNATS-over-a-network-1"></a>
<a name="index-configuring-GNATS-on-a-network"></a>

<p>When you install the <small>GNATS</small> utilities, the user tools
<code>send-pr</code>, <code>query-pr</code> and <code>edit-pr</code> are installed on the
server machine.  If your machine is part of a network, however, you may
wish to install the user tools on each machine in the network so that
responsible parties on those machines can submit new Problem Reports,
query the database, and edit existing PRs.  In the following discussion,
machines with the <small>GNATS</small> user tools installed are referred to as
<em>client</em> machines.  In general, there are three distinct types of
client that a <small>GNATS</small> server may have to cater for:
</p>
<ul class="toc">
<li>- Machines that are on the same local network as the
<small>GNATS</small> server, i.e. machines that are under the same
administrative control.

</li><li>- Machines on the general, open Internet.

</li><li>- Machines behind firewalls etc. which deny direct access
over the network to the <small>GNATS</small> server.
</li></ul>

<p>Each type of client requires a different approach when it comes to
providing access.
</p>
<hr size="6">
<a name="User-tools-on-a-local-network"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installing-tools" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-tools-for-remote-users" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installing-tools" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.7.1 User tools on a local network</h3>
<a name="index-using-GNATS-over-a-local-network"></a>
<a name="index-configuring-GNATS-on-a-local-network"></a>

<p>If all the machines involved reside on the same local network as the
<small>GNATS</small> server, you can simply share out the directories on the
server that contain the user tools, by default &lsquo;<tt>/usr/local/bin</tt>&rsquo; and
the directory which contains the &lsquo;<tt>send-pr.conf</tt>&rsquo; configuration file
(see section <a href="Management.html#send_002dpr_002econf-file">The send-pr.conf configuration file</a>), by
default &lsquo;<tt>/usr/local/etc/gnats</tt>&rsquo;.  If you have a heterogeneous
environment, i.e. hosts running different operating systems, you need to
create several shared <small>GNATS</small> installations, one for each platform.
The &lsquo;<tt>send-pr.conf</tt>&rsquo; file is platform-independent, though.
</p>
<p>In order to submit a new PR, <code>send-pr</code> would then be invoked as
follows on the client machines:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">send-pr -d <var>hostname:port:database:username:password</var>
</pre></td></tr></table>

<p>Or by first setting the environment variable <code>GNATSDB</code> as follows
(the exact syntax will vary depending on what shell you use):
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">export GNATSDB=<var>hostname:port:database:username:password</var>
</pre></td></tr></table>

<p>Then, <code>send-pr</code> can simply be invoked without any options.
</p>
<p>The other tools, <code>query-pr</code> and <code>edit-pr</code>, work in similar
ways, honoring the <code>-d</code> option as well as the <code>GNATSDB</code>
environment variable.  See section <a href="GNATS-user-tools.html#GNATS-user-tools">The <small>GNATS</small> User Tools</a>.
</p>
<hr size="6">
<a name="User-tools-for-remote-users"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-tools-on-a-local-network" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Upgrading" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installing-tools" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.7.2 User tools for remote users</h3>
<a name="index-using-GNATS-remotely"></a>
<a name="index-configuring-GNATS-for-remote-users"></a>

<p>When client machines reside on the general Internet, both security and
practical considerations may make it impossible to provide a shared
installation of the <small>GNATS</small> tools.  In this case, you may choose to
only provide access through a web interface such as Gnatsweb.  For
clients that need the <small>GNATS</small> tools, the following needs to be
carried out on the remote machines:
</p>
<ol>
<li> Configure and build <small>GNATS</small> on the client machine

</li><li> Configure <code>send-pr</code> on the client machine
</li></ol>

<p>You should unpack the distribution and run <code>configure</code> on the
client machine in the same way as described in <a href="#Configure-and-make">Configuring and compiling the software</a>.  Note, however, that you
do not need to create a <code>gnats</code> user on the client and you should
not use the <code>make all info</code> command to build.  Instead, issue the
following commands from the top level directory of the source
distribution:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">cd gnats
make install-tools
cd ../send-pr
make all install
</pre></td></tr></table>

<p>This builds and installs the <code>send-pr</code>, <code>query-pr</code> and
<code>edit-pr</code> tools on the client machine.  You should now configure
<code>send-pr</code> by editing the &lsquo;<tt>send-pr.conf</tt>&rsquo; file
(see section <a href="Management.html#send_002dpr_002econf-file">The send-pr.conf configuration file</a>.)
</p>
<p>Users on the client machine can now either use the send-pr syntax or the
<code>GNATSDB</code>environment variable described in the previous section.
</p>
<p>For sites that need to submit Problem Reports by having send-pr send
e-mail instead of speaking directly over the network to the <small>GNATS</small>
server, you need to create a problem report template on the <small>GNATS</small>
server and have that template copied to a suitable location on the
client machine (any filename and any location will do, as long as
<code>send-pr</code> on the client machine can read the file).  On the
<small>GNATS</small> server, use the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">send-pr -p &gt; &lsquo;<tt>filename</tt>&rsquo;
</pre></td></tr></table>

<p>The file &lsquo;<tt>filename</tt>&rsquo; now contains a PR template for your database.
Copy this file to the client.  Then edit the &lsquo;<tt>send-pr.conf</tt>&rsquo; file
that you created on the client, set the <code>TEMPLATE</code> variable to
point to the template file (see section <a href="Management.html#send_002dpr_002econf-file">The send-pr.conf configuration file</a>) and make sure that the <code>MAILPROG</code> and
<code>MAILADDR</code> varables in &lsquo;<tt>send-pr.conf</tt>&rsquo; are correctly set.  You
should now have a working remote tool installation.
</p>
<p>For clients that have no direct network access to your <small>GNATS</small>
server, such as those that are located behind strict firewalls, you
either need to set up a web interface such as Gnatsweb (provided that
the firewall lets web traffic through) or use the procedure above which
sets up <code>send-pr</code> to submit Problem Reports by e-mail.  In order to
query PRs, users on the remote machines will then have to use the the
e-mail functionality of <code>query-pr</code> (see section <a href="GNATS-user-tools.html#Invoking-query_002dpr">Invoking <code>query-pr</code></a>.
Editing PRs by e-mail is not possible, so clients in this group who need
edit access have to get access through a web interface if possible.
</p>
<p>Note that when <code>send-pr</code> is set up to work over e-mail, the
<code>GNATSDB</code> environment variable and the <code>-d</code> command line
option have no effect since <code>send-pr</code> is tied to a specific
database by way of the value of <code>MAILADDR</code> in the
&lsquo;<tt>send-pr.conf</tt>&rsquo; file.
</p>
<hr size="6">
<a name="Upgrading"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-tools-for-remote-users" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Overview-3" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Upgrading-from-older-versions"></a>
<h2 class="section">3.8 Upgrading from older versions</h2>
<a name="index-upgrading-from-older-versions"></a>

<p>The following procedure covers an upgrade from all <small>GNATS</small> 3 versions
newer than 3.108.  If your installation is an older 3.10x version, or
even the ancient 3.2 version, you need to review the
&lsquo;<tt>UPGRADING.old</tt>&rsquo; file in the <small>GNATS</small> distribution before carrying
out the steps detailed here.
</p>
<hr size="6">
<a name="Overview-3"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Upgrading" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Upgrading-1" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Upgrading" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.8.1 Overview</h3>
<a name="index-upgrading_002c-overview"></a>

<p>Although almost all of the <small>GNATS</small> internals have been redesigned and
rewritten for <small>GNATS</small> 4, little has changed in the format and
structure of the database data.  The only change that needs to be taken
into account when upgrading is the fact that the database index format
is binary in a default installation of <small>GNATS</small> 4.  Thus, you will
need to regenerate your database index by using the <code>gen-index</code>
tool.  In addition, if your old <small>GNATS</small> installation was so-called
&ldquo;release-based&rdquo;, you need to make some simple modifications to the
database setup file &lsquo;<tt>dbconfig</tt>&rsquo;.  See below for details.
</p>
<p>Apart from building and installing new binaries, the major changes which
impinge on the upgrade procedure are all on the configuration side.  The
main database configuration file, &lsquo;<tt>dbconfig</tt>&rsquo;, is far more complex
and powerful than the old &lsquo;<tt>config</tt>&rsquo; file, and while the installation
process creates a sensible set of default values which are similar to
<small>GNATS</small> 3.11x&rsquo;s defaults, you still need to migrate any changes you
may have made to your own local configuration.
</p>
<p>Another aspect which needs consideration are remote submitter sites.
Such sites either need to be instructed to upgrade their locally
installed copies of the <small>GNATS</small> user tools (<code>send-pr</code>,
<code>edit-pr</code> and <code>query-pr</code>), or they should be given access
through interfaces such as Gnatsweb.
</p>
<p>Since the <small>GNATS</small> network daemon has been completely reworked, with
an entirely new command set, all network-based interfaces, such as
Gnatsweb and TkGnats need to be upgraded to versions that support
<small>GNATS</small> 4.  The &lsquo;<tt>contrib</tt>&rsquo; directory of this distribution
contains some third-party interfaces, and the &lsquo;<tt>README</tt>&rsquo; file
contains pointers to where you can obtain the newest versions of these
tools.
</p>
<p>This document only deals with upgrading <small>GNATS</small> itself.  Third-party
tools should have separate upgrading instructions in their
distributions.
</p>
<hr size="6">
<a name="Upgrading-1"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Overview-3" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Upgrading" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.8.2 Upgrading</h3>
<a name="index-upgrade_002c-procedure"></a>

<ol>
<li>
Before you begin, make a backup of your entire <small>GNATS</small> database
directory hierarchy, the <small>GNATS</small> executables directory and the
<small>GNATS</small> user tools (<code>send-pr</code>, <code>query-pr</code> etc.)  The
locations of these may vary, but in a default <small>GNATS</small> 3 installation,
the database(s) reside under &lsquo;<tt>/usr/local/share/gnats</tt>&rsquo;, the
executables are located in &lsquo;<tt>/usr/local/libexec/gnats</tt>&rsquo; and the
user tools reside in &lsquo;<tt>/usr/local/bin</tt>&rsquo;.

</li><li>
(optional) In order to avoid confusing your users, you may want to
remove the old <small>GNATS</small> 3 executables and tools, escpecially if you
plan to install <small>GNATS</small> 4 in a different location than version 3.

</li><li>
Build and install <small>GNATS</small> 4.  See section <a href="#Installation">Installing <small>GNATS</small></a>.  It is recommended that you use the
<code>--enable-gnats-default-db</code> option when running <code>configure</code>,
in order to set the default database to be one of your already existing
<small>GNATS</small> 3 databases.

</li><li>
Edit the <small>GNATS</small> &lsquo;<tt>databases</tt>&rsquo; file and add entries for all your
old <small>GNATS</small> 3 databases.  In a default <small>GNATS</small> 4 installation
the file is in &lsquo;<tt>/usr/local/etc/gnats</tt>&rsquo;.  See section <a href="Management.html#databases-file">The &lsquo;<tt>databases</tt>&rsquo; file</a>.

</li><li>
In <small>GNATS</small> 3, the file &lsquo;<tt>gnatsd.conf</tt>&rsquo; specifies minimum access
levels for the different hosts accessing the <small>GNATS</small> daemon,
<code>gnatsd</code>.  There is one &lsquo;<tt>gnatsd.conf</tt>&rsquo; for each database.  In
<small>GNATS</small> 4, these files have been replaced by a single file named
&lsquo;<tt>gnatsd.host_access</tt>&rsquo; which contains settings that apply across all
the databases on the server.  This file is located in the same directory
as the &lsquo;<tt>databases</tt>&rsquo; file.  You need to combine the host access
settings from all your <small>GNATS</small> 3 databases and add them to the
&lsquo;<tt>gnatsd.host_access</tt>&rsquo; file.  Note that you are no longer able to
control host access on a per-database basis.  Optionally, you may delete
the old &lsquo;<tt>gnatsd.conf</tt>&rsquo; files.  See section <a href="Access-Control.html#Access-Control">Controlling access to <small>GNATS</small> databases</a>.

</li><li>
Next, you need to migrate the settings in the old &lsquo;<tt>config</tt>&rsquo; files of
your databases to corresponding &lsquo;<tt>dbconfig</tt>&rsquo; files.  The database you
specified with the <code>--enable-gnats-default-db</code> configure option
got a default &lsquo;<tt>dbconfig</tt>&rsquo; installed.  This default file contains
field definitions etc. which makes this version of <small>GNATS</small> behave
almost exactly like older versions.  Copy this default file to the
&lsquo;<tt>gnats-adm</tt>&rsquo; directories of any other <small>GNATS</small> databases that
you may have on your host before you proceed to migrate your old
configuration settings.

<p>The following is a list of the configuration directives that may be
present in a &lsquo;<tt>config</tt>&rsquo; file and their counterparts (if any) in
<small>GNATS</small> 4.
</p>
<dl compact="compact">
<dt> <var>GNATS_ADDR</var></dt>
<dd><p>This setting has no counterpart in <small>GNATS</small> 4, since <small>GNATS</small> no
longer needs to know its own mail address.
</p>
</dd>
<dt> <var>GNATS_ADMIN</var></dt>
<dd><p>This setting is now set in the &lsquo;<tt>responsible</tt>&rsquo; file in the
&lsquo;<tt>gnats-adm</tt>&rsquo; directory of your database(s).
</p>
</dd>
<dt> <var>GNATS_SITE</var></dt>
<dd><p><small>GNATS</small> 4 has no concept of a named &lsquo;site&rsquo;, so this directive is
obsolete.
</p>
</dd>
<dt> <var>SUBMITTER</var></dt>
<dd><p>Obsolete, since it relates to <var>GNATS_SITE</var>.
</p>
</dd>
<dt> <var>DEFAULT_RELEASE</var></dt>
<dt> <var>DEFAULT_ORGANIZATION</var></dt>
<dd><p>The <small>GNATS</small> 4 &lsquo;<tt>dbconfig</tt>&rsquo; file has separate configuration
sections for each defined field.  Field defaults are set with the
<code>default</code> keyword in these sections.  See section <a href="Management.html#dbconfig-file">The &lsquo;<tt>dbconfig</tt>&rsquo; file</a>.
</p>
</dd>
<dt> <var>NOTIFY</var></dt>
<dd><p>Controlled by the <code>notify-about-expired-prs</code> setting in the
&lsquo;<tt>dbconfig</tt>&rsquo; file.
</p>
</dd>
<dt> <var>ACKNOWLEDGE</var></dt>
<dd><p>Controlled by the <code>send-submitter-ack</code> setting in the
&lsquo;<tt>dbconfig</tt>&rsquo; file.
</p>
</dd>
<dt> <var>DEFAULT_SUBMITTER</var></dt>
<dd><p>The default submitter is now always the first entry in the
&lsquo;<tt>submitters</tt>&rsquo; file of your database.
</p>
</dd>
<dt> <var>KEEP_RECEIVED_HEADERS</var></dt>
<dd><p>Controlled by the <code>keep-all-received-headers</code> setting in the
&lsquo;<tt>dbconfig</tt>&rsquo; file.
</p>
</dd>
<dt> <var>DEBUG_MODE</var></dt>
<dd><p>Controlled by the <code>debug-mode</code> setting in the &lsquo;<tt>dbconfig</tt>&rsquo; file.
</p>
</dd>
<dt> <var>BDAY_START</var></dt>
<dt> <var>BDAY_END</var></dt>
<dt> <var>BWEEK_START</var></dt>
<dt> <var>BWEEK_END</var></dt>
<dd><p>Controlled by the settings <code>business-day-hours</code> and
<code>business-week-days</code> in the &lsquo;<tt>dbconfig</tt>&rsquo; file.
</p>
</dd>
<dt> <var>DEFINE_CATEGORY</var></dt>
<dd><p>The default category for PRs that arrive without one is now the first
category listed in the &lsquo;<tt>categories</tt>&rsquo; file of your database.
</p></dd>
</dl>

<p>After your are done migrating the settings, you may optionally delete
the old &lsquo;<tt>config</tt>&rsquo; files.  Since there are many more configuration
settings available in the <small>GNATS</small> 4 &lsquo;<tt>dbconfig</tt>&rsquo; file, you should
take some time to review them all before proceeding.  See section <a href="Management.html#dbconfig-file">The &lsquo;<tt>dbconfig</tt>&rsquo; file</a>.
</p>
<p>If your old <small>GNATS</small> installations was release-based, i.e. it included
the fields Quarter, Keywords and Date-Required, you need to define those
fields in the &lsquo;<tt>dbconfig</tt>&rsquo; file by following the instructions in
<a href="dbconfig-recipes.html#release_002dbased-support">Supporting old <small>GNATS</small> &ldquo;release-based&rdquo; fields</a>.
</p>
</li><li>
The file &lsquo;<tt>gnatsd.access</tt>&rsquo; has been renamed to &lsquo;<tt>gnatsd.user_access</tt>&rsquo;.
Furthermore, <small>GNATS</small> 4 uses a different password format in the
&lsquo;<tt>gnatsd.user_access</tt>&rsquo; file than older versions, since it supports
<code>crypt()</code> and MD5 passwords (see section <a href="Access-Control.html#Access-Control">Controlling access to <small>GNATS</small> databases</a>).  You need to translate your old
&lsquo;<tt>gnatsd.user_access</tt>&rsquo; files to the new format by using the
<code>gnats-pwconv</code> tool which was installed in the
&lsquo;<tt><var>EXEC-PREFIX</var>/libexec/gnats</tt>&rsquo; directory, typically
&lsquo;<tt>/usr/local/libexec/gnats</tt>&rsquo;.  See section <a href="Management.html#gnats_002dpwconv">Managing user passwords</a>.

</li><li>
The final step involves regenerating the indexes of your databases.  For
this, log in as the user <code>gnats</code>.  Then run the <code>gen-index</code>
command for each of your databases.  See <a href="Management.html#Admin-utils">Administrative Utilities</a> for details on how to use
<code>gen-index</code>.

</li><li>
Sit back and enjoy your new <small>GNATS</small> 4 setup...
</li></ol>



<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="Management.html#Management" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="gnats.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="gnats_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="gnats_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Chad Walstrom</em> on <em>March 3, 2015</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
