<html lang="en">
<head>
<title>Keeping Track</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Keeping Track">
<meta name="generator" content="makeinfo 4.7">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc { font-variant:small-caps }
  span.roman { font-family: serif; font-weight: normal; } 
--></style>
</head>
<body>
<h1 class="settitle">Keeping Track</h1>
   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Overview</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introducing <span class="sc">gnats</span></a>
<ul>
<li><a href="#Paradigm">1.1 The database paradigm</a>
<li><a href="#Flowchart">1.2 Flowchart of <span class="sc">gnats</span> activities</a>
<li><a href="#States">1.3 States of Problem Reports</a>
<li><a href="#Fields">1.4 Problem Report format</a>
<ul>
<li><a href="#Field-datatypes-reference">1.4.1 Field datatypes reference</a>
<li><a href="#Mail-header-fields">1.4.2 Mail header fields</a>
<li><a href="#Problem-Report-fields">1.4.3 Problem Report fields</a>
</li></ul>
</li></ul>
<li><a name="toc_GNATS-user-tools" href="#GNATS-user-tools">2 The <span class="sc">gnats</span> User Tools</a>
<ul>
<li><a href="#Environment">2.1 Environment variables and <span class="sc">gnats</span> tools</a>
<li><a href="#send_002dpr">2.2 Submitting Problem Reports</a>
<ul>
<li><a href="#send_002dpr-from-the-shell">2.2.1 Invoking <code>send-pr</code> from the shell</a>
<li><a href="#send_002dpr-in-Emacs">2.2.2 Using <code>send-pr</code> from within Emacs</a>
<li><a href="#PR-template">2.2.3 The Problem Report template</a>
<li><a href="#Submitting-via-e_002dmail">2.2.4 Submitting a Problem Report via direct e-mail</a>
<li><a href="#Helpful-hints">2.2.5 Helpful hints</a>
</li></ul>
<li><a href="#edit_002dpr">2.3 Editing existing Problem Reports</a>
<ul>
<li><a href="#edit_002dpr-from-the-shell">2.3.1 Invoking <code>edit-pr</code> from the shell</a>
<li><a href="#follow_002dup-via-email">2.3.2 Following up via direct email</a>
</li></ul>
<li><a href="#query_002dpr">2.4 Querying the database</a>
<ul>
<li><a href="#Invoking-query_002dpr">2.4.1 Invoking <code>query-pr</code></a>
<li><a href="#Formatting-query_002dpr-output">2.4.2 Formatting <code>query-pr</code> output</a>
<li><a href="#Query-expressions">2.4.3 Query expressions</a>
<li><a href="#Example-queries">2.4.4 Example queries</a>
</li></ul>
<li><a href="#Emacs">2.5 The Emacs interface to <span class="sc">gnats</span></a>
<ul>
<li><a href="#Emacs-viewing">2.5.1 Viewing Problem Reports</a>
<li><a href="#Emacs-querying">2.5.2 Querying Problem Reports</a>
<li><a href="#Emacs-submitting">2.5.3 Submitting new Problem Reports</a>
<li><a href="#Emacs-editing">2.5.4 Editing Problem Reports</a>
<li><a href="#Emacs-editing-buffer">2.5.5 The Problem Report editing buffer</a>
<li><a href="#Emacs-and-databases">2.5.6 Changing the database</a>
<li><a href="#dbconfig-mode">2.5.7 dbconfig mode</a>
<li><a href="#Other-Emacs-commands">2.5.8 Other commands</a>
<li><a href="#Emacs-customization">2.5.9 Customization</a>
</li></ul>
</li></ul>
<li><a name="toc_Installation" href="#Installation">3 Installing <span class="sc">gnats</span></a>
<ul>
<li><a href="#Configure-and-make">3.1 Configuring and compiling the software</a>
<li><a href="#Installing-utils">3.2 Installing the utilities</a>
<li><a href="#Setting-up-the-default-database">3.3 Installing the default database</a>
<li><a href="#Setting-up-periodic-jobs">3.4 Setting up periodic jobs</a>
<li><a href="#Aliases">3.5 Setting up mail aliases</a>
<li><a href="#Installing-the-daemon">3.6 Installing the daemon</a>
<li><a href="#Installing-tools">3.7 Installing the user tools</a>
<ul>
<li><a href="#Installing-tools">3.7.1 User tools on a local network</a>
<li><a href="#Installing-tools">3.7.2 User tools for remote users</a>
</li></ul>
<li><a href="#Upgrading">3.8 Upgrading from older versions</a>
<ul>
<li><a href="#Upgrading">3.8.1 Overview</a>
<li><a href="#Upgrading">3.8.2 Upgrading</a>
</li></ul>
</li></ul>
<li><a name="toc_Management" href="#Management">4 <span class="sc">gnats</span> Administration</a>
<ul>
<li><a href="#GNATS-configuration">4.1 Overview of <span class="sc">gnats</span> configuration</a>
<li><a href="#databases-file">4.2 The <code>databases</code> file</a>
<li><a href="#dbconfig-file">4.3 The <code>dbconfig</code> file</a>
<ul>
<li><a href="#Overall-database-configuration">4.3.1 Overall database configuration</a>
<li><a href="#Individual-field-configuration">4.3.2 Individual field configuration</a>
<li><a href="#Field-datatypes">4.3.3 Field datatypes</a>
<li><a href="#Edit-controls">4.3.4 Edit controls</a>
<li><a href="#Named-query-definitions">4.3.5 Named query definitions</a>
<li><a href="#Audit_002dtrail-formats">4.3.6 Audit-trail formats</a>
<li><a href="#Outgoing-email-formats">4.3.7 Outgoing email formats</a>
<li><a href="#Index-file-description">4.3.8 Index file description</a>
<li><a href="#Initial-PR-input-fields">4.3.9 Initial PR input fields</a>
</li></ul>
<li><a href="#Other-config-files">4.4 Other database-specific config files</a>
<ul>
<li><a href="#categories-file">4.4.1 The <code>categories</code> file</a>
<li><a href="#responsible-file">4.4.2 The <code>responsible</code> file</a>
<li><a href="#submitters-file">4.4.3 The <code>submitters</code> file</a>
<li><a href="#states-file">4.4.4 The <code>states</code> file</a>
<li><a href="#addresses-file">4.4.5 The <code>addresses</code> file</a>
<li><a href="#classes-file">4.4.6 The <code>classes</code> file</a>
</li></ul>
<li><a href="#send_002dpr_002econf-file">4.5 The <span class="file">send-pr.conf</span> file</a>
<li><a href="#Admin-files">4.6 Administrative data files</a>
<ul>
<li><a href="#index-file">4.6.1 The <code>index</code> file</a>
<li><a href="#current-file">4.6.2 The <code>current</code> file</a>
</li></ul>
<li><a href="#Admin-utils">4.7 Administrative utilities</a>
<ul>
<li><a href="#mkdb">4.7.1 Adding another database</a>
<li><a href="#mkcat">4.7.2 Adding a problem category</a>
<li><a href="#rmcat">4.7.3 Removing a problem category</a>
<li><a href="#gen_002dindex">4.7.4 Regenerating the index</a>
<li><a href="#check_002ddb">4.7.5 Checking database health</a>
<li><a href="#gnats_002dpwconv">4.7.6 Managing user passwords</a>
</li></ul>
<li><a href="#Internal-utils">4.8 Internal utilities</a>
<ul>
<li><a href="#queue_002dpr">4.8.1 Handling incoming traffic</a>
<li><a href="#file_002dpr">4.8.2 Processing incoming traffic</a>
<li><a href="#at_002dpr">4.8.3 Timely reminders</a>
<li><a href="#pr_002dedit">4.8.4 The <code>edit-pr</code> driver</a>
<li><a href="#diff_002dprs">4.8.5 The <code>diff-prs</code> tool</a>
<li><a href="#pr_002dage">4.8.6 The <code>pr-age</code> tool</a>
</li></ul>
</li></ul>
<li><a name="toc_Locations" href="#Locations">Appendix A Where <span class="sc">gnats</span> lives</a>
<ul>
<li><a href="#prefix">A.1 <var>prefix</var></a>
<li><a href="#exec_002dprefix">A.2 <var>exec-prefix</var></a>
<li><a href="#gnats_002dadm">A.3 The <span class="file">gnats-adm</span> directory</a>
<li><a href="#defaults">A.4 Default installation locations</a>
</li></ul>
<li><a name="toc_gnatsd" href="#gnatsd">Appendix B The <span class="sc">gnats</span> network server &ndash; <code>gnatsd</code></a>
<ul>
<li><a href="#Description-of-gnatsd">B.1 Description of <code>gnatsd</code></a>
<li><a href="#gnatsd-options">B.2 <code>gnatsd</code> options</a>
<li><a href="#gnatsd-command-protocol">B.3 <code>gnatsd</code> command protocol</a>
<li><a href="#gnatsd-commands">B.4 <code>gnatsd</code> commands</a>
<li><a href="#gnatsd-environment-variables">B.5 <code>gnatsd</code> environment variables</a>
</li></ul>
<li><a name="toc_Access-Control" href="#Access-Control">Appendix C Controlling access to databases</a>
<ul>
<li><a href="#Overview">C.1 Overview</a>
<li><a href="#Overall-gnatsd-access-level">C.2 Overall <code>gnatsd</code> access level</a>
<li><a href="#gnatsd_002ehost_005faccess">C.3 Overall access levels per host</a>
<li><a href="#gnatsd_002euser_005faccess">C.4 Access levels per user</a>
<li><a href="#Privileged-gnatsd-commands">C.5 Privileged <code>gnatsd</code> commands</a>
</li></ul>
<li><a name="toc_Regexps" href="#Regexps">Appendix D Querying using regular expressions</a>
<li><a name="toc_dbconfig-recipes" href="#dbconfig-recipes">Appendix E <span class="file">dbconfig</span> recipes</a>
<li><a name="toc_Support" href="#Support">Appendix F <span class="sc">gnats</span> support</a>
<li><a name="toc_Index" href="#Index">Index</a>
</li></ul>
</div>



<div class="node">
<p><hr>
<a name="Top"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>
<br>
</div>

<h2 class="unnumbered">Overview</h2>

<p><a name="index-overview-to-GNATS-1"></a><a name="index-foreword-2"></a>
This manual documents <span class="sc">gnats</span>, the <span class="sc">gnu</span> Problem Report Management
System, version 4.1.999.  <span class="sc">gnats</span> is a bug-tracking tool
designed for use at a central <dfn>Support Site</dfn>.  Users who experience
problems use electronic mail, web-based or other clients communicating
with the <span class="sc">gnats</span> network daemon running at the support site or direct
database submissions to communicate these problems to <dfn>maintainers</dfn>
at that Support Site.  <span class="sc">gnats</span> partially automates the tracking of
these <dfn>Problem Reports</dfn> (<dfn>PR</dfn>s) by:

     <ul>
<li>organizing problem reports into a database and notifying responsible
parties of suspected bugs;

     <li>allowing support personnel and their managers to edit and query
accumulated bugs; and

     <li>providing a reliable archive of problems (and their subsequent
solutions) with a given program. 
</ul>

   <p><span class="sc">gnats</span> offers many of the same features offered by more generalized
databases, including editing, querying, and basic reporting.  The
<span class="sc">gnats</span> database itself is an ordered repository for problem reports;
each PR receives a unique, incremental <dfn>PR number</dfn> which identifies
it throughout its lifetime.  For a discussion on the working system
adopted by <span class="sc">gnats</span>, see <a href="#Paradigm">The database paradigm</a>.

   <p>You can access the submitting, editing, and querying functions of
<span class="sc">gnats</span> from within <span class="sc">gnu</span> Emacs.  See <a href="#GNATS-user-tools">The <span class="sc">gnats</span> user tools</a>.

<ul class="menu">
<li><a accesskey="1" href="#Introduction">Introduction</a>:           Introducing GNATS. 
<li><a accesskey="2" href="#GNATS-user-tools">GNATS user tools</a>:       The GNATS user tools. 
<li><a accesskey="3" href="#Installation">Installation</a>:           Installing GNATS. 
<li><a accesskey="4" href="#Management">Management</a>:             GNATS Administration. 
<li><a accesskey="5" href="#Locations">Locations</a>:              Where GNATS lives. 
<li><a accesskey="6" href="#gnatsd">gnatsd</a>:                 The GNATS network server. 
<li><a accesskey="7" href="#Access-Control">Access Control</a>:         Controlling access to GNATS databases. 
<li><a accesskey="8" href="#Regexps">Regexps</a>:                Querying using regular expressions. 
<li><a accesskey="9" href="#dbconfig-recipes">dbconfig recipes</a>:       Useful dbconfig tricks. 
<li><a href="#Support">Support</a>:                GNATS related sites and mailing lists. 
<li><a href="#Index">Index</a>
</ul>

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Introduction"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#GNATS-user-tools">GNATS user tools</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">1 Introducing <span class="sc">gnats</span></h2>

<p><a name="index-introduction-to-GNATS-3"></a><a name="index-rationale-4"></a><a name="index-database-rationale-5"></a>
Any support organization realizes that a large amount of data flows back
and forth between the maintainers and the users of their products.  This
data often takes the form of problem reports and communication via
electronic mail.  <span class="sc">gnats</span> addresses the problem of organizing this
communication by defining a database made up of archived and indexed
problem reports.

   <p><span class="sc">gnats</span> was designed as a tool for software maintainers.  It consists
of several utilities which, when used in concert, formulate and
administer a database of Problem Reports grouped by site-defined
<dfn>problem categories</dfn>.  It allows a support organization to keep
track of problems (hence the term <dfn>Problem Report</dfn>) in an organized
fashion.  Essentially, <span class="sc">gnats</span> acts as an active archive for
field-separated textual data.

<ul class="menu">
<li><a accesskey="1" href="#Paradigm">Paradigm</a>:        The database paradigm
<li><a accesskey="2" href="#Flowchart">Flowchart</a>:       Flowchart of GNATS activities
<li><a accesskey="3" href="#States">States</a>:          States of Problem Reports
<li><a accesskey="4" href="#Fields">Fields</a>:          Problem Report format
</ul>

<div class="node">
<p><hr>
<a name="Paradigm"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Flowchart">Flowchart</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.1 The database paradigm</h3>

<p><a name="index-paradigm-6"></a><a name="index-database-paradigm-7"></a><a name="index-why-GNATS-8"></a><a name="index-support-site-9"></a><a name="index-maintenance-10"></a><a name="index-so-what-does-it-do-11"></a>
It is in your best interest as the maintainer of a body of work to
organize the feedback you receive on that work, and to make it easy for
users of your work to report problems and suggestions.

   <p><span class="sc">gnats</span> makes this easy by automatically filing incoming problem
reports into appropriate places, by notifying responsible parties of the
existence of the problem and (optionally) sending an acknowledgment to
the submitter that the report was received, and by making these Problem
Reports accessible to queries and easily editable.  <span class="sc">gnats</span> is a
database specialized for a specific task.

   <p><span class="sc">gnats</span> was designed for use at a Support Site that handles a high
level of problem-related traffic.  It maintains Problem Reports in the
form of text files with defined <dfn>fields</dfn>
(see <a href="#Fields"><span class="sc">gnats</span> data fields</a>).  The location of the database,
as well as the categories it accepts as valid, the maintainers for whom
it provides service, and the submitters from whom it accepts Problem
Reports, are all definable by the <dfn>Support Site</dfn>. 
See <a href="#Management"><span class="sc">gnats</span> administration</a>.

   <p><a name="index-what-is-a-PR-12"></a>Each PR is a separate file within a main repository
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>).  Editing access to the
database is regulated to maintain consistency.  To make queries on
the database faster, an index is kept automatically (see <a href="#index-file">The <code>index</code> file</a>).

   <p>We provide several software tools so that users may submit new Problem
Reports, edit existing Problem Reports, and query the database.

     <ul>
<li><code>send-pr</code><!-- /@w --> is used by both product maintainers and the end users
of the products they support to submit PRs to the database.

     <li><code>edit-pr</code><!-- /@w --> is used by maintainers when editing problem
reports in the database.

     <li>Maintainers, managers and administrators can use <code>query-pr</code><!-- /@w --> to
make inquiries about individual PRs or groups of PRs.

   </ul>

   <p>Other interfaces to <span class="sc">gnats</span> include Gnatsweb, a web-based tool which
provides features for submitting and editing PRs and querying the
database, and TkGnats, a Tcl/Tk-based frontend.  These tools are
distributed together with <span class="sc">gnats</span>.

   <p><a name="index-GNATS-administrator-13"></a>At the Support Site, a <span class="sc">gnats</span> <dfn>administrator</dfn> is charged with the
duty of maintaining <span class="sc">gnats</span>.  These duties are discussed in detail in
<a href="#Management"><span class="sc">gnats</span> Administration</a>, and generally include
configuring <span class="sc">gnats</span> for the Support Site, editing PRs that <span class="sc">gnats</span>
cannot process, pruning log files, setting up new problem categories,
backing up the database, and distributing <code>send-pr</code> so that others
may submit Problem Reports.

   <p>Responsibility for a given Problem Report initially depends on the
category of the problem.  Optionally, an automated reminder can be
sent to the responsible person if a problem report is neglected for a
requisite time period.  See <a href="#GNATS-configuration">Overview of <span class="sc">gnats</span> configuration</a>.

   <p><a name="index-_0040code_007bpending_007d-directory-14"></a><a name="index-unparseable-incoming-PRs-15"></a><a name="index-incoming-PRs-that-_0040sc_007bgnats_007d-cannot-parse-16"></a><span class="sc">gnats</span> does not have the ability to decipher random text. 
If there is no default category set, any
problem reports which arrive in a format <span class="sc">gnats</span> does not recognize
are placed in a separate directory pending investigation by the
<span class="sc">gnats</span> administrator (see <a href="#Management"><span class="sc">gnats</span> Administration</a>).

   <p>Once a problem is recorded in the database, work can begin toward a
solution.  A problem's initial <dfn>state</dfn> type is <dfn>open</dfn>
(see <a href="#States">States of Problem Reports</a>).  An acknowledgment may be
sent to the originator of the bug report (depending on whether this
feature has been switched on in the <span class="sc">gnats</span> configuration). 
<span class="sc">gnats</span> forwards copies of the report to the party responsible for
that problem category and to the person responsible for problems
arriving from that submitter. 
<!-- (@pxref{Glossary,,Glossary}). -->

   <p>When a problem has been identified, the maintainer can change its state
to <dfn>analyzed</dfn>, and then to <dfn>feedback</dfn> when a solution is found. 
<span class="sc">gnats</span> may be configured so that each time the state of a PR
changes, the submitter of the problem report is notified of the reason
for the change.  If the party responsible for the PR changes, the
previous responsible party and the new responsible party receive notice
of the change.  The change and reason are also recorded in the
<code>Audit-Trail</code> field of the Problem Report.  (See <a href="#edit_002dpr">Editing existing Problem Reports</a>.  For information on the <code>Audit-Trail</code>
field, see <a href="#Fields">Problem Report format</a>.)

   <p>When the originator of the Problem Report confirms that the solution
works, the maintainer can change the state to <dfn>closed</dfn>.  If the PR
cannot be closed, the maintainer can change its state to <dfn>suspended</dfn>
as a last resort.  (For a more detailed description of the standard
states, see <a href="#States">States of Problem Reports</a>.)

   <p>It should be emphasized that what we describe here is the default way
that <span class="sc">gnats</span> works, but as of version 4, <span class="sc">gnats</span> is extremely
customizable, allowing sites to tailor almost every aspect of its
behavior.  See for instance <a href="#dbconfig-file">The <code>dbconfig</code> file</a> and See <a href="#States">States of Problem Reports</a>.)

<div class="node">
<p><hr>
<a name="Flowchart"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#States">States</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Paradigm">Paradigm</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.2 Flowchart of <span class="sc">gnats</span> activities</h3>

<p><a name="index-flowchart-of-GNATS-activities-17"></a><a name="index-visual-map-of-data-flow-18"></a>
This informal flowchart shows the relationships of the <span class="sc">gnats</span> tools
to each other and to the files with which they interoperate.

   <div class="block-image"><img src="flowchart.png" alt="Flowchart Image"></div>

<!--  -->
<div class="node">
<p><hr>
<a name="States"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Fields">Fields</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Flowchart">Flowchart</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.3 States of Problem Reports</h3>

<p><a name="index-life_002dcycle-of-a-Problem-Report-19"></a><a name="index-states-of-Problem-Reports-20"></a><a name="index-Problem-Report-states-21"></a><a name="index-automatic-notification-22"></a>
Each PR goes through a defined series of states between origination and
closure.  By default, the originator of a PR receives notification
automatically of any state changes.

   <p>Unless your site has customized states (see <a href="gnats.html#states-file">states file (gnats)</a>), <span class="sc">gnats</span> uses these states:

     
<a name="index-_0040emph_007bopen_007d-state-23"></a>
<a name="index-initial-state-_0028_0040dfn_007bopen_007d_0029-24"></a>
<a name="index-state_002d_002d_002d_0040dfn_007bopen_007d-25"></a>
<dl><dt><dfn>open</dfn><dd>The initial state of a Problem Report.  This means the PR has been filed
and the responsible person(s) notified.

     <p><a name="index-_0040emph_007banalyzed_007d-state-26"></a><a name="index-state_002d_002d_002d_0040dfn_007banalyzed_007d-27"></a><br><dt><dfn>analyzed</dfn><dd>The responsible person has analyzed the problem.  The analysis should
contain a preliminary evaluation of the problem and an estimate of the
amount of time and resources necessary to solve the problem.  It should
also suggest possible workarounds.

     <p><a name="index-_0040emph_007bfeedback_007d-state-28"></a><a name="index-state_002d_002d_002d_0040dfn_007bfeedback_007d-29"></a><br><dt><dfn>feedback</dfn><dd>The problem has been solved, and the originator has been given a patch
or other fix.  The PR remains in this state until the originator
acknowledges that the solution works.

     <p><a name="index-_0040emph_007bclosed_007d-state-30"></a><a name="index-state_002d_002d_002d_0040dfn_007bclosed_007d-31"></a><a name="index-final-state-_0028_0040dfn_007bclosed_007d_0029-32"></a><br><dt><dfn>closed</dfn><dd>A Problem Report is closed (&ldquo;the bug stops here&rdquo;) only when any
changes have been integrated, documented, and tested, and the submitter
has confirmed the solution.

     <p><a name="index-_0040emph_007bsuspended_007d-state-33"></a><a name="index-state_002d_002d_002d_0040dfn_007bsuspended_007d-34"></a><br><dt><dfn>suspended</dfn><dd>Work on the problem has been postponed.  This happens if a timely
solution is not possible or is not cost-effective at the present time. 
The PR continues to exist, though a solution is not being actively
sought.  If the problem cannot be solved at all, it should be closed
rather than suspended. 
</dl>

<!--  -->
<div class="node">
<p><hr>
<a name="Fields"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#States">States</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.4 Problem Report format</h3>

<p><a name="index-Problem-Report-format-35"></a><a name="index-format-36"></a><a name="index-database-similarities-37"></a><a name="index-fields-38"></a>
The format of a PR is designed to reflect the nature of <span class="sc">gnats</span> as a
database.  Information is arranged into <dfn>fields</dfn>, and kept in
individual records (Problem Reports).

   <p>A Problem Report contains two different types of fields: <dfn>Mail
Header</dfn> fields, which are used by the mail handler for delivery, and
<dfn>Problem Report</dfn> fields, which contain information relevant to the
Problem Report and its submitter.  A Problem Report is essentially a
specially formatted electronic mail message.

   <p>Problem Report fields are denoted by a keyword which begins with
<span class="samp">&gt;</span> and ends with <span class="samp">:</span>, as in <span class="samp">&gt;Confidential:</span>.  Fields
belong to one of eight data types as listed in <a href="#Field-datatypes-reference">Field datatypes reference</a>.  As of version 4 of <span class="sc">gnats</span> all characteristics of
fields, such as field name, data type, allowed values, permitted
operations, on-change actions etc. are configurable.

   <p>For details, see see <a href="#dbconfig-file">The <code>dbconfig</code> file</a>.

<h4 class="subheading">Example Problem Report</h4>

   <p>The following is an example Problem Report with the fields that would be
present in a standard <span class="sc">gnats</span> configuration.  Mail headers are at the
top, followed by <span class="sc">gnats</span> fields, which begin with <span class="samp">&gt;</span> and end
with <span class="samp">:</span>.  The <span class="samp">Subject:</span> line in the mail header and the
<code>Synopsis</code> field are usually duplicates of each other.

   <p><a name="index-sample-Problem-Report-39"></a><a name="index-example-Problem-Report-40"></a><a name="index-Problem-Report-template-41"></a><p><table class="cartouche" summary="cartouche" border="1"><tr><td>
<pre class="smallexample">     Message-Id:  <var>message-id</var>
     Date:        <var>date</var>
     From:        <var>address</var>
     Reply-To:    <var>address</var>
     To:          <var>bug-address</var>
     Subject:     <var>subject</var>
     
     &gt;Number:       <var>gnats-id</var>
     &gt;Category:     <var>category</var>
     &gt;Synopsis:     <var>synopsis</var>
     &gt;Confidential: yes <em>or</em> no
     &gt;Severity:     critical, serious, <em>or</em> non-critical
     &gt;Priority:     high, medium <em>or</em> low
     &gt;Responsible:  <var>responsible</var>
     &gt;State:        open, analyzed, suspended, feedback, <em>or</em> closed
     &gt;Class:        sw-bug, doc-bug, change-request, support,
     duplicate, <em>or</em> mistaken
     &gt;Submitter-Id: <var>submitter-id</var>
     &gt;Arrival-Date: <var>date</var>
     &gt;Originator:   <var>name</var>
     &gt;Organization: <var>organization</var>
     &gt;Release:      <var>release</var>
     &gt;Environment:
        <var>environment</var>
     &gt;Description:
        <var>description</var>
     &gt;How-To-Repeat:
        <var>how-to-repeat</var>
     &gt;Fix:
        <var>fix</var>
     &gt;Audit-Trail:
     <var>appended-messages<small class="dots">...</small></var>
     State-Changed-From-To: <var>from</var>-<var>to</var>
     State-Changed-When: <var>date</var>
     State-Changed-Why:
        <var>reason</var>
     Responsible-Changed-From-To: <var>from</var>-<var>to</var>
     Responsible-Changed-When: <var>date</var>
     Responsible-Changed-Why:
        <var>reason</var>
     &gt;Unformatted:
        <var>miscellaneous</var>
</pre>
   </td></tr></table>

<ul class="menu">
<li><a accesskey="1" href="#Field-datatypes-reference">Field datatypes reference</a>
<li><a accesskey="2" href="#Mail-header-fields">Mail header fields</a>
<li><a accesskey="3" href="#Problem-Report-fields">Problem Report fields</a>
</ul>

<div class="node">
<p><hr>
<a name="Field-datatypes-reference"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Mail-header-fields">Mail header fields</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Fields">Fields</a>
<br>
</div>

<h4 class="subsection">1.4.1 Field datatypes reference</h4>

<p>The following is a short reference to the characteristics of the
different field types.

   <p>For details, see <a href="#Field-datatypes">Field datatypes</a>.

     <dl>
<dt><code>text</code><dd>A one-line text string.

     <br><dt><code>multitext</code><dd>Multiple lines of text.

     <br><dt><code>enum</code><dd>The value in this field is required to be from a list of specified
values, defined at the Support Site.

     <p>(See <a href="#dbconfig-file">The <code>dbconfig</code> file</a>, for details.

     <br><dt><code>multienum</code><dd>Similar to the <code>enum</code> datatype, except that the field can contain
multiple values.

     <br><dt><code>enumerated-in-file</code><dd>Similar to <code>enum</code>, but the allowed field values are listed in a
separate file on the <span class="sc">gnats</span> server.

     <br><dt><code>multi-enumerated-in-file</code><dd>Similar to <code>enumerated-in-file</code>, except that the field can contain
multiple values.

     <br><dt><code>date</code><dd>Used to hold dates.

     <br><dt><code>integer</code><dd>Used to hold integer numbers. 
</dl>

<!--  -->
<div class="node">
<p><hr>
<a name="Mail-header-fields"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Problem-Report-fields">Problem Report fields</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Field-datatypes-reference">Field datatypes reference</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Fields">Fields</a>
<br>
</div>

<h4 class="subsection">1.4.2 Mail header fields</h4>

<p><a name="index-mail-header-fields-42"></a><a name="index-Internet-standard-RFC_002d822-43"></a>
A Problem Report may contain any mail header field described in the
Internet standard RFC-822.  The <code>send-pr</code> tool can be configured
either to submit PRs to the support site by e-mail or by talking
directly to the <code>gnatsd</code> network daemon on the <span class="sc">gnats</span> server. 
This is also true for other client tools such as Gnatsweb.  Even when
these tools are set up submit PRs directly to <code>gnatsd</code>, they will
still include mail header fields that identify the sender and the
subject in the submitted PR:

     
<a name="index-_0040code_007bTo_007d-header-44"></a>
<dl><dt><code>To:</code><dd>The mail address for the Support Site, automatically supplied by the
tool used to submit the PR or by the originator if plain e-mail was
used.

     <p><a name="index-_0040code_007bSubject_007d-header-45"></a><br><dt><code>Subject:</code><dd>A terse description of the problem.  This field normally contains the
same information as the <code>Synopsis</code> field.

     <p><a name="index-_0040code_007bFrom_007d-header-46"></a><br><dt><code>From:</code><dd>Supplied automatically when PRs are submitted by plain e-mail and when
well-behaved tools such as <code>send-pr</code> are used; should always
contain the originator's e-mail address.

     <p><a name="index-_0040code_007bReply_002dTo_007d-header-47"></a><br><dt><code>Reply-To:</code><dd>A return address to which electronic replies can be sent; in most cases,
the same address as the <code>From:</code> field. 
</dl>

   <p><a name="index-_0040code_007bReceived_002dBy_007d-headers-48"></a>One of the configurable options for <span class="sc">gnats</span> is whether or not to
retain <code>Received-By</code><!-- /@w --> headers, which often consume a lot of
space and are not often used.  See <a href="#dbconfig-file">The dbconfig file</a>.

<!--  -->
<div class="node">
<p><hr>
<a name="Problem-Report-fields"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Mail-header-fields">Mail header fields</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Fields">Fields</a>
<br>
</div>

<h4 class="subsection">1.4.3 Problem Report fields</h4>

<p><a name="index-GNATS-database-fields-49"></a><a name="index-field-format-50"></a>
<!-- FIXME - this node is loooooooooooooooong... -->

   <p>In a standard <span class="sc">gnats</span> installation, certain fields will always be
present in a Problem Report.  If a PR arrives without one or more of
these fields, <span class="sc">gnats</span> will add them, and if they have default
values set by the configuration at the Support Site, they will be
filled in with these values.  Certain tools such as <code>send-pr</code> are
set up to provide sensible defaults for most fields
(see <a href="#send_002dpr_002econf-file">The send-pr.conf configuration file</a>.)

   <p>In the list below, the field type (<code>text</code>, <code>multitext</code>,
<code>enumerated</code>, etc.) is supplied in parantheses.  The different
field types are explained briefly in <a href="#Field-datatypes-reference">Field datatypes reference</a>.

   <p><a name="index-fields-_002d-list-51"></a><a name="index-GNATS-fields-_002d-list-52"></a>
     
<a name="index-_0040code_007bSubmitter_002dId_007d-field-53"></a>
<dl><dt><code>Submitter-Id</code><dd>(<code>enumerated-in-file</code>) A unique identification code assigned by the
Support Site.  It is used to identify all Problem Reports coming from a
particular site.  Submitters without a value for this field can invoke
<code>send-pr</code> with the <code>--request-id</code> option to apply for one from
the support organization.  Problem Reports from those not affiliated
with the support organization should use the default value of <span class="samp">net</span>
for this field.

     <p>See <a href="#submitters-file">The <code>submitters</code> file</a>, for details.

     <p><a name="index-_0040code_007bNotify_002dList_007d-field-54"></a><br><dt><code>Notify-List</code><dd>(<code>text</code>) Comma-separated list of e-mail-addresses of people to
notify when the PR changes significantly, i.e. when the Audit-Trail
changes.  This list is independent from the Notify subfield of entries
in the <span class="file">categories</span> file of the <span class="sc">gnats</span> database.

     <p><a name="index-_0040code_007bOriginator_007d-field-55"></a><br><dt><code>Originator</code><dd>(<code>text</code>) Originator's real name.  Note that the Submitter and
Originator might not be the same person/entity in all cases.

     <p><a name="index-_0040code_007bOrganization_007d-field-56"></a><br><dt><code>Organization</code><dd>(<code>multitext</code>) The originator's organization.

     <p><a name="index-_0040code_007bConfidential_007d-field-57"></a><a name="index-confidentiality-in-PRs-58"></a><a name="index-PR-confidentiality-59"></a><br><dt><code>Confidential</code><dd>(<code>enum</code>) Use of this field depends on the originator's relationship
with the support organization; contractual agreements often have
provisions for preserving confidentiality.  Conversely, a lack of a
contract often means that any data provided will not be considered
confidential.  Submitters should be advised to contact the support
organization directly if this is an issue.

     <p>If the originator's relationship to the support organization provides
for confidentiality, then if the value of this field is <span class="samp">yes</span> the
support organization treats the PR as confidential; any code samples
provided are not made publicly available.

     <p><a name="index-_0040code_007bSynopsis_007d-field-60"></a><br><dt><code>Synopsis</code><dd>(<code>text</code>) One-line summary of the problem.  <code>send-pr</code><!-- /@w --> copies
this information to the <code>Subject</code> line when you submit a Problem
Report.

     <p><a name="index-_0040code_007bSeverity_007d-field-61"></a><br><dt><code>Severity</code><dd>(<code>enum</code>) The severity of the problem.  By default, accepted
values include:

          
<a name="index-_0040emph_007bcritical_007d-severity-problems-62"></a>
<dl><dt><code>critical</code><dd>The product, component or concept is completely non-operational or some
essential functionality is missing.  No workaround is known.

          <p><a name="index-_0040emph_007bserious_007d-severity-problems-63"></a><br><dt><code>serious</code><dd>The product, component or concept is not working properly or significant
functionality is missing.  Problems that would otherwise be considered
<span class="samp">critical</span> are usually rated <span class="samp">serious</span> when a workaround is
known.

          <p><a name="index-_0040emph_007bnon_002dcritical_007d-severity-problems-64"></a><br><dt><code>non-critical</code><dd>The product, component or concept is working in general, but lacks
features, has irritating behavior, does something wrong, or doesn't
match its documentation. 
</dl>

     <p><a name="index-_0040code_007bPriority_007d-field-65"></a><br><dt><code>Priority</code><dd>(<code>enumerated</code>) How soon the originator requires a solution. 
Accepted values include:

          
<a name="index-_0040emph_007bhigh_007d-priority-problems-66"></a>
<dl><dt><code>high</code><dd>A solution is needed as soon as possible.

          <p><a name="index-_0040emph_007bmedium_007d-priority-problems-67"></a><br><dt><code>medium</code><dd>The problem should be solved in the next release.

          <p><a name="index-_0040emph_007blow_007d-priority-problems-68"></a><br><dt><code>low</code><dd>The problem should be solved in a future release. 
</dl>

     <p><a name="index-_0040code_007bCategory_007d-field-69"></a><br><dt><code>Category</code><dd>(<code>enumerated-in-file</code>) The name of the product, component or
concept where the problem lies.  The values for this field are defined
by the Support Site. 
See <a href="#categories-file">The <code>categories</code> file</a>, for details.

     <p><a name="index-_0040code_007bClass_007d-field-70"></a><br><dt><code>Class</code><dd>(<code>enumerated-in-file</code>) The class of a problem in a default
<span class="sc">gnats</span> installation can be one of the following:

          
<a name="index-_0040emph_007bsw_002dbug_007d-class-71"></a>
<dl><dt><code>sw-bug</code><dd>A general product problem.  (<span class="samp">sw</span> stands for &ldquo;software&rdquo;.)

          <p><a name="index-_0040emph_007bdoc_002dbug_007d-class-72"></a><br><dt><code>doc-bug</code><dd>A problem with the documentation.

          <p><a name="index-_0040emph_007bchange_002drequest_007d-class-73"></a><br><dt><code>change-request</code><dd>A request for a change in behavior, etc.

          <p><a name="index-_0040emph_007bsupport_007d-class-74"></a><br><dt><code>support</code><dd>A support problem or question.

          <p><a name="index-_0040emph_007bduplicate_007d-class-75"></a><br><dt><code>duplicate (</code><var>pr-number</var><code>)</code><dd>Duplicate PR.  <var>pr-number</var> should be the number of the original PR.

          <p><a name="index-_0040emph_007bmistaken_007d-class-76"></a><br><dt><code>mistaken</code><dd>No problem, user error or misunderstanding.  This value can only be set
by tools at the Support Site, since it has no meaning for ordinary
submitters. 
</dl>

     <p>See <a href="#classes-file">The <code>classes</code> file</a>, for details.

     <p><a name="index-_0040code_007bRelease_007d-field-77"></a><br><dt><code>Release</code><dd>(<code>text</code>) Release or version number of the product, component or
concept.

     <p><a name="index-_0040code_007bEnvironment_007d-field-78"></a><br><dt><code>Environment</code><dd>(<code>multitext</code>) Description of the environment where the problem
occurred: machine architecture, operating system, host and target types,
libraries, pathnames, etc.

     <p><a name="index-_0040code_007bDescription_007d-field-79"></a><br><dt><code>Description</code><dd>(<code>multitext</code>) Precise description of the problem.

     <p><a name="index-_0040code_007bHow_002dTo_002dRepeat_007d-field-80"></a><br><dt><code>How-To-Repeat</code><dd>(<code>multitext</code>) Example code, input, or activities to reproduce the
problem.  The support organization uses example code both to reproduce
the problem and to test whether the problem is fixed.  Include all
preconditions, inputs, outputs, conditions after the problem, and
symptoms.  Any additional important information should be included. 
Include all the details that would be necessary for someone else to
recreate the problem reported, however obvious.  Sometimes seemingly
arbitrary or obvious information can point the way toward a solution. 
See also <a href="#Helpful-hints">Helpful hints</a>.

     <p><a name="index-_0040code_007bFix_007d-field-81"></a><br><dt><code>Fix</code><dd>(<code>multitext</code>) A description of a solution to the problem, or a
patch which solves the problem.  (This field is most often filled in at
the Support Site; we provide it to the submitter in case he or she has
solved the problem.) 
</dl>

<p class="noindent"><span class="sc">gnats</span> adds the following fields when the PR arrives at the Support
Site:

     
<a name="index-_0040code_007bNumber_007d-field-82"></a>
<dl><dt><code>Number</code><dd>(<code>enumerated</code>) The incremental identification number for this PR. 
This is included in the automated reply to the submitter (if that
feature of <span class="sc">gnats</span> is activated; see <a href="#dbconfig-file">The <span class="file">dbconfig</span> file</a>).  It is also included in the copy of the PR that
is sent to the maintainer.

     <p>The <code>Number</code> field is often paired with the <code>Category</code> field
as

     <pre class="smallexample">          <var>category</var>/<var>number</var>
     </pre>
     <p class="noindent">in subsequent email messages.  This is <span class="sc">gnats</span>' way of tracking
followup messages that arrive by mail so that they are filed as part of
the original PR.

     <p><a name="index-_0040code_007bState_007d-field-83"></a><br><dt><code>State</code><dd>(<code>enumerated</code>) The current state of the PR.  In default <span class="sc">gnats</span>
installations, accepted values are:

          <dl>
<dt><code>open</code><dd>The PR has been filed and the responsible person notified.

          <br><dt><code>analyzed</code><dd>The responsible person has analyzed the problem.

          <br><dt><code>feedback</code><dd>The problem has been solved, and the originator has been given a patch
or other fix.  Support organizations may also choose to temporarily
&rdquo;park&rdquo; PRs that are awaiting further input from the submitter under
this state.

          <br><dt><code>closed</code><dd>The changes have been integrated, documented, and tested, and the
originator has confirmed that the solution works.

          <br><dt><code>suspended</code><dd>Work on the problem has been postponed. 
</dl>

     <p class="noindent">The initial state of a PR is <span class="samp">open</span>.  See <a href="#States">States of Problem Reports</a>.

     <p><a name="index-_0040code_007bResponsible_007d-field-84"></a><br><dt><code>Responsible</code><dd>(<code>text</code>) The person at the Support Site who is responsible for this
PR. 
<span class="sc">gnats</span> retrieves this information from the <span class="file">categories</span> file
(see <a href="#categories-file">The <code>categories</code> file</a>).

     <p><a name="index-_0040code_007bArrival_002dDate_007d-field-85"></a><br><dt><code>Arrival-Date</code><dd>(<code>date</code>) The time that this PR was received by <span class="sc">gnats</span>.  The
date is provided automatically by <span class="sc">gnats</span>.

     <p><a name="index-_0040code_007bDate_002dRequired_007d-86"></a><a name="index-_0040code_007bDate_002dRequired_007d-field-87"></a><br><dt><code>Date-Required</code><dd>(<code>date</code>) The date by which a fix is required.  This is up to the
maintainers at the Support Site to determine, so this field is not
available until after the PR has been submitted.

     <p><a name="index-_0040code_007bAudit_002dTrail_007d-field-88"></a><br><dt><code>Audit-Trail</code><dd>(<code>multitext</code>) Tracks related electronic mail as well as changes in
the <code>State</code> and <code>Responsible</code> fields with the sub-fields:

          
<a name="index-_0040code_007bState_002dChanged_002d_003cFrom_003e_002d_003cTo_003e_007d-in-_0040code_007bAudit_002dTrail_007d-89"></a>
<dl><dt><code>State-Changed-&lt;From&gt;-&lt;To&gt;:&nbsp;</code><var>oldstate</var><code>&gt;-&lt;</code><var>newstate</var><code><!-- /@w --></code><dd>The old and new <code>State</code> field values.

          <p><a name="index-_0040code_007bResponsible_002dChanged_002d_003cFrom_003e_002d_003cTo_003e_007d-in-_0040code_007bAudit_002dTrail_007d-90"></a><br><dt><code>Responsible-Changed-&lt;From&gt;-&lt;To&gt;:&nbsp;</code><var>oldresp</var><code>&gt;-&lt;</code><var>newresp</var><code><!-- /@w --></code><dd>The old and new <code>Responsible</code> field values.

          <p><a name="index-_0040code_007bState_002dChanged_002dBy_007d-in-_0040code_007bAudit_002dTrail_007d-91"></a><a name="index-_0040code_007bResponsible_002dChanged_002dBy_007d-in-_0040code_007bAudit_002dTrail_007d-92"></a><br><dt><code>State-Changed-By: </code><var>name</var><dt><code>Responsible-Changed-By: </code><var>name</var><dd>The name of the maintainer who effected the change.

          <p><a name="index-_0040code_007bState_002dChanged_002dWhen_007d-in-_0040code_007bAudit_002dTrail_007d-93"></a><a name="index-_0040code_007bResponsible_002dChanged_002dWhen_007d-in-_0040code_007bAudit_002dTrail_007d-94"></a><br><dt><code>State-Changed-When: </code><var>timestamp</var><dt><code>Responsible-Changed-When: </code><var>timestamp</var><dd>The time the change was made.

          <p><a name="index-_0040code_007bState_002dChanged_002dWhy_007d-in-_0040code_007bAudit_002dTrail_007d-95"></a><a name="index-_0040code_007bResponsible_002dChanged_002dWhy_007d-in-_0040code_007bAudit_002dTrail_007d-96"></a><br><dt><code>State-Changed-Why: </code><var>reason<small class="dots">...</small></var><dt><code>Responsible-Changed-Why: </code><var>reason<small class="dots">...</small></var><dd>The reason for the change. 
</dl>

     <p><a name="index-follow_002dup-via-email-97"></a><a name="index-subsequent-mail-98"></a><a name="index-related-mail-99"></a>The <code>Audit-Trail</code> field also contains any mail messages received by
<span class="sc">gnats</span> related to this PR, in the order received.  <span class="sc">gnats</span> needs
to find a reference to the PR in the Subject field of received email in
order to be able to file it correctly, see <a href="#follow_002dup-via-email">Following up via direct email</a>.

     <p><a name="index-_0040code_007bUnformatted_007d-field-100"></a><br><dt><code>Unformatted</code><dd>(<code>multitext</code>) Any random text found outside the fields in the
original Problem Report. 
</dl>

   <p>During a Problem Report's journey from <span class="samp">open</span> to <span class="samp">closed</span>, two
more fields, <code>Last-Modified</code> and <code>Closed Date</code> (both of type
<code>date</code>) will be added.

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="GNATS-user-tools"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installation">Installation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">2 The <span class="sc">gnats</span> User Tools</h2>

<p><a name="index-usage-for-the-_0040sc_007bgnats_007d-user-tools-101"></a><a name="index-invoking-the-_0040sc_007bgnats_007d-user-tools-102"></a>
This chapter describes the user tools distributed with <span class="sc">gnats</span>.  The
<span class="sc">gnats</span> administrative and internal tools are described in
<a href="#Management"><span class="sc">gnats</span> Administration</a>. The user tools provide
facilities for initial submission, querying and editing of Problem
Reports:

     <dl>
<dt><code>send-pr</code><dd>Used by anyone who has a problem with a body of work to submit a report
of the problem to the maintainers of that work
(see <a href="#send_002dpr">Submitting Problem Reports</a>).

     <br><dt><code>query-pr</code><dd>Used to query the <span class="sc">gnats</span> database (see <a href="#query_002dpr">Querying the database</a>).

     <br><dt><code>edit-pr</code><dd>Used to edit Problem Reports (to record new data, to change the
responsible party, etc.) (see <a href="#edit_002dpr">Editing existing Problem Reports</a>). 
</dl>

<ul class="menu">
<li><a accesskey="1" href="#Environment">Environment</a>:        Environment variables and GNATS tools
<li><a accesskey="2" href="#send_002dpr">send-pr</a>:            Submitting Problem Reports
<li><a accesskey="3" href="#edit_002dpr">edit-pr</a>:            Editing existing Problem Reports
<li><a accesskey="4" href="#query_002dpr">query-pr</a>:           Querying the database
<li><a accesskey="5" href="#Emacs">Emacs</a>:              The Emacs interface
</ul>

<div class="node">
<p><hr>
<a name="Environment"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#send_002dpr">send-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GNATS-user-tools">GNATS user tools</a>
<br>
</div>

<h3 class="section">2.1 Environment variables and <span class="sc">gnats</span> tools</h3>

<p><a name="index-environment-variables-and-GNATS-tools-103"></a><a name="index-_0040code_007bGNATSDB_007d-104"></a>
All the <span class="sc">gnats</span> user tools honor the <code>GNATSDB</code> environment
variable which is used to determine which database to use.  For a local
database, it contains the name of the database to access.

   <p>For network access via gnatsd, it contains a colon-separated list of
strings that describe the remote database in the form

<pre class="smalldisplay">     <var>server:port:databasename:username:password</var>
</pre>
   <p>Any of the fields may be omitted except for <var>server</var>, but at least
one colon must appear; otherwise, the value is assumed to be the name of
a local database.

   <p>If <code>GNATSDB</code> is not set and no command-line options are used to
specify the database, it is assumed that the database is local and that
its name is <span class="samp">default</span>.

<div class="node">
<p><hr>
<a name="send_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#edit_002dpr">edit-pr</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Environment">Environment</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GNATS-user-tools">GNATS user tools</a>
<br>
</div>

<h3 class="section">2.2 Submitting Problem Reports</h3>

<p><a name="index-_0040code_007bsend_002dpr_007d-105"></a><a name="index-using-_0040code_007bsend_002dpr_007d-106"></a><a name="index-invoking-_0040code_007bsend_002dpr_007d-107"></a><a name="index-reporting-problems-with-_0040code_007bsend_002dpr_007d-108"></a>
Use <code>send-pr</code> to submit Problem Reports to the database. 
<code>send-pr</code> is a shell script which composes a template for
submitters to complete.

   <p>You can invoke <code>send-pr</code> from a shell prompt, or from within
<span class="sc">gnu</span> Emacs using <span class="samp">M-x&nbsp;send-pr</span><!-- /@w --> (see <a href="#Emacs-submitting">Submitting Problem Reports from Emacs</a>.)

<ul class="menu">
<li><a accesskey="1" href="#PR-template">PR template</a>:                The Problem Report template
<li><a accesskey="2" href="#send_002dpr-in-Emacs">send-pr in Emacs</a>:           Using send-pr from within Emacs
<li><a accesskey="3" href="#send_002dpr-from-the-shell">send-pr from the shell</a>:     Invoking send-pr from the shell
<li><a accesskey="4" href="#Submitting-via-e_002dmail">Submitting via e-mail</a>:      Submitting a Problem Report via direct e-mail
<li><a accesskey="5" href="#Helpful-hints">Helpful hints</a>
</ul>

<div class="node">
<p><hr>
<a name="send_002dpr-from-the-shell"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Submitting-via-e_002dmail">Submitting via e-mail</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#send_002dpr-in-Emacs">send-pr in Emacs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#send_002dpr">send-pr</a>
<br>
</div>

<h4 class="subsection">2.2.1 Invoking <code>send-pr</code> from the shell</h4>

<p><a name="index-command-line-options-109"></a><a name="index-invoking-_0040code_007bsend_002dpr_007d-from-the-shell-110"></a><a name="index-shell-invocation-111"></a>
<pre class="smallexample">     send-pr [ -b | --batch ]
             [ -d <var>database</var> | --database <var>database</var> ]
             [ -f <var>file</var> | --file <var>file</var> ]
             [ -p | --print ] [ --request-id ]
             [ -s <var>severity</var> | --severity <var>severity</var> ]
             [ -V | --version ] [ -h | --help ]
</pre>
   <p>Invoking <code>send-pr</code> with no options assumes that you want to
submit to the local <span class="sc">gnats</span> database named <var>default</var> and calls
the editor named in your environment variable <code>EDITOR</code> on a PR
template for this database.

     <dl>
<dt><code>-b</code><dt><code>--batch</code><dd>Suppresses printing of most of the messages <code>send-pr</code> usually
prints while running.

     <br><dt><code>-d </code><var>database</var><code>, --database </code><var>database</var><dd>Specifies the database to which the PR is to be submitted; if no
database is specified, the local database named <code>default</code> is
assumed.  This option overrides the database specified in the
<code>GNATSDB</code> environment variable.  <var>database</var> can also be set
to a remote database by using the format for <code>GNATSDB</code> described
in <a href="#Environment">Environment variables and <span class="sc">gnats</span> tools</a>.

     <br><dt><code>-f </code><var>problem-report</var><dt><code>--file </code><var>problem-report</var><dd>Specifies a file, <var>problem-report</var>, where a completed Problem
Report or a PR template exists.  <code>send-pr</code> verifies that the
contents of the file constitute a valid PR and asks you if you want to
edit it or send it directly.  If the PR text is invalid you will be
told what is wrong and be given the option to edit it. If
<var>problem-report</var> is <span class="samp">-</span>, <code>send-pr</code><!-- /@w --> reads from
standard input.

     <br><dt><code>-p</code><dt><code>--print</code><dd>Displays the PR template for the specified database, or if the
<code>-d</code> or <code>--database</code> options aren't specified, print the
template for the local <var>default</var> database.  No PR is submitted.

     <br><dt><code>--request-id</code><dd>Sends a request for a <code>Submitter-Id</code> to the Support Site.

     <br><dt><code>-s </code><var>severity</var><dt><code>--severity </code><var>severity</var><dd><a name="index-_0040code_007bsend_002dpr_007d-fields-112"></a>Sets the initial value of the <code>Severity</code> field to <var>severity</var>.

     <br><dt><code>-V</code><dt><code>--version</code><dd>Displays the <code>send-pr</code> version number and a usage summary.  No mail
is sent.

     <br><dt><code>-h</code><dt><code>--help</code><dd>Displays a usage summary for <code>send-pr</code>.  No mail is sent. 
</dl>

<!--  -->
<div class="node">
<p><hr>
<a name="send_002dpr-in-Emacs"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#send_002dpr-from-the-shell">send-pr from the shell</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#PR-template">PR template</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#send_002dpr">send-pr</a>
<br>
</div>

<h4 class="subsection">2.2.2 Using <code>send-pr</code> from within Emacs</h4>

<p><a name="index-using-_0040code_007bsend_002dpr_007d-from-within-Emacs-113"></a><a name="index-_0040code_007bsend_002dpr_007d-within-Emacs-114"></a><a name="index-invoking-_0040code_007bsend_002dpr_007d-from-Emacs-115"></a><a name="index-interactive-interface-116"></a>
You can use an interactive <code>send-pr</code> interface from within <span class="sc">gnu</span>
Emacs to fill out your Problem Report.  We recommend that you
familiarize yourself with Emacs before using this feature
(see <a href="emacs.html#Introduction">Introduction (GNU Emacs)</a>).

   <p>Call <code>send-pr</code> with <span class="samp">M-x&nbsp;send-pr</span><!-- /@w -->.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>  <code>send-pr</code> responds
with a preconfigured Problem Report template.  The Emacs interface is
described in more detail in a separate section, See <a href="#Emacs">The Emacs interface to <span class="sc">gnats</span></a>.

<div class="node">
<p><hr>
<a name="PR-template"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#send_002dpr-in-Emacs">send-pr in Emacs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#send_002dpr">send-pr</a>
<br>
</div>

<h4 class="subsection">2.2.3 The Problem Report template</h4>

<p>Invoking <code>send-pr</code> presents a PR <dfn>template</dfn> with a number of
fields already filled in with default values for the database you are
submitting to.  Complete the template as thoroughly as possible to
make a useful bug report.  Submit only one bug with each PR.

   <p><a name="index-template-117"></a>A template consists of three sections:

     <ul>
<li>Comments
<li>Mail Header
<li><span class="sc">gnats</span> fields
</ul>

   <p>The <strong>Comments section</strong> at the top of the template contains basic
instructions for completing the Problem Report, as well as a list of
valid entries for the <code>Category</code> field.  One (and only one) of
these values should be placed in the <code>Category</code> field further down
in the Problem Report.

   <p><a name="index-template-comment-section-118"></a><a name="index-comment-section-in-the-PR-template-119"></a>
<pre class="smallexample">     SEND-PR: -*- send-pr  -*-
     SEND-PR: Lines starting with `SEND-PR' will be removed
     SEND-PR: automatically as well as all comments (the text
     SEND-PR: below enclosed in `&lt;' and `&gt;').
     SEND-PR:
     SEND-PR: Please consult the document `Reporting Problems
     SEND-PR: Using send-pr' if you are not sure how to fill out
     SEND-PR: a problem report.
     SEND-PR:
     SEND-PR: Choose from the following categories:
</pre>
   <p>The comments lines are all preceded by the string <span class="samp">SEND-PR:</span> and
are erased automatically when the PR is submitted.  The instructional
comments within <span class="samp">&lt;</span> and <span class="samp">&gt;</span> are also removed.  (Only these
comments are removed; lines you provide that happen to have those
characters in them, such as examples of shell-level redirection, are not
affected.)

   <p>The <strong>Mail Header</strong> section of the template contains a standard
mail header constructed by <code>send-pr</code>.  <code>send-pr</code> can be set up
to submit PRs by e-mail or by speaking directly to the <span class="sc">gnats</span>
server, but since this header is part of the standard format of Problem
Reports, <code>send-pr</code> includes it even when it is set up to speak
directly to the server.

   <p><a name="index-mail-header-section-120"></a>
<pre class="smallexample">     To: <var>PR submission address</var>
     Subject: <em>complete this field</em>
     From: <var>your-login</var>@<var>your-site</var>
     Reply-To: <var>your-login</var>@<var>your-site</var>
     X-send-pr-version: send-pr 4.1.999
</pre>
   <p class="noindent"><code>send-pr</code> automatically completes all the mail header fields except
the <code>Subject</code> line with default values.  (See <a href="#Fields">Problem Report format</a>.)

   <p>The <span class="sc">gnats</span><strong> fields</strong> below the mail header form the bulk of a
<span class="sc">gnats</span> Problem Report.

   <p>Each field is either automatically completed with valid information
(such as your <code>Submitter-Id</code>) or contains a one-line instruction
specifying the information that field requires in order to be correct. 
For example, the <code>Confidential</code> field expects a value of <span class="samp">yes</span>
or <span class="samp">no</span>, and the answer must fit on one line; similarly, the
<code>Synopsis</code> field expects a short synopsis of the problem, which
must also fit on one line.  Fill out the fields as completely as
possible.  See <a href="#Helpful-hints">Helpful hints</a>, for suggestions as to
what kinds of information to include.

   <p>The mechanisms <code>send-pr</code> uses to fill in default values is as
follows: Your preconfigured <code>Submitter-Id</code> is taken from the local
<span class="file">send-pr.conf</span> configuration file.  <code>send-pr</code> will set the
<code>Originator</code> field to the value of the <code>NAME</code> environment
variable if it has been set; similarly, <code>Organization</code> will be set
to the value of <code>ORGANIZATION</code>.  If these variables aren't set in
you environment, <code>send-pr</code> uses the values set in the local
<span class="file">send-pr.conf</span> configuration file, if that exists.  If not, these
values are left blank in the template.  <code>send-pr</code> also attempts to
find out some information about your system and architecture, and places
this information in the <code>Environment</code> field if it finds any.

   <p>In this example, words in <em>italics</em> are filled in with
pre-configured information:

   <p><a name="index-_0040code_007bsend_002dpr_007d-fields-121"></a>
<pre class="smallexample">     &gt;Submitter-Id: <em>your submitter-id</em>
     &gt;Originator:   <em>your name here</em>
     &gt;Organization:
         <em>your organization</em>
     &gt;Confidential:&lt;[ yes | no ] (one line)&gt;
     &gt;Synopsis:    &lt;synopsis of the problem (one line)&gt;
     &gt;Severity:    &lt;[non-critical | serious | critical](one line)&gt;
     &gt;Priority:    &lt;[ low | medium | high ] (one line)&gt;
     &gt;Category:    &lt;name of the product (one line)&gt;
     &gt;Class:       &lt;[sw-bug | doc-bug | change-request | support]&gt;
     &gt;Release:     &lt;release number (one line)&gt;
     &gt;Environment:
              &lt;machine, os, target, libraries (multiple lines)&gt;
     
     &gt;Description:
            &lt;precise description of the problem (multiple lines)&gt;
     &gt;How-To-Repeat:
            &lt;code/input/activities to reproduce (multiple lines)&gt;
     &gt;Fix:
            &lt;how to correct or work around the problem, if known
             (multiple lines)&gt;
</pre>
   <p><a name="index-_0040code_007bSubmitter_002dId_007d-field-122"></a><a name="index-_0040code_007b_003eSubmitter_002dId_007d-123"></a>When you finish editing the Problem Report, <code>send-pr</code> validates the
contents and if it looks OK either submits it directly to the
<span class="sc">gnats</span> server or submits it by mail to the address named in the
<code>To</code> field in the mail header.

   <p><a name="index-bad-Problem-Reports-124"></a><a name="index-errors-125"></a><a name="index-invalid-Problem-Reports-126"></a>If your PR contains one or more invalid field values, <code>send-pr</code>
places the PR in a temporary file named <span class="file">/tmp/pbad</span><var>nnnn</var> on
your machine.  <var>nnnn</var> is the process identification number given
to your current <code>send-pr</code> session.  If you are running
<code>send-pr</code> from the shell, you are prompted as to whether or not
you wish to try editing the same Problem Report again.  If you are
running <code>send-pr</code> from Emacs, the Problem Report is placed in the
buffer <span class="samp">*gnats-send*</span><!-- /@w -->; you can edit this file and then submit
it with <kbd>C-c C-c</kbd>.

<!--  -->
<div class="node">
<p><hr>
<a name="Submitting-via-e_002dmail"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Helpful-hints">Helpful hints</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#send_002dpr-from-the-shell">send-pr from the shell</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#send_002dpr">send-pr</a>
<br>
</div>

<h4 class="subsection">2.2.4 Submitting a Problem Report via direct e-mail</h4>

<p><a name="index-Direct-e_002dmail-127"></a><a name="index-Submitting-a-PR-via-e_002dmail-128"></a>In addition to using <code>send-pr</code>, there is another way to submit a
problem report.  You can simply send an e-mail message to the PR
submission e-mail address of the support site (This address should be
published by the support site.)

   <p>When you send unformatted e-mail to this address, <span class="sc">gnats</span> processes
the message as a new problem report, filling in as many fields from
defaults as it can:

     <dl>
<dt><code>Synopsis</code><dd>The <code>Synopsis</code> field is filled in by the <code>Subject</code> header of
the e-mail message.

     <br><dt><code>Submitter ID</code><dd><span class="sc">gnats</span> will try to derive the <code>Submitter</code> field from the address
in the <code>From</code> header of the e-mail.

     <br><dt><code>Description</code><dd>All of the text in the body of the e-mail message is put into the
<code>Description</code> field. 
</dl>

   <p>Other fields, such as <code>Category</code>, <code>Version</code>, <code>Severity</code>,
etc. are set to default values as defined by the <span class="sc">gnats</span> administrator.

<!--  -->
<div class="node">
<p><hr>
<a name="Helpful-hints"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Submitting-via-e_002dmail">Submitting via e-mail</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#send_002dpr">send-pr</a>
<br>
</div>

<h4 class="subsection">2.2.5 Helpful hints</h4>

<p><a name="index-helpful-hints-129"></a><a name="index-Using-and-Porting-_0040sc_007bgnu_007d-CC-130"></a><a name="index-effective-problem-reporting-131"></a><a name="index-kinds-of-helpful-information-132"></a><a name="index-information-to-submit-133"></a><a name="index-Report-all-the-facts_0021-134"></a>
There is no orthodox standard for submitting effective bug reports,
though you might do well to consult the section on submitting bugs for
<span class="sc">gnu</span> <code>gcc</code> in <a href="gcc.html#Bugs">Reporting Bugs (Using and Porting GNU CC)</a>, by Richard Stallman.  This section contains
instructions on what kinds of information to include and what kinds of
mistakes to avoid.

   <p>In general, common sense (assuming such an animal exists) dictates the
kind of information that would be most helpful in tracking down and
resolving problems in software.
     <ul>
<li>Include anything <em>you</em> would want to know if you were looking at
the report from the other end.  There's no need to include every minute
detail about your environment, although anything that might be different
from someone else's environment should be included (your path, for
instance).

     <li>Narratives are often useful, given a certain degree of restraint.  If a
person responsible for a bug can see that A was executed, and then B and
then C, knowing that sequence of events might trigger the realization of
an intermediate step that was missing, or an extra step that might have
changed the environment enough to cause a visible problem.  Again,
restraint is always in order (&ldquo;I set the build running, went to get a
cup of coffee (Columbian, cream but no sugar), talked to Sheila on the
phone, and then THIS happened<small class="dots">...</small>&rdquo;) but be sure to include anything
relevant.

     <li>Richard Stallman writes, &ldquo;The fundamental principle of reporting bugs
usefully is this: <strong>report all the facts</strong>.  If you are not sure
whether to state a fact or leave it out, state it!&rdquo;  This holds true
across all problem reporting systems, for computer software or social
injustice or motorcycle maintenance.  It is especially important in the
software field due to the major differences seemingly insignificant
changes can make (a changed variable, a missing semicolon, etc.).

     <li>Submit only <em>one</em> problem with each Problem Report.  If you have
multiple problems, use multiple PRs.  This aids in tracking each problem
and also in analyzing the problems associated with a given program.

     <li>It never hurts to do a little research to find out if the bug you've
found has already been reported.  Most software releases contain lists
of known bugs in the Release Notes which come with the software; see
your system administrator if you don't have a copy of these.

     <li>The more closely a PR adheres to the standard format, the less
interaction is required by a database administrator to route the
information to the proper place.  Keep in mind that anything that
requires human interaction also requires time that might be better spent
in actually fixing the problem.  It is therefore in everyone's best
interest that the information contained in a PR be as correct as
possible (in both format and content) at the time of submission. 
</ul>

<!--  -->
<div class="node">
<p><hr>
<a name="edit_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#query_002dpr">query-pr</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#send_002dpr">send-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GNATS-user-tools">GNATS user tools</a>
<br>
</div>

<h3 class="section">2.3 Editing existing Problem Reports</h3>

<p><a name="index-using-_0040code_007bedit_002dpr_007d-135"></a><a name="index-invoking-_0040code_007bedit_002dpr_007d-136"></a><a name="index-_0040code_007bedit_002dpr_007d-137"></a>
Use <code>edit-pr</code> to make changes to existing PRs in the database. 
This tool can be invoked both from a shell prompt or from within GNU
Emacs using <span class="samp">M-x edit-pr</span>.

   <p><code>edit-pr</code> first examines the PR you wish to edit and locks it if it
is not already locked.  This is to prevent you from editing a PR at the
same time as another user.  If the PR you wish to edit is already in the
process of being edited, <code>edit-pr</code> tells you the name of the person
who owns the lock.

   <p>You may edit any non-readonly fields in the database.  We recommend that
you avoid deleting any information in the <span class="sc">Text</span> and <span class="sc">MultiText</span>
fields (such as <code>Description</code> and <code>How-To-Repeat</code>
(see <a href="#Fields">Problem Report format</a>).  We also recommend that you
record the final solution to the problem in the <code>Fix</code> field for
future reference.  Note that heavily customized installations of
<span class="sc">gnats</span> may have differently named fields, and sites using such
installations should provide their own set of routines and instructions
regarding how PRs should be treated throughout their life span.

   <p>After the PR has been edited, it is then resubmitted to the database,
and the index is updated (see <a href="#index-file">The <code>index</code> file</a>). 
For information on <code>pr-edit</code>, the main driver for <code>edit-pr</code>,
see <a href="#Internal-utils">Internal utilities</a>.

   <p>If you change a field that requires a reason for the change, such as the
<code>Responsible</code> or <code>State</code> fields in the default configuration,
<code>edit-pr</code> prompts you to supply a reason for the change.  A message
is then appended to the <code>Audit-Trail</code> field of the PR with the
changed values and the change reason.

   <p>Depending on how the database is configured, editing various fields in
the PR may also cause mail to be sent concerning these changes.  In the
default configuration, any fields that generate <span class="samp">Audit-Trail</span>
entries will also cause a copy of the new <span class="samp">Audit-Trail</span> message to
be sent.

   <p>Mail received at the PR submission email address and recognized by
<span class="sc">gnats</span> as relating to an existing PR is also appended to the
<span class="samp">Audit-Trail</span> field, see <a href="#follow_002dup-via-email">follow-up via email</a>.

<ul class="menu">
<li><a accesskey="1" href="#edit_002dpr-from-the-shell">edit-pr from the shell</a>:   Invoking <code>edit-pr</code> from the shell
<li><a accesskey="2" href="#follow_002dup-via-email">follow-up via email</a>:  Following up via direct email
</ul>

<div class="node">
<p><hr>
<a name="edit_002dpr-from-the-shell"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#follow_002dup-via-email">follow-up via email</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#edit_002dpr">edit-pr</a>
<br>
</div>

<h4 class="subsection">2.3.1 Invoking <code>edit-pr</code> from the shell</h4>

<p><a name="index-_0040code_007bedit_002dpr_007d-from-the-shell-138"></a>
The usage for <code>edit-pr</code> is:

<pre class="smallexample">     edit-pr [ -V | --version ] [ -h | --help ]
             [-d <var>database</var> | --database <var>database</var>] <var>PR Number</var>
</pre>
   <p class="noindent">Network-mode-only options:

<pre class="smallexample">              [--host <var>host</var> | -H <var>host</var>] [--port <var>port</var>]
              [--user <var>user</var> | -v <var>user</var>]
              [--passwd <var>passwd</var> | -w <var>passwd</var>]
</pre>
   <p class="noindent">The options have the following meaning:

     <dl>
<dt><code>-h, --help</code><dd>Prints a brief usage message for edit-pr.

     <br><dt><code>-V, --version</code><dd>Prints the version number for edit-pr.

     <br><dt><code>-d </code><var>database</var><code>, --database </code><var>database</var><dd>Specifies the database containing the PR to be edited; if no database is
specified, the database named <span class="samp">default</span> is assumed.  This option
overrides the database specified in the <code>GNATSDB</code> environment
variable.

     <br><dt><code>--host </code><var>host</var><code>, -H </code><var>host</var><dd>Specifies the hostname of the gnatsd server to communicate with.  This
overrides the value in the <code>GNATSDB</code> environment variable.

     <br><dt><code>--port </code><var>port</var><dd>Specifies the port number of the gnatsd server to communicate with. 
This overrides the value in the <code>GNATSDB</code> environment variable.

     <br><dt><code>--user </code><var>user</var><code>, -v </code><var>user</var><dd>Specifies the username to login with when connecting to the gnatsd
server.  This overrides the value in the <code>GNATSDB</code> environment
variable.

     <br><dt><code>--passwd </code><var>passwd</var><code>, -w </code><var>passwd</var><dd>Specifies the password to login with when connecting to the gnatsd
server.  This overrides the value in the <code>GNATSDB</code> environment
variable. 
</dl>

   <p><code>edit-pr</code> calls the editor specified in your environment variable
<code>EDITOR</code> on a temporary copy of that PR.  (If you don't have the
variable <code>EDITOR</code> defined in your environment, the default editor
<code>vi</code> is used.)

   <p>Edit the PR, changing any relevant fields or adding to existing
information.  When you exit the editor, <code>edit-pr</code> prompts you on
standard input for a reason if you have changed a field that requires
specifying a reason for the change.

<div class="node">
<p><hr>
<a name="follow_002dup-via-email"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#edit_002dpr-from-the-shell">edit-pr from the shell</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#edit_002dpr">edit-pr</a>
<br>
</div>

<h4 class="subsection">2.3.2 Following up via direct email</h4>

<p><a name="index-follow_002dup-via-email-139"></a><a name="index-subsequent-mail-140"></a><a name="index-related-mail-141"></a>
If you have some additional information for a PR and for some reason
do not want to (or cannot) edit the PR directly, you may append
the information to the Audit-Trail field by mailing it to the PR
submission address.

   <p>In order for GNATS to be able to recognize the mail as pertaining to an
existing PR (as opposed to a new PR, see <a href="#Submitting-via-e_002dmail">Submitting via e-mail</a>),
the Subject mail header field must contain a reference to the PR. 
GNATS matches the Subject header against the regular expression

<pre class="smallexample">     \&lt;(PR[ \t#/]?|[-[:alnum:]+.]+/)[0-9]+
</pre>
   <p class="noindent">to determine whether such a reference is present. Any text may precede
or follow the reference in the Subject header. If more than one reference
is present, the first is used and the rest ignored.

   <p>A PR reference matching the regular expression above has two parts. The
second is the PR number (one or more digits). The first is either the
capital letters 'PR' optionally followed by a separator character (blank,
tab, hash mark or forward slash) or the category name followed by a
forward slash. Following are some examples which match the regular
expression:

<pre class="smallexample">     PR 123 PR4567 PR#890 gnats/4711
</pre>
   <p>The PR number and the category (if present) are checked for existence,
and if the outcome is positive, the mail is appended to the Audit-Trail
field of the PR. Note that the PR need not belong to the category because
PRs may move between categories.

   <p>Outgoing emails sent by GNATS itself may be configured to have a Subject
header field that refers to the PR in question:

<pre class="smallexample">     Subject: Re: PR <var>category</var>/<var>gnats-id</var>: <var>original message subject</var>
</pre>
   <p>This makes it extremely easy to follow up on a PR by replying to such an
email, see <a href="#dbconfig-file">The <code>dbconfig</code> file</a> and the sample,
default <code>dbconfig</code> file installed by <code>mkdb</code>.

<!--  -->
<div class="node">
<p><hr>
<a name="query_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs">Emacs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#edit_002dpr">edit-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GNATS-user-tools">GNATS user tools</a>
<br>
</div>

<h3 class="section">2.4 Querying the database</h3>

<p><a name="index-using-_0040code_007bquery_002dpr_007d-142"></a><a name="index-invoking-_0040code_007bquery_002dpr_007d-143"></a><a name="index-_0040code_007bquery_002dpr_007d-144"></a><a name="index-querying-individual-problem-reports-145"></a>
Obtain information from the database by using the program
<code>query-pr</code><!-- /@w -->. <code>query-pr</code> uses search parameters you provide
to find matching Problem Reports in the database.  You can invoke
<code>query-pr</code> from the shell or from within Emacs.  <code>query-pr</code>
uses the same arguments whether it is invoked from the shell or from
Emacs.

   <p>PRs may be selected via the use of the <code>--expr</code> option, directly by
number, or by the use of the (now deprecated) field-specific query
operators.

   <p>By default, query options are connected with a logical AND.  For
example,

<pre class="smallexample">     query-pr --category=foo --responsible=bar
</pre>
   <p class="noindent">only prints PRs which have a Category field of <span class="samp">foo</span> and a Responsible
field of <span class="samp">bar</span>.

   <p>The <code>--or</code> option may be used to connect query options with a logical
OR. For example,

<pre class="smallexample">     query-pr --category=baz --or --responsible=blee
</pre>
   <p class="noindent">prints PRs which have either a Category field of <span class="samp">baz</span> or a Responsible
field of <span class="samp">blee</span>.

   <p>It should be emphasized, however, that the use of these field-specific
options is strongly discouraged, since they exist only for compatibility
with older versions of <span class="sc">gnats</span> and are likely to be deleted in the next
release.  The expressions specified by the <code>--expr</code> option are much more
flexible (see below).

<ul class="menu">
<li><a accesskey="1" href="#Invoking-query_002dpr">Invoking query-pr</a>
<li><a accesskey="2" href="#Formatting-query_002dpr-output">Formatting query-pr output</a>
<li><a accesskey="3" href="#Query-expressions">Query expressions</a>
<li><a accesskey="4" href="#Example-queries">Example queries</a>
</ul>

<div class="node">
<p><hr>
<a name="Invoking-query_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Formatting-query_002dpr-output">Formatting query-pr output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#query_002dpr">query-pr</a>
<br>
</div>

<h4 class="subsection">2.4.1 Invoking <code>query-pr</code></h4>

<p>From the shell, simply type <kbd>query-pr</kbd>, followed by any search
parameters you wish to exercise.  From Emacs, type <kbd>M-x&nbsp;query-pr</kbd><!-- /@w -->.  <code>query-pr</code> prompts you for search parameters in the
minibuffer.

   <p><a name="index-_0040code_007bquery_002dpr_007d-by-mail-146"></a><code>query-pr</code> can also be accessed by electronic mail, if your version
of <span class="sc">gnats</span> is configured for this.  To use this feature, simply send
mail to the address <span class="samp">query-pr@</span><var>your-site</var><!-- /@w --> with command
line arguments or options in the <code>Subject</code> line of the mail header. 
<span class="sc">gnats</span> replies to your mail with the results of your query.  The
default settings for the <code>query-pr</code> mail server are

   <p><a name="index-the-section-on-query_002dby_002dmail-needs-to-be-relocated-147"></a>
<pre class="smallexample">     --restricted --state="open|analyzed|feedback|suspended"
</pre>
   <p class="noindent">To override the <code>--state</code> parameter, specify
<code>--state=</code><var>state</var><!-- /@w --> in the <code>Subject</code> line of the mail
header.  You can not query on confidential Problem Reports by mail.

   <p>The usage for <code>query-pr</code> is:

<pre class="smallexample">     query-pr [--debug | -D] [--help | -h] [--version | -V]
              [--output <var>file</var> | -o <var>file</var>] [--list-databases]
              [--list-fields] [--list-input-fields]
              [--responsible-address <var>name</var>] [--field-type <var>field</var>]
              [--field-description <var>field</var>]
              [--field-flags <var>field</var>]
              [--adm-field <var>field</var>] [--adm-subfield <var>subfield</var>]
              [--adm-key <var>key</var>]
              [--valid-values <var>field</var>]
              [--format <var>format</var> | -f <var>format</var>]
              [--full | -F] [--summary | -q]
              [--database <var>database</var> | -d <var>database</var>] [--and | -&amp;]
              [--or | -|] [--expr <var>expr</var>] [PR Number]
</pre>
   <p>Non-network-mode options:

<pre class="smallexample">              [--print-sh-vars] [--print-directory-for-database]
</pre>
   <p>Network-mode-only options:

<pre class="smallexample">              [--host <var>host</var> | -H <var>host</var>] [--port <var>port</var>]
              [--user <var>user</var> | -v <var>user</var>] [--passwd <var>passwd</var> | -w <var>passwd</var>]
              [--print-server-addr]
</pre>
   <p>Deprecated Options:
<pre class="smallexample">              [--list-categories | -j] [--list-states | -T]
              [--list-responsible | -k] [--list-submitters | -l]
              [--category <var>category</var> | -c <var>category</var>]
              [--synopsis <var>synopsis</var> | -y <var>synopsis</var>]
              [--confidential <var>confidential</var> | -C <var>confidential</var>]
              [--multitext <var>multitext</var> | -m <var>multitext</var>]
              [--originator <var>originator</var> | -O <var>originator</var>]
              [--release <var>release</var> | -A <var>release</var>]
              [--class <var>class</var> | -L <var>class</var>] [--cases <var>cases</var> | -E <var>cases</var>]
              [--quarter <var>quarter</var> | -Q <var>quarter</var>]
              [--keywords <var>keywords</var> | -K <var>keywords</var>]
              [--priority <var>priority</var> | -p <var>priority</var>]
              [--responsible <var>responsible</var> | -r <var>responsible</var>]
              [--restricted | -R] [--severity <var>severity</var> | -e <var>severity</var>]
              [--skip-closed | -x] [--sql | -i] [--sql2 | -I]
              [--state <var>state</var> | -s <var>state</var>]
              [--submitter <var>submitter</var> | -S <var>submitter</var>]
              [--text <var>text</var> | -t <var>text</var>]
              [--required-before <var>date</var> | -u <var>date</var>]
              [--required-after <var>date</var> | -U <var>date</var>]
              [--arrived-before <var>date</var> | -b <var>date</var>]
              [--arrived-after <var>date</var> | -a <var>date</var>]
              [--modified-before <var>date</var> | -B <var>date</var>]
              [--modified-after <var>date</var> | -M <var>date</var>]
              [--closed-before <var>date</var> | -z <var>date</var>]
              [--closed-after <var>date</var> | -Z <var>date</var>]
</pre>
   <p>The options have the following meaning:
     <dl>
<dt><code>--help, -h</code><dd>Prints a help message.

     <br><dt><code>--version, -V</code><dd>Displays the program version to stdout.

     <br><dt><code>--output </code><var>file</var><code>, -o </code><var>file</var><dd>The results of the query will be placed in this file.

     <br><dt><code>--database </code><var>database</var><code>, -d </code><var>database</var><dd>Specifies the database to be used for the query.  If no database is
specified, the database named default is assumed.  (This option
overrides the database specified in the <code>GNATSDB</code> environment
variable; see <a href="#Environment">Environment</a> for more
information.)

     <br><dt><code>--list-categories, -j</code><dd>Lists the available PR categories for the selected database.

     <br><dt><code>--list-states, -T</code><dd>Lists the valid PR states for PRs in this database.

     <br><dt><code>--list-responsible, -k</code><dd>Lists the users that appear in the database's responsible list.

     <br><dt><code>--list-submitters, -l</code><dd>Lists the valid submitters for this database. 
</dl>

   <p>The previous &ndash;list-* options are deprecated and may be removed in
future releases of <span class="sc">gnats</span>; their functionality can be replaced with

<pre class="smallexample">     query-pr --valid-values <var>field</var>
</pre>
   <p class="noindent">where <var>field</var> is one of <code>Category</code>, <code>Class</code>,
<code>Responsible</code>, <code>Submitter-Id</code>, or <code>State</code>.

     <dl>
<dt><code>--list-databases</code><dd>Lists the known databases.

     <br><dt><code>--list-fields</code><dd>Lists the entire set of field names for PRs in the selected database.

     <br><dt><code>--list-input-fields</code><dd>Lists the fields that should be provided when creating a new PR for the
currently-specified database.  The fields are listed in an order that
would make sense when used in a template or form.

     <br><dt><code>--field-type </code><var>field</var><dd>Returns the data type contained in PR field <var>field</var>.  The current
set of data types includes <span class="samp">text</span>, <span class="samp">multitext</span>, <span class="samp">enum</span>,
<span class="samp">multienum</span>, <span class="samp">enumerated-in-file</span>,
<span class="samp">multi-enumerated-in-file</span>, <span class="samp">date</span> and <span class="samp">integer</span>.

     <br><dt><code>--field-description </code><var>field</var><dd>Returns a human-readable description of the intended purpose of <var>field</var>.

     <br><dt><code>--field-flags </code><var>field</var><dd>Returns the flags set for the field in the <span class="file">dbconfig</span> file
associated with the database, such as <code>textsearch</code> and
<code>readonly</code>.  See <a href="#Individual-field-configuration">Individual field configuration</a>.

     <br><dt><code>--adm-field </code><var>field</var><dd>Used together with the <code>--adm-key</code> option, this returns a record
from the administrative file (if any) associated with the field.  For
more material on administrative files, see <a href="#administrative-files">Enumerated field administrative files</a>.

     <br><dt><code>--adm-subfield </code><var>subfield</var><dd>Used together with the <code>--adm-field</code> and <code>--adm-key</code> options,
this returns the contents of a particular subfield from the record
specified by <code>--adm-field</code> and <code>--adm-key</code>.  Subfields are
treated in <a href="#administrative-files">Enumerated field administrative files</a>.

     <br><dt><code>--adm-key </code><var>key</var><dd>Used together with <code>--adm-field</code> to select a record from the
administrative file associated with the field specified by
<code>--adm-field</code>.  See <a href="#administrative-files">Enumerated field administrative files</a>.

     <br><dt><code>--valid-values </code><var>field</var><dd>For fields of type <span class="samp">enum</span>, a list of valid values (one per line) is
returned.  Otherwise, a regular expression is returned that describes
the legal values in <var>field</var>.

     <br><dt><code>--responsible-address </code><var>name</var><dd>The mail address of <var>name</var> is returned; <var>name</var> is assumed to be
a name either appearing in the database's responsible list, or is
otherwise a user on the system.

     <br><dt><code>--print-sh-vars</code><dd>A set of <span class="file">/bin/sh</span> variables is returned that describe the selected
database.  They include:

          <dl>
<dt><code>GNATSDB</code><dd>The name of the currently-selected database.

          <br><dt><code>GNATSDB_VALID</code><dd>Set to 1 if the selected database is valid.

          <br><dt><code>GNATSDBDIR</code><dd>The directory  where  the  database  contents  are
stored.

          <br><dt><code>DEBUG_MODE</code><dd>Set to 1 if debug mode has been  enabled  for  the
database.

          <br><dt><code>DEFAULTCATEGORY</code><dd>The default category for PRs in the database.

          <br><dt><code>DEFAULTSTATE</code><dd>The default state for PRs in the database. 
</dl>

     <br><dt><code>--print-server-addr</code><dd>Prints the information about a remote server database in the format
suitable for the <code>GNATSDB</code> environment variable.  This option
works only in the network mode.

     <br><dt><code>--print-directory-for-database</code><dd>Returns the directory where the selected database is located.

     <br><dt><code>--format </code><var>format</var><code>, -f </code><var>format</var><dd>Used to specify the format of the output PRs, See <a href="#Formatting-query_002dpr-output">Formatting query-pr output</a> for a complete description.

     <br><dt><code>--full, -F</code><dd>When printing PRs, the entre PR is displayed.  This is exactly
equivalent to

     <pre class="smallexample">          query-pr --format full
     </pre>
     <br><dt><code>--summary, -q</code><dd>When printing PRs, a summary format is used.  This is exactly equivalent
to

     <pre class="smallexample">          query-pr --format <var>summary</var>
     </pre>
     <br><dt><code>--debug, -D</code><dd>Enables debugging output for network queries.

     <br><dt><code>--host </code><var>host</var><code>, -H </code><var>host</var><dd>Specifies the hostname of the gnatsd server to communicate with.  This
overrides the value in the <code>GNATSDB</code> environment variable.

     <br><dt><code>--port </code><var>port</var><dd>Specifies the port number of the gnatsd server to communicate with. 
This overrides the value in the <code>GNATSDB</code> environment variable.

     <br><dt><code>--user </code><var>user</var><code>, -v </code><var>user</var><dd>Specifies the username to login with when connecting to the gnatsd
server.  This overrides the value in the <code>GNATSDB</code> environment
variable.

     <br><dt><code>--passwd </code><var>passwd</var><code>, -w </code><var>passwd</var><dd>Specifies the password to login with when connecting to the gnatsd
server.  This overrides the value in the <code>GNATSDB</code> environment
variable.

     <br><dt><code>--and, -&amp;, --or, -|</code><dd>These options are used when connecting multiple query operators
together.  They specify whether the previous and subsequent options are
to be logically ANDed or logically ORed.

     <br><dt><code>--expr </code><var>expr</var><dd>Specifies a query expression to use when searching for PRs.  See <a href="#Query-expressions">Query expressions</a>. 
</dl>

   <p>The remaining deprecated options are not described here, since their use
is fairly obvious and their functionality is completely replaced by the
use of the <code>--expr</code> option.

<div class="node">
<p><hr>
<a name="Formatting-query_002dpr-output"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Query-expressions">Query expressions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-query_002dpr">Invoking query-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#query_002dpr">query-pr</a>
<br>
</div>

<h4 class="subsection">2.4.2 Formatting <code>query-pr</code> output</h4>

<p><a name="index-query_002dpr-output-format-148"></a>
Printing formats for PRs are in one of three forms:

     <dl>
<dt><var>formatname</var><dd>This is a named format which is described by the database (specifically,
these formats are described in the <span class="file">dbconfig</span> file associated with the
database).  The default configuration contains five such formats:
<span class="samp">standard</span>, <span class="samp">full</span>, <span class="samp">summary</span>, <span class="samp">sql</span>, and
<span class="samp">sql2</span>.

     <p>The first three are the ones most commonly used when performing queries. 
standard is the format used by default if no other format is specified.

     <p>Use of the latter two are discouraged; they are merely kept for
historical purposes.  Other named formats may have been added by the
database administrator.

     <br><dt><var>fieldname</var><dd>A single field name may appear here.  Only the contents of this field
will be displayed.

     <br><dt><var>'"printf string" fieldname fieldname ...'</var><dd>This provides a very flexible mechanism for formatting PR output.  (The
formatting is identical to that provided by the named formats described
by the database configuration, See <a href="#Named-query-definitions">Named query definitions</a>.  The
<var>printf string</var> can contain the following % sequences:

     <p><code>%[positionalspecifiers]s</code>: Prints the field as a string.  The
positional specifiers are similar to those of printf, as +, - and digit
qualifiers can be used to force a particular alignment of the field
contents.

     <p><code>%[positionalspecifiers]S</code>: Similar to <code>%s</code>, except that the
field contents are terminated at the first space character.

     <p><code>%[positionalspecifiers]d</code>: Similar to <code>%s</code>, except that the
field contents are written as a numeric value.  For integer fields, the
value is written as a number.  For enumerated fields, the field is
converted into a numeric equivalent (i.e. if the field can have two
possible values, the result will be either 1 or 2).  For date fields,
the value is written as seconds since Jan 1, 1970.

     <p><code>%F</code>: The field is written as it would appear within a PR, complete
with field header.

     <p><code>%D</code>: For date fields, the date is written in a standard <span class="sc">gnats</span>
format.

     <p><code>%Q</code>: For date fields, the date is written in an arbitrary "SQL"
format. 
</dl>

   <p>An example formatted query looks as follows (note that the whole format
specification should be quoted):

<pre class="smallexample">     query-pr --format '"%s, %s" Synopsis State'
</pre>
   <div class="node">
<p><hr>
<a name="Query-expressions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Example-queries">Example queries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Formatting-query_002dpr-output">Formatting query-pr output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#query_002dpr">query-pr</a>
<br>
</div>

<h4 class="subsection">2.4.3 Query expressions</h4>

<p><a name="index-query-expressions-149"></a>
Query expressions are used to select specific PRs based on their field
contents.  The general form is

<pre class="smallexample">     fieldname|"value" operator fieldname|"value" [booleanop ...]
</pre>
   <p><var>value</var> is a literal string or regular expression; it must be
surrounded by double quotes, otherwise it is interpreted as a fieldname.

   <p><var>fieldname</var> is the name of a field in the PR.

   <p><var>operator</var> is one of:

     <dl>
<dt><code>=</code><dd>The value of the left-hand side of the expression must exactly match the
regular expression on the right-hand side of the expression. 
See <a href="#Regexps">Querying using regular expressions</a>.

     <br><dt><code>~</code><dd>Some portion of the left-hand side of the expression must match the
regular expression on the right-hand side.

     <br><dt><code>==</code><dd>The value of the left-hand side must be equal to the value on the
right-hand side of the expression.

     <p>The equality of two values depends on what type of data is stored in the
field(s) being queried.  For example, when querying a field containing
integer values, literal strings are interpreted as integers.  The query
expression

     <pre class="smallexample">          Number == "0123"
     </pre>
     <p class="noindent">is identical to

     <pre class="smallexample">          Number == "123"
     </pre>
     <p class="noindent">as the leading zero is ignored.  If the values were treated as strings
instead of integers, then the two comparisons would return different
results.

     <br><dt><code>!=</code><dd>The not-equal operator. Produces the opposite result of the == operator.

     <br><dt><code>&lt;,&gt;</code><dd>The left-hand side must have a value less than or greater than the
right-hand side.  Comparisons are done depending on the type of data
being queried; in particular, integer fields and dates use a numeric
comparison, and enumerated fields are ordered depending on the numeric
equivalent of their enumerated values. 
</dl>

   <p><var>booleanop</var> is either <span class="samp">|</span> (logical or), or <span class="samp">&amp;</span> (logical
and).  The query expression

<pre class="smallexample">     Category="baz" | Responsible="blee"
</pre>
   <p class="noindent">selects all PRs with a Category field of <span class="samp">baz</span> or a Responsible
field of <span class="samp">blee</span>.

   <p>The not operator <span class="samp">!</span> may be used to negate a test:

<pre class="smallexample">     ! Category="foo"
</pre>
   <p class="noindent">searches for PRs where the category is not equal to the regular
expression foo.

   <p>Parentheses may be used to force a particular interpretation of the
expression:

<pre class="smallexample">     !(Category="foo" &amp; Submitter-Id="blaz")
</pre>
   <p class="noindent">skips PRs where the Category field is equal to <span class="samp">foo</span> and the
Submitter-Id field is equal to <span class="samp">blaz</span>.  Parentheses may be nested
to any arbitrary depth.

   <p>Fieldnames can be specified in several ways.  The simplest and most
obvious is just a name:

<pre class="smallexample">     Category="foo"
</pre>
   <p class="noindent">which checks the value of the category field for the value <var>foo</var>.

   <p>A fieldname qualifier may be prepended to the name of the field; a colon
is used to separate the qualifier from the name.  To refer directly to a
builtin field name:

<pre class="smallexample">     builtin:Number="123"
</pre>
   <p>In this case, <span class="samp">Number</span> is interpreted as the builtin name of the
field to
check.  (This is useful if the fields have been renamed.  For further
discussion of builtin field names, see <a href="#dbconfig-file">The <code>dbconfig</code> file</a>.

   <p>To scan all fields of a particular type, the <var>fieldtype</var> qualifier
may be
used:

<pre class="smallexample">     fieldtype:Text="bar"
</pre>
   <p class="noindent">This searches all text fields for the regular expression <span class="samp">bar</span>.

   <p>Note that it is not required that the right-hand side of the expression
be a literal string.  To query all PRs where the PR has been modified
since it was closed, the expression

<pre class="smallexample">     Last-Modified != Closed-Date
</pre>
   <p class="noindent">will work; for each PR, it compares the value of its Last-Modified field
against its Closed-Date field, and returns those PRs where the values
differ.  However, this query will also return all PRs with empty
Last-Modified or Closed-Date fields.  To further narrow the search:

<pre class="smallexample">     Last-Modified != Closed-Date &amp; Last-Modified != "" &amp; Closed-Date != ""
</pre>
   <p class="noindent">In general, comparing fields of two different types (an integer field
against a date field, for example) will probably not do what you want.

   <p>Also, a field specifier may be followed by the name of a subfield in
braces:

<pre class="smallexample">     State[type] != "closed"
</pre>
   <p class="noindent">or even

<pre class="smallexample">     builtin:State[type] != "closed"
</pre>
   <p class="noindent">Subfields are further discussed in <a href="#dbconfig-file">The <code>dbconfig</code> file</a>.

<!--  -->
<div class="node">
<p><hr>
<a name="Example-queries"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Query-expressions">Query expressions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#query_002dpr">query-pr</a>
<br>
</div>

<h4 class="subsection">2.4.4 Example queries</h4>

<p><a name="index-example-queries-150"></a>
The following simple query:

<pre class="smallexample">     query-pr --expr 'Category~"rats" &amp; State~"analyzed"
                      &amp; Responsible~"fred"'
</pre>
   <p class="noindent">yields all PRs in the database which contain the field values:

<pre class="smallexample">     &gt;Category:     rats         <em>and</em>
     &gt;Responsible:  fred         <em>and</em>
     &gt;State:        analyzed
</pre>
   <p>The following query:

<pre class="smallexample">     query-pr --expr 'State~"open|analyzed"'
</pre>
   <p class="noindent">yields all PRs in the database whose <code>State</code> values match either
<span class="samp">open</span> or <span class="samp">analyzed</span> (see <a href="#Regexps">Querying using regular expressions</a>.  This search is useful as a daily report that lists all
Problem Reports which require attention.

   <p>The following query:

<pre class="smallexample">     query-pr --expr 'fieldtype:Text="The quick.*brown fox"'
</pre>
   <p class="noindent">yields all PRs whose <span class="sc">Text</span> fields contain the text <span class="samp">The quick</span>
followed by <span class="samp">brown fox</span> within the same field. 
See <a href="#Regexps">Querying using regular expressions</a>, which also contains
further useful examples of query expressions.

<!-- *************************************************************************** -->
<div class="node">
<p><hr>
<a name="Emacs"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#query_002dpr">query-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GNATS-user-tools">GNATS user tools</a>
<br>
</div>

<h3 class="section">2.5 The Emacs interface to <span class="sc">gnats</span></h3>

<p><a name="index-Emacs-151"></a>
Emacs interface to <span class="sc">gnats</span> provides basic access to <span class="sc">gnats</span>
databases, i.e. sending, editing, and querying Problem Reports.  It
also defines a simple major mode for editing <span class="file">dbconfig</span> files.

   <p>This section provides an overview of using <span class="sc">gnats</span> with Emacs.  It
does not describe the use of Emacs itself, for detailed instructions
on using Emacs, see <a href="emacs.html#Top">Top (GNU Emacs)</a>.  For
installation instructions of the <span class="sc">gnats</span> Emacs mode, see
<a href="#Installing-utils">Installing utils</a>.

   <p>Please note the Emacs interface was completely rewritten between
<span class="sc">gnats</span>&nbsp;3<!-- /@w --> and <span class="sc">gnats</span>&nbsp;4<!-- /@w -->.  It now uses <code>gnatsd</code>,
<a href="#gnatsd">gnatsd</a>, exclusively for its operations and uses modern Emacs
features like faces.  Its features are not complete though, you can
send your suggestions and patches to the appropriate <span class="sc">gnats</span>
mailing list, <a href="#Support">Support</a>.

<ul class="menu">
<li><a accesskey="1" href="#Emacs-viewing">Emacs viewing</a>:                Viewing PRs by their number. 
<li><a accesskey="2" href="#Emacs-querying">Emacs querying</a>:               Querying the database. 
<li><a accesskey="3" href="#Emacs-submitting">Emacs submitting</a>:             Submitting new PRs. 
<li><a accesskey="4" href="#Emacs-editing">Emacs editing</a>:                Editing PRs. 
<li><a accesskey="5" href="#Emacs-editing-buffer">Emacs editing buffer</a>:         The editing buffer. 
<li><a accesskey="6" href="#Emacs-and-databases">Emacs and databases</a>:          Changing the working database. 
<li><a accesskey="7" href="#dbconfig-mode">dbconfig mode</a>:                Major mode for dbconfig files. 
<li><a accesskey="8" href="#Other-Emacs-commands">Other Emacs commands</a>:         Miscellaneous commands. 
<li><a accesskey="9" href="#Emacs-customization">Emacs customization</a>:          Customizing the Emacs interface. 
</ul>

<div class="node">
<p><hr>
<a name="Emacs-viewing"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs-querying">Emacs querying</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.1 Viewing Problem Reports</h4>

<p><a name="index-_0040code_007bview_002dpr_007d-152"></a>To view a particular Problem Report, use the command <kbd>M-x
view-pr</kbd>.  It asks for a Problem Report number and displays that
Problem Report.

   <p><a name="index-_0040code_007bgnats_002dview_002dedit_002dpr_007d-153"></a>The displayed buffer is put in the view mode, <a href="emacs.html#Misc-File-Ops">Misc File Ops (GNU Emacs)</a>.  If you decide to edit the displayed Problem
Report, use the command <kbd>e</kbd> (<code>gnats-view-edit-pr</code>).

     
<a name="index-_0040code_007bgnats_002dview_002dmode_002dhook_007d-154"></a>
<dl><dt><code>gnats-view-mode-hook</code><dd>Hook run when <code>gnats-view-mode</code> is entered. 
</dl>

<div class="node">
<p><hr>
<a name="Emacs-querying"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs-submitting">Emacs submitting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Emacs-viewing">Emacs viewing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.2 Querying Problem Reports</h4>

<p><a name="index-_0040code_007bquery_002dpr_007d-155"></a>Querying the database is performed by the <kbd>M-x query-pr</kbd> command. 
The command prompts for the query expression, <a href="#Query-expressions">Query expressions</a>,
and displays a buffer with the list of the matching Problem Reports.

   <p>The list of the Problem Reports is displayed in the <span class="samp">summary</span>
query format, <a href="#Formatting-query_002dpr-output">Formatting query-pr output</a>.  Currently, the
display format cannot be changed and it must output each Problem
Report's number in the first column.

   <p>The Problem Report list buffer is put in the view mode, <a href="emacs.html#Misc-File-Ops">Misc File Ops (GNU Emacs)</a>.  You can use most of the standard view mode
commands in it.  Additionally, the following special commands are
available:

     
<a name="index-_0040code_007bgnats_002dquery_002dview_002dpr_007d-156"></a>
<dl><dt><kbd>v</kbd><dt><kbd>RET</kbd><dt><kbd>mouse-2</kbd><dd>View the current Problem Report (<code>gnats-query-view-pr</code>),
<a href="#Emacs-viewing">Emacs viewing</a>.

     <p><a name="index-_0040code_007bgnats_002dquery_002dedit_002dpr_007d-157"></a><br><dt><kbd>e</kbd><dd>Edit the current Problem Report (<code>gnats-query-edit-pr</code>),
<a href="#Emacs-editing">Emacs editing</a>.

     <p><a name="index-_0040code_007bgnats_002dquery_002dreread_007d-158"></a><br><dt><kbd>g</kbd><dd>Update the Problem Report list (<code>gnats-query-reread</code>).  The last
performed query is executed again and the buffer is filled with the
new results.

     <p><a name="index-_0040code_007bquery_002dpr_007d-159"></a><br><dt><kbd>G</kbd><dd>Perform new query (<code>query-pr</code>).

     <p><a name="index-_0040code_007bsend_002dpr_007d-160"></a><br><dt><kbd>s</kbd><dd>Send new Problem Report (<code>send-pr</code>), <a href="#Emacs-submitting">Emacs submitting</a>.

     <p><a name="index-_0040code_007bgnats_002dchange_002ddatabase_007d-161"></a><br><dt><kbd>D</kbd><dd>Change the current database (<code>gnats-change-database</code>), <a href="#Emacs-and-databases">Emacs and databases</a>.

     <p><a name="index-_0040code_007bbury_002dbuffer_007d-162"></a><br><dt><kbd>q</kbd><dd>Bury buffer, the buffer is put at the end of the list of all buffers. 
This is useful for quick escape of the buffer, without killing it. 
</dl>

   <p><a name="index-_0040var_007bgnats_002dquery_002dreverse_002dlisting_007d-163"></a>If the value of the variable <var>gnats-query-reverse-listing</var> is
non-<code>nil</code>, the listing appears in the reversed order, i.e. with
the Problem Reports of the highest number first, in the buffer.

   <p>Similarly to other <span class="sc">gnats</span> Emacs modes, there is a hook available
for the Problem Report list.

     
<a name="index-_0040code_007bgnats_002dquery_002dmode_002dhook_007d-164"></a>
<dl><dt><code>gnats-query-mode-hook</code><dd>Hook run when <code>gnats-query-mode</code> is entered. 
</dl>

<div class="node">
<p><hr>
<a name="Emacs-submitting"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs-editing">Emacs editing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Emacs-querying">Emacs querying</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.3 Submitting new Problem Reports</h4>

<p><a name="index-_0040code_007bsend_002dpr_007d-165"></a>You can submit new Problem Reports with the command <kbd>M-x send-pr</kbd>. 
The command puts you to the problem editing buffer, <a href="#Emacs-editing">Emacs editing</a>.  The buffer is prefilled with the initial report fields and
their default values, if defined.  You can use the usual Problem
Report editing commands, <a href="#Emacs-editing">Emacs editing</a>.  When you have filled in
all the fields, you can send the Problem Report by presing <kbd>C-c
C-c</kbd>.

   <p>If you run <kbd>M-x send-pr</kbd> with a prefix argument, it runs the
<code>gnats-change-database</code> command before putting you to the editing
buffer, <a href="#Emacs-and-databases">Emacs and databases</a>.

   <p>You can set the following variables to get some fields pre-filled:

     
<a name="index-_0040var_007bgnats_002ddefault_002dorganization_007d-166"></a>
<dl><dt><var>gnats-default-organization</var><dd>Default value of the <span class="samp">Organization</span> field used in new Problem Reports.

     <p><a name="index-_0040var_007bgnats_002ddefault_002dsubmitter_007d-167"></a><br><dt><var>gnats-default-submitter</var><dd>Default value of the <span class="samp">Submitter-Id</span> field used in new Problem Reports. 
</dl>

<div class="node">
<p><hr>
<a name="Emacs-editing"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs-editing-buffer">Emacs editing buffer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Emacs-submitting">Emacs submitting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.4 Editing Problem Reports</h4>

<p><a name="index-_0040code_007bedit_002dpr_007d-168"></a>To edit a particular Problem Report, use the command <kbd>M-x
edit-pr</kbd>.  It asks for a Problem Report number and puts the given
Problem Report in the editing buffer.  See <a href="#Emacs-editing-buffer">Emacs editing buffer</a>,
for information how to edit the Problem Report in the buffer and how
to submit your changes.

   <p>Note you can also start editing of a selected Problem Report directly
from within the viewing buffer, <a href="#Emacs-viewing">Emacs viewing</a>, or the query
result buffer, <a href="#Emacs-querying">Emacs querying</a>.

<div class="node">
<p><hr>
<a name="Emacs-editing-buffer"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs-and-databases">Emacs and databases</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Emacs-editing">Emacs editing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.5 The Problem Report editing buffer</h4>

<p>When you invoke a Problem Report editing command, the Problem Report
is put into a special editing buffer.  The Problem Report is formatted
similarly to the <code>query-pr -F</code> output, <a href="#Formatting-query_002dpr-output">Formatting query-pr output</a>.  Field identifiers are formatted as

<pre class="example">     &gt;Field:
</pre>
   <p>with the text of the field following the identifier on the same line
for single-line fields or starting on the next line for multi-line
fields.

   <p>The Problem Report editing mode tries to prevent you from violating
the Problem Report format and the constraints put on the possible
field values.  Generally, you can use usual editing commands, some of
them have a slightly modified behavior though.  (If you encounter a
very strange behavior somewhere, please report it as a bug,
<a href="#Support">Support</a>.)

   <p><a name="index-_0040code_007bgnats_002dnext_002dfield_007d-169"></a><a name="index-_0040code_007bgnats_002dprevious_002dfield_007d-170"></a>You can move between fields easily by pressing the <kbd>TAB</kbd>
(<code>gnats-next-field</code>) or <kbd>M-TAB</kbd>
(<code>gnats-previous-field</code>) keys.

   <p>The field tags are read-only and you cannot edit them nor delete them. 
If you want to &ldquo;remove&rdquo; a field, just make its value empty.

   <p>Editing a field value depends on the type of the edited field,
<a href="#Field-datatypes">Field datatypes</a>.  For text fields, you can edit the value
directly, assuming you preserve the rule about single-line and
multi-line values mentioned above.

   <p>For enumerated fields, you cannot edit the value directly.  You can
choose it from the list of the allowed values, either from the menu
popped up by pressing the middle mouse button or from within
minibuffer by pressing any key on the field's value.  If the pressed
key matches any of the allowed field values, that value is put as the
default value after the minibuffer prompt.  You can also cycle through
the allowed field values directly in the editing buffer using the
<code>SPACE</code> key.  Enumerated field values are marked by a special
face to not confuse you; you must have enabled font lock mode to
benefit from this feature, <a href="emacs.html#Font-Lock">Font Lock (GNU Emacs)</a>.

   <p>Some field values can be read-only, you cannot edit them at all.

   <p><a name="index-_0040code_007bgnats_002dapply_002dor_002dsubmit_007d-171"></a>Once you have edited the Problem Report as needed, you can send it to
the server with the <kbd>C-c C-c</kbd> command
(<code>gnats-apply-or-submit</code>).  Successful submission is reported by
a message and the buffer modification flag in mode line is cleared. 
Then you can either kill the buffer or continue with further
modifications.

     
<a name="index-_0040code_007bgnats_002dedit_002dmode_002dhook_007d-172"></a>
<dl><dt><code>gnats-edit-mode-hook</code><dd>Hook run when <code>gnats-edit-mode</code> is entered. 
</dl>

<div class="node">
<p><hr>
<a name="Emacs-and-databases"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#dbconfig-mode">dbconfig mode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Emacs-editing-buffer">Emacs editing buffer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.6 Changing the database</h4>

<p><a name="index-_0040code_007bgnats_002dchange_002ddatabase_007d-173"></a>By default, the Emacs interface connects to the default database,
<a href="#databases-file">databases file</a>.  If you want to connect to another database, use
the command <kbd>M-x gnats-change-database</kbd>.  It will ask you for the
database name to use, server and port it can be accessed on, and your
login name.

   <p><a name="index-gnatsd_002c-Emacs-174"></a>If you want to use the <span class="command">gnatsd</span> command, <a href="#gnatsd">gnatsd</a>,
directly, without connecting to a remote server or the localhost
connection port, provide your local file system full path to
<span class="command">gnatsd</span> as the server name.  Port number does not matter in
this case.

   <p><a name="index-password_002c-Emacs-175"></a>If the database requires a password to allow you the access to it, you
are prompted for the password the first time you connect to the
database.  If you provide an invalid password, you cannot connect to
the database anymore and you have to run the <kbd>M-x
gnats-change-database</kbd> command again.

<div class="node">
<p><hr>
<a name="dbconfig-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-Emacs-commands">Other Emacs commands</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Emacs-and-databases">Emacs and databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.7 dbconfig mode</h4>

<p><a name="index-dbconfig-mode-176"></a><a name="index-_0040code_007bgnats_002ddbconfig_002dmode_007d-177"></a>The Emacs interface defines a simple major mode
<code>gnats-dbconfig-mode</code> for editing <span class="file">dbconfig</span> files,
<a href="#dbconfig-file">dbconfig file</a>.  It defines basic mode attributes like character
syntax and font lock keywords, it does not define any special commands
now.

     
<a name="index-_0040code_007bgnats_002ddbconfig_002dmode_002dhook_007d-178"></a>
<dl><dt><code>gnats-dbconfig-mode-hook</code><dd>Hook run when <code>gnats-dbconfig-mode</code> is entered. 
</dl>

<div class="node">
<p><hr>
<a name="Other-Emacs-commands"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Emacs-customization">Emacs customization</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dbconfig-mode">dbconfig mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.8 Other commands</h4>

     
<a name="index-_0040code_007bunlock_002dpr_007d-179"></a>
<dl><dt><kbd>M-x unlock-pr</kbd><dd>Ask for a Problem Report number and unlock that Problem Report.  This
function is useful if connection to a <span class="sc">gnats</span> server was
interrupted during an editing operation and further modifications of
the Problem Report are blocked by a stealth lock.

     <p><a name="index-_0040code_007bunlock_002ddatabase_007d-180"></a><br><dt><kbd>M-x unlock-database</kbd><dd>Unlock the whole <span class="sc">gnats</span> database.  This function is useful in
situations similar to when <code>unlock-pr</code> is used.

     <p><a name="index-_0040code_007bgnats_002dshow_002dconnection_007d-181"></a><br><dt><kbd>M-x gnats-show-connection</kbd><dd>Show the connection buffer associated with the current buffer.  You
can view the Emacs communication with <span class="sc">gnatsd</span> in it.  This is
useful when something strange happens during the communication with
the server, e.g. when sending a Problem Report with <kbd>C-c C-c</kbd> from
a Problem Report editing buffer. 
</dl>

<div class="node">
<p><hr>
<a name="Emacs-customization"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-Emacs-commands">Other Emacs commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Emacs">Emacs</a>
<br>
</div>

<h4 class="subsection">2.5.9 Customization</h4>

<p>All the user variables can be customized in the customization group
<code>gnats</code>, <a href="emacs.html#Easy-customization">Easy customization (GNU Emacs)</a>.

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Installation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Management">Management</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GNATS-user-tools">GNATS user tools</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">3 Installing <span class="sc">gnats</span></h2>

<!-- This file is included as a chapter in gnats.texi. -->
<p><a name="index-installing-GNATS-182"></a><a name="index-configuring--GNATS-183"></a><a name="index-setting-up-GNATS-184"></a><a name="index-building-GNATS-185"></a>
See also <a href="#Locations">Where the tools and utilities reside</a>.

   <p>There are several steps you need to follow to fully configure and
install <span class="sc">gnats</span> on your system.  You need <code>root</code> access in order
to create a new account for <code>gnats</code> and to install the <span class="sc">gnats</span>
utilities.  You may need <code>root</code> access on some systems in order to
set up mail aliases and to allow this new account access to
<code>cron</code> and <code>at</code>.

   <p>If you are updating an older version of <span class="sc">gnats</span> rather than installing
from scratch, see <a href="#Upgrading">Upgrading from older versions</a>.

   <p><span class="sc">gnats</span> installation relies on two other freely available software
packages, which should be installed before you go on to configure and
build <span class="sc">gnats</span>.  These are <span class="sc">gnu</span> <code>make</code> and <code>Texinfo</code>
(version 4.2 or higher).  Both are available from the <span class="sc">gnu</span> FTP site at
<a href="ftp://ftp.gnu.org">ftp://ftp.gnu.org</a>.

   <p>To build and install <span class="sc">gnats</span>, you must:

     <ul>
<li>Run <code>configure</code>, with correct options if the defaults are
unsuitable for your site.  See <a href="#Configure-and-make">Configuring and compiling the software</a>.  Default installation locations are in
<a href="#Locations">Where <span class="sc">gnats</span> lives</a>.

     <li>Compile the <span class="sc">gnats</span> programs on your system.  See <a href="#Configure-and-make">Configuring and compiling the software</a>.

     <li>Create an initial database by using the <code>mkdb</code> command. 
See <a href="#Setting-up-the-default-database">Setting up the default database</a>.

     <li>Set up periodic jobs, using cron, to handle Problem Reports arriving by
mail.  See <a href="#Setting-up-periodic-jobs">Setting up periodic jobs</a>.

     <li>Set up mail aliases for <span class="sc">gnats</span>.  See <a href="#Aliases">Setting up mail aliases</a>.

     <li>Install the <span class="sc">gnats</span> tools and utilities locally, and install the user
tools (<code>query-pr</code>, <code>edit-pr</code>, <code>send-pr</code>) on every machine
in your local network.  See <a href="#Installing-tools">Installing the user tools</a>.

     <li>Install the <span class="sc">gnats</span> daemon <span class="file">gnatsd</span>.  See <a href="#Installing-the-daemon">Installing the daemon</a>.

     <li>If there are people outside your organization who will be submitting
PRs or who are supposed to be able to query and/or edit PRs, you may
need to instruct them to obtain and build the <span class="sc">gnats</span> tools
<code>query-pr</code>, <code>edit-pr</code> and <code>send-pr</code> for their systems. 
However, for many sites, setting up a remote access interface to
<span class="sc">gnats</span>, such as Gnatsweb is a better solution since this requires
no configuration on the remote side. 
</ul>

<ul class="menu">
<li><a accesskey="1" href="#Configure-and-make">Configure and make</a>:                Configuring and compiling the software
<li><a accesskey="2" href="#Installing-utils">Installing utils</a>:                  Installing the utilities
<li><a accesskey="3" href="#Setting-up-the-default-database">Setting up the default database</a>:   Setting up the default database
<li><a accesskey="4" href="#Setting-up-periodic-jobs">Setting up periodic jobs</a>:          Setting up periodic jobs
<li><a accesskey="5" href="#Aliases">Aliases</a>:                           Setting up mail aliases
<li><a accesskey="6" href="#Installing-the-daemon">Installing the daemon</a>:             Installing the daemon
<li><a accesskey="7" href="#Installing-tools">Installing tools</a>:                  Installing the user tools
<li><a accesskey="8" href="#Upgrading">Upgrading</a>:                         Upgrading from older versions
</ul>

<div class="node">
<p><hr>
<a name="Configure-and-make"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installing-utils">Installing utils</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.1 Configuring and compiling the software</h3>

<p><a name="index-unpacking-the-distribution-186"></a><a name="index-configuring-and-compiling-the-software-187"></a><a name="index-compiling-the-software-188"></a><a name="index-_0040code_007bconfigure_007d-189"></a><a name="index-_0040code_007bmake_007d-190"></a>
     <ol type=1 start=1>
<li>First, unpack your distribution.  We provide source code in a <code>tar</code>
file which was compressed using <code>gzip</code>.  The code can be extracted
into a directory <var>unpackdir</var> using

     <pre class="smallexample">          cd <var>unpackdir</var>
          gunzip gnats-4.1.999.tar.gz
          tar xvf gnats-4.1.999.tar
     </pre>
     <p>The sources reside in a directory called <span class="file">gnats-4.1.999</span>
when unpacked.  We call this the <dfn>top level</dfn> of the source
directory, or <dfn>srcdir</dfn>.  The sources for the <span class="sc">gnats</span> tools are in
the subdirectory <span class="file">gnats-4.1.999/gnats/*</span>.  Lists of files
included in the distribution are in each directory in the file
<span class="file">MANIFEST</span>.

     <p><a name="index-lisp-file-installation-191"></a><a name="index-Emacs-lisp-file-installation-192"></a><li>As of <span class="sc">gnats</span> version 4, having Emacs installed on the <span class="sc">gnats</span>
server is no longer a requirement.  If you do not have Emacs installed,
disregard this step altogether.

     <p>You may wish to alter the installation directory for the Emacs lisp
files.  If your Emacs lisp library is not in
<var>prefix</var><span class="file">/share/emacs/site-lisp</span><!-- /@w -->, edit the file
<var>srcdir</var><code>/gnats/Makefile.in</code>.  Change the variable
<code>lispdir</code> from <var>prefix</var><span class="file">/emacs/site-lisp</span><!-- /@w --> to the
directory containing your Emacs lisp library.  For information on
<var>prefix</var>, see <a href="#prefix"><var>prefix</var></a>.

     <li><a name="index-creating-an-account-for-the-_0040sc_007bgnats_007d-user-193"></a>Create an account for the <code>gnats</code> user.  You can actually name this
user whatever you want to, as long as it is a valid username on your
system, but we strongly recommend that you call the user <code>gnats</code>. 
If you do decide to give it some other name, remember to use the option
<code>--enable-gnats-user</code> when running <code>configure</code> below.  Below, we
will anyway refer to this user by the name <code>gnats</code>.

     <p>This user must have an entry in the file <span class="file">/etc/passwd</span><!-- /@w -->.  As for
ordinary users, create a standard home directory for the <code>gnats</code>
user.  The default <code>PATH</code> for this user should contain
<var>exec-prefix</var><span class="file">/bin</span><!-- /@w --> and
<var>exec-prefix</var><span class="file">/libexec/gnats</span><!-- /@w -->.  The <var>exec-prefix</var> value
is configurable with the <code>--exec-prefix</code> configure option described
below, but for standard installations, these two directories correspond
to <span class="file">/usr/local/bin</span><!-- /@w --> and <span class="file">/usr/local/libexec/gnats</span><!-- /@w -->.

     <li>Run <code>configure</code>.  You can nearly always run <code>configure</code> with
the simple command

     <pre class="example">          ./configure
     </pre>
     <p class="noindent">and the &ldquo;Right Thing&rdquo; happens:

          <ul>
<li><span class="sc">gnats</span> is configured in the same directory you unpacked it in;

          <li>when built, <span class="sc">gnats</span> runs on the machine you're building it on;

          <li>when installed, files are installed under <span class="file">/usr/local</span>
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>).

          <li>all <span class="sc">gnats</span> utilities operate on the <dfn>default database</dfn>, assumed
to be named <em>default</em> and to be located in
<span class="file">/usr/local/com/default</span><!-- /@w -->, unless you invoke the utilities with
<code>-d</code> <var>databasename</var> or <code>--directory=</code><var>databasename</var>, or
set the <var>GNATSDB</var> environment variable to point to some other database. 
</ul>

     <p><a name="index-_0040code_007bconfigure_007d-194"></a>The most common options to <code>configure</code> are listed below:

     <pre class="smallexample">          configure [ --prefix=<var>prefix</var> ]
                    [ --exec-prefix=<var>exec-prefix</var> ]
                    [ --enable-gnats-service=<var>service-name</var><!-- /@w --> ]
                    [ --enable-gnats-user=<var>username</var><!-- /@w --> ]
                    [ --enable-gnatsd-user-access-file=<var>path</var><!-- /@w --> ]
                    [ --enable-gnatsd-host-access-file=<var>path</var><!-- /@w --> ]
                    [ --enable-gnats-dblist-file=<var>path</var><!-- /@w --> ]
                    [ --enable-gnats-default-db=<var>path</var><!-- /@w --> ]
                    [ --with-kerberos ] [ --with-krb4 ]
                    [ --verbose ]
     </pre>
          
<a name="index-_0040var_007bprefix_007d-195"></a>
<dl><dt><code>--prefix=</code><var>prefix</var><dd>All host-independent programs and files are to be installed under
<var>prefix</var>.  (Host-dependent programs and files are also installed in
<var>prefix</var> by default.)  The default for <var>prefix</var> is
<span class="file">/usr/local</span><!-- /@w -->.  See <a href="#Locations">Where <span class="sc">gnats</span> lives</a>.

          <p><a name="index-_0040var_007bexec_002dprefix_007d-196"></a><br><dt><code>--exec-prefix=</code><var>exec-prefix</var><dd>All host-dependent programs and files are to be installed under
<var>exec-prefix</var>.  The default for <var>exec-prefix</var> is <var>prefix</var>. 
See <a href="#Locations">Where <span class="sc">gnats</span> lives</a>.

          <p><a name="index-_002d_002denable_002dgnats_002dservice-197"></a><br><dt><code>--enable-gnats-service=</code><var>service-name</var><code><!-- /@w --></code><dd>Set <var>service-name</var> to be the <span class="sc">gnats</span> network service.  Default
name is <var>support</var>.

          <p><a name="index-_002d_002denable_002dgnats_002duser-198"></a><br><dt><code>--enable-gnats-user=</code><var>username</var><code><!-- /@w --></code><dd>Set <var>username</var> to be the user name for <span class="sc">gnats</span>.  Default username
is <var>gnats</var>.

          <p><a name="index-_002d_002denable_002dgnatsd_002duser_002daccess_002dfile-199"></a><br><dt><code>--enable-gnatsd-user-access-file=</code><var>path</var><code><!-- /@w --></code><dd>Set global (across all databases) gnatsd user access file to
<var>path</var>. Default is
<var>/usr/local/etc/gnats/gnatsd.user_access</var>.  Per-database
user access permissions are set in a <span class="file">gnatsd.user_access</span> file in
the <span class="file">gnats-adm</span> subdirectory of each database.

          <p><a name="index-_002d_002denable_002dgnatsd_002dhost_002daccess_002dfile-200"></a><br><dt><code>--enable-gnatsd-host-access-file=</code><var>path</var><code><!-- /@w --></code><dd>Set global (across all databases) gnatsd host access file to
<var>path</var>. Default is
<span class="file">/usr/local/etc/gnats/gnatsd_host.access</span>.  There is currently
no way to specify host access permissions on a per-database basis.

          <p><a name="index-_002d_002denable_002dgnats_002ddblist_002dfile-201"></a><br><dt><code>--enable-gnats-dblist-file=</code><var>path</var><code><!-- /@w --></code><dd>Specify the file containing the list of databases.

          <p>Default is <var>prefix</var><span class="file">/etc/gnats/databases</span><!-- /@w -->.

          <p><a name="index-_002d_002denable_002dgnats_002ddefault_002ddb-202"></a><br><dt><code>--enable-gnats-default-db=</code><var>path</var><code><!-- /@w --></code><dd>Specify the default database to use when <span class="sc">gnats</span> tools are invoked
without the <code>-d</code> or <code>--databasename</code> option, and when the
<var>GNATSDB</var> envrionment variable hasn't been set. Default is
<span class="file">/</span><var>prefix</var><span class="file">/com/gnatsdb</span>.

          <p><a name="index-_002d_002dwith_002dkerberos-203"></a><br><dt><code>--with-kerberos</code><dd>Include code for Kerberos authentication.

          <p><a name="index-_002d_002dwith_002dkrb4-204"></a><br><dt><code>--with-krb4</code><dd>Support Kerberos 4.

          <br><dt><code>--verbose</code><dd>Give verbose output while <code>configure</code> runs. 
</dl>

     <p><code>configure</code> supports several more options which allow you to
specify in great detail where files are installed. For a complete list
of options, run <code>./configure --help</code> in the source directory.

     <p><a name="index-building-in-a-different-directory-205"></a><a name="index-_0040var_007bobjdir_007d-206"></a>You can build <span class="sc">gnats</span> in a different directory (<var>objdir</var>) from the
source code by calling the <code>configure</code> program from the new
directory, as in

     <pre class="smallexample">          mkdir <var>objdir</var>
          cd <var>objdir</var>
          <var>srcdir</var>/configure ...
     </pre>
     <p>By default, <code>make</code> compiles the programs in the same directory
as the sources (<var>srcdir</var>).

     <li>Make sure you have <span class="sc">gnu</span> <code>make</code>, then run

     <pre class="smallexample">          make all info
     </pre>
     <p class="noindent">from the directory where <code>configure</code> created a <span class="file">Makefile</span>
(this is <var>objdir</var> if you used it, otherwise <var>srcdir</var>.)  These
targets indicate:

          <dl>
<dt><code>all</code><dd>Compile all programs

          <br><dt><code>info</code><dd>Create <span class="samp">info</span> files using <code>makeinfo</code>. 
</dl>
     </ol>

<div class="node">
<p><hr>
<a name="Installing-utils"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Setting-up-the-default-database">Setting up the default database</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configure-and-make">Configure and make</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.2 Installing the utilities</h3>

<p><a name="index-installing-the-utilities-207"></a>
The following steps are necessary for a complete installation.  You may
need <code>root</code> access for these.

     <ol type=1 start=1>
<li>Install the utilities by invoking

     <pre class="smallexample">          make install install-info
     </pre>
     <p>These targets indicate:

          <dl>
<dt><code>install</code><dd>Installs all programs into their configured locations
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>).

          <br><dt><code>install-info</code><dd>Installs <span class="samp">info</span> files into their configured locations
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>). 
</dl>

     <p>After you have installed <span class="sc">gnats</span>, you can remove the object files with

     <pre class="smallexample">          make clean
     </pre>
     <p><a name="index-_0040code_007bautoload_007d-commands-208"></a><a name="index-loading-_0040code_007b_002eel_007d-files-209"></a><a name="index-Emacs-functions-210"></a><li>If you do not have Emacs installed on your <span class="sc">gnats</span> server, this step
should be skipped.

     <p>Place the following lines in the file <span class="file">default.el</span> in your Emacs
lisp library, or instruct your local responsible parties to place the
lines in their <span class="file">.emacs</span>:

     <pre class="smallexample">          (autoload 'send-pr "gnats"
             "Command to create and send a problem report." t)
          (autoload 'edit-pr "gnats"
             "Command to edit a problem report." t)
          (autoload 'view-pr "gnats"
             "Command to view a problem report." t)
          (autoload 'query-pr "gnats"
             "Command to query information about problem reports." t)
          (autoload 'unlock-pr "gnats"
             "Unlock a problem report." t)
          (autoload 'gnats-dbconfig-mode "gnats"
            "Major mode for editing the `dbconfig' GNATS configuration file." t)
          (add-to-list 'auto-mode-alist '("\\&lt;dbconfig$" . gnats-dbconfig-mode))
     </pre>
     <p><a name="index-prepare-_0040file_007bsend_002dpr_002econf_007d-211"></a><li>If you want people who are logged into the <span class="sc">gnats</span> server itself to
be able to use the <code>send-pr</code> tool to submit problem reports, you
need to create a configuration file for <code>send-pr</code> on the server. 
See <a href="#send_002dpr_002econf-file">The send-pr.conf configuration file</a>.

        </ol>

<div class="node">
<p><hr>
<a name="Setting-up-the-default-database"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Setting-up-periodic-jobs">Setting up periodic jobs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-utils">Installing utils</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.3 Installing the default database</h3>

<p>For the following steps, log in as the user <code>gnats</code>.

   <p>We are now going to initialize the default <span class="sc">gnats</span> database.  Run the
following command:

<pre class="example">     mkdb default
</pre>
   <p>This creates a database named <code>default</code>, with all its data stored
below the directory <var>prefix</var><span class="file">/com/gnatsdb</span><!-- /@w -->, in a default
installation this corresponds to <span class="file">/usr/local/com/gnatsdb</span><!-- /@w -->.  If
you specified the <code>--enable-gnats-default-db</code> option when running
configure, the default database will be created under the directory you
specified instead.  <code>mkdb</code> creates the database directory itself,
together with three different subdirectories<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>:

     <ul>
<li>A directory for the mandatory <span class="sc">gnats</span> category <var>pending</var>.

     <li>A <span class="file">gnats-queue</span> directory for queueing new messages to
<span class="sc">gnats</span> before they are processed by <code>file-pr</code>.

     <li>The administrative directory <span class="file">gnats-adm</span>. This directory is
populated with default configuration files from the
<var>prefix</var><span class="file">/etc/gnats/defaults</span><!-- /@w --> directory. 
</ul>

   <p>The next configuration step is to edit the default files copied to the
database's <span class="file">gnats-adm</span> directory by <code>mkdb</code>.

   <p>The default <span class="file">dbconfig</span> file installed by <code>mkdb</code> provides a
good basis for many <span class="sc">gnats</span> databases. The default file causes
similar behaviour to the 3.x versions of <span class="sc">gnats</span>. However, even if
this might be precisely what you want, you should still go through the
file and check that the default settings suit your needs. 
See <a href="#dbconfig-file">The <span class="file">dbconfig</span> file</a>.

   <p>Then edit the files <span class="file">categories</span>, <span class="file">responsible</span>, and
<span class="file">submitters</span> in the <span class="file">gnats-adm</span><!-- /@w --> directory (see <a href="#Other-config-files">Other database-specific config files</a>) to reflect your
local needs.  For special configurations, you may also have to edit the
<span class="file">states</span> and <span class="file">classes</span> files.

   <p>If you used the <code>--enable-gnats-default-db</code> option in the pre-build
configure to change the location of the default database, you need to
edit the <span class="file">databases</span> config file, see <a href="#databases-file">The <span class="file">databases file</span></a>.  This file is by default located in the
<var>prefix</var><span class="file">/etc/gnats</span><!-- /@w --> directory, but may have been changed
by the option <code>--enable-gnats-dblist-file</code> option during configure.

   <p><a name="index-_0040code_007bcron_007d-212"></a><a name="index-_0040code_007bat_007d-213"></a><div class="node">
<p><hr>
<a name="Setting-up-periodic-jobs"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Aliases">Aliases</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Setting-up-the-default-database">Setting up the default database</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.4 Setting up periodic jobs</h3>

<p>Allow the new user <code>gnats</code> access to <code>cron</code> and <code>at</code>.  To
do this, add the name <code>gnats</code> to the files <span class="file">cron.allow</span><!-- /@w --> and
<span class="file">at.allow</span><!-- /@w -->, which normally reside in the directory
<span class="file">/var/spool/cron</span><!-- /@w -->.  If these files do not exist, make sure
<code>gnats</code> does not appear in either of the files <span class="file">cron.deny</span><!-- /@w -->
and <span class="file">at.deny</span><!-- /@w --> (in the same directory).  If you changed the name
of the <span class="sc">gnats</span> user during configure, remember to substitute as
appropriate in the previous steps.

   <p><a name="index-_0040code_007bcrontab_007d-214"></a>Create a <code>crontab</code> entry that periodically runs the program
<code>queue-pr</code> with the <span class="samp">--run</span> option
(see <a href="#queue_002dpr"><code>queue-pr</code></a>).  For example, to run
<span class="samp">queue-pr&nbsp;--run</span><!-- /@w --> every ten minutes, create a file called
<span class="file">.mycron</span> in the home directory of the user <code>gnats</code> which
contains the line:

<pre class="smallexample">     0,10,20,30,40,50 * * * * <var>exec-prefix</var>/libexec/gnats/queue-pr --run
</pre>
   <p class="noindent">(Specify the full path name for <code>queue-pr</code>.)  Then run

<pre class="smallexample">     crontab .mycron
</pre>
   <p class="noindent">See the <code>man</code> pages for <code>cron</code> and <code>crontab</code> for details
on using <code>cron</code>.

<div class="node">
<p><hr>
<a name="Aliases"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installing-the-daemon">Installing the daemon</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Setting-up-periodic-jobs">Setting up periodic jobs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.5 Setting up mail aliases</h3>

<p><a name="index-mail-aliases-215"></a><a name="index-aliases-216"></a>
The following mail aliases must be added on the machine where the
<span class="sc">gnats</span> server is installed.  The instructions below are for Sendmail
or Sendmail-like mail systems.  If these instructions don't fit your
system, particularly if you do not have an <span class="file">aliases</span> file, ask your
mail administrator for advice.

   <p>The following aliases should be placed in the file
<span class="file">/etc/aliases</span><!-- /@w -->. Yoy may need <code>root</code> access to add these
aliases:

     <ul>
<li><a name="index-_0040code_007bgnats_002dadmin_007d-alias-217"></a>Create an alias for the <span class="sc">gnats</span> administrator.  This address should
point to the address of the person in charge of administrating
<span class="sc">gnats</span>:

     <pre class="smallexample">          gnats-admin:  <var>address</var>
     </pre>
     <li><a name="index-bug-alias-218"></a><a name="index-incoming-alias-for-Problem-Reports-219"></a><a name="index-alias-for-incoming-Problem-Reports-220"></a><a name="index-_0040code_007bqueue_002dpr-_002dq_007d-221"></a>Create an alias to redirect incoming Problem Reports.  This alias should
redirect incoming mail via a <dfn>pipe</dfn> to the program <span class="samp">queue-pr&nbsp;-q</span><!-- /@w -->.  For example, if Problem Reports coming to your site are to arrive
at the address <span class="samp">bugs@your.company.com</span>, create an alias to the
effect of:

     <pre class="smallexample">          bugs:  "| <var>exec-prefix</var>/libexec/gnats/queue-pr -q"
     </pre>
     <p class="noindent">This places incoming Problem Reports in
the <var>gnats-queue</var><!-- /@w --> directory of your database.  Remember to
fill in the full path of the <code>queue-pr</code> command as appropriate for
your installation.

     <li>You may also wish to forward a copy of each incoming Problem Report to a
log.  This can be accomplished with something like:

     <pre class="smallexample">          bug-q: "| <var>exec-prefix</var>/libexec/gnats/queue-pr -q"
          bug-log:  /some/path/bugs.log
          bugs:      bug-q, bug-log
     </pre>
     <p class="noindent">This configuration archives incoming Problem Reports in the file
<span class="file">bug.log</span><!-- /@w -->, and also feeds them to the program <code>queue-pr</code>. 
(Remember, <span class="file">bug.log</span> needs to be world-writable, and should be
pruned regularly; see <a href="#Management"><span class="sc">gnats</span> Administration</a>.)  In
order for the log file to protect fully against data loss in case a disk
runs full, try to place it on a different disk volume than the
<span class="sc">gnats</span> database.

     <li>If you want your users to be able to query the database by mail, use the
following alias:

     <pre class="smallexample">          query-pr: "| <var>exec-prefix</var>/libexec/gnats/mail-query"
     </pre>
     <p class="noindent">The <code>mail-query</code> program uses <span class="samp">--restricted</span> to search on the
database, and by default only searches for PRs that aren't closed
(see <a href="#query_002dpr">Querying the database</a>).

   </ul>

<!--  -->
<div class="node">
<p><hr>
<a name="Installing-the-daemon"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installing-tools">Installing tools</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Aliases">Aliases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.6 Installing the daemon</h3>

<p><a name="index-daemon-222"></a><a name="index-using-_0040sc_007bgnats_007d-over-a-network-223"></a>
By default, the daemon and clients are set to use port 1529.  Add the line

<pre class="smallexample">     support		1529/tcp			# GNATS
</pre>
   <p class="noindent">to your <span class="file">/etc/services</span> file.  If you want a different service
name, configure <span class="sc">gnats</span> with

<pre class="smallexample">     --enable-gnats-service=<var>servicename</var>
</pre>
   <p>In your <span class="file">inetd.conf</span> file, add the line

<pre class="smallexample">     support	stream	tcp	nowait	gnats	/usr/local/libexec/gnats/gnatsd gnatsd
</pre>
   <p class="noindent">adjusting the path accordingly if you used configure options to make
changes to the defaults.  To make <span class="command">inetd</span> start spawning the
<span class="sc">gnats</span> daemon when connected on that port, send it a hangup signal
(<code>HUP</code>).

   <p>Some operating systems have replaced <code>inetd</code> with the more modern
<code>xinetd</code>. Instead of editing <span class="file">inetd.conf</span>, you should create
the file <span class="file">/etc/xinetd.d/support</span><!-- /@w -->, containing something like the
following:

<pre class="smallexample">     service support
     {
        disable = no
        socket_type = stream
        protocol = tcp
        wait = no
        user = gnats
        server = /usr/local/libexec/gnats/gnatsd
     }
</pre>
   <p>If you specified a different service name when running <code>configure</code>,
you need to give the file the same name as the service name, and you
need to adjust the <code>service</code> line above.  If the <code>--prefix</code> or
<code>--exec-prefix</code> options were passed to <code>configure</code>, adjust the
<code>server</code> line above, and if you used the <code>--enable-gnats-user</code>
option, adjust the <code>user</code> line.

   <p>Then restart <span class="command">xinetd</span> to make the new configuration current.

   <p>If you use an Internet superserver different from <span class="command">inetd</span> or
<span class="command">xinetd</span>, please refer to its documentation for information how
to configure it.

   <p>At this point, you will probably want to set the access permissions of
the different hosts that are going to be accessing your databases.  The
access permissions can currently only be set on a global scale (that is,
across all the databases on a <span class="sc">gnats</span> server).  The location and name
of the global host access configuration file can be set during the
pre-build configure as shown above, but by default the file is
<span class="file">/usr/local/etc/gnats/gnatsd_host.access</span><!-- /@w -->.  It lists the hosts
allowed to access your server, and what their default access levels are. 
Each line in the file denotes one server, or one part of a network
domain.  There are three fields on each line, but only two are currently
used.  To grant all hosts from the domain <var>site.com</var> edit access,
use this line:

   <p><var>site.com</var>:<var>edit</var>

<p class="noindent">If you run a <span class="sc">gnats</span> web interface or similar tool on the same
machine as the server is running on, you probably want to grant
<var>localhost</var> edit access:

   <p><var>localhost</var>:<var>edit</var>

   <p>If you are using Kerberos, the <span class="file">gnatsd_host.access</span> file shows the
sites that don't require Kerberos authentication.

   <p>The third field might in the future be used for things like controlling
what categories, submitter-id's PRs, etc., can be accessed from that
site.  Access attempts that are denied are logged to the syslog messages
file (<span class="file">/var/adm/messages</span> on many systems).

<!--  -->
<div class="node">
<p><hr>
<a name="Installing-tools"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Upgrading">Upgrading</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-the-daemon">Installing the daemon</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.7 Installing the user tools</h3>

<p><a name="index-networks-224"></a><a name="index-using-_0040sc_007bgnats_007d-over-a-network-225"></a><a name="index-configuring-_0040sc_007bgnats_007d-on-a-network-226"></a>
When you install the <span class="sc">gnats</span> utilities, the user tools
<code>send-pr</code>, <code>query-pr</code> and <code>edit-pr</code> are installed on the
server machine.  If your machine is part of a network, however, you may
wish to install the user tools on each machine in the network so that
responsible parties on those machines can submit new Problem Reports,
query the database, and edit existing PRs.  In the following discussion,
machines with the <span class="sc">gnats</span> user tools installed are referred to as
<dfn>client</dfn> machines.  In general, there are three distinct types of
client that a <span class="sc">gnats</span> server may have to cater for:

     <ul>
<li>Machines that are on the same local network as the
<span class="sc">gnats</span> server, i.e. machines that are under the same
administrative control.

     <li>Machines on the general, open Internet.

     <li>Machines behind firewalls etc. which deny direct access
over the network to the <span class="sc">gnats</span> server. 
</ul>

   <p>Each type of client requires a different approach when it comes to
providing access.

<h4 class="subsection">3.7.1 User tools on a local network</h4>

<p><a name="index-using-_0040sc_007bgnats_007d-over-a-local-network-227"></a><a name="index-configuring-_0040sc_007bgnats_007d-on-a-local-network-228"></a>
If all the machines involved reside on the same local network as the
<span class="sc">gnats</span> server, you can simply share out the directories on the
server that contain the user tools, by default <span class="file">/usr/local/bin</span> and
the directory which contains the <span class="file">send-pr.conf</span> configuration file
(see <a href="#send_002dpr_002econf-file">The send-pr.conf configuration file</a>), by
default <span class="file">/usr/local/etc/gnats</span>.  If you have a heterogeneous
environment, i.e. hosts running different operating systems, you need to
create several shared <span class="sc">gnats</span> installations, one for each platform. 
The <span class="file">send-pr.conf</span> file is platform-independent, though.

   <p>In order to submit a new PR, <code>send-pr</code> would then be invoked as
follows on the client machines:

<pre class="smallexample">     send-pr -d <var>hostname:port:database:username:password</var>
</pre>
   <p>Or by first setting the environment variable <code>GNATSDB</code> as follows
(the exact syntax will vary depending on what shell you use):

<pre class="smallexample">     export GNATSDB=<var>hostname:port:database:username:password</var>
</pre>
   <p>Then, <code>send-pr</code> can simply be invoked without any options.

   <p>The other tools, <code>query-pr</code> and <code>edit-pr</code>, work in similar
ways, honoring the <code>-d</code> option as well as the <code>GNATSDB</code>
environment variable.  See <a href="#GNATS-user-tools">GNATS user tools</a>.

<h4 class="subsection">3.7.2 User tools for remote users</h4>

<p><a name="index-using-_0040sc_007bgnats_007d-remotely-229"></a><a name="index-configuring-_0040sc_007bgnats_007d-for-remote-users-230"></a>
When client machines reside on the general Internet, both security and
practical considerations may make it impossible to provide a shared
installation of the <span class="sc">gnats</span> tools.  In this case, you may choose to
only provide access through a web interface such as Gnatsweb.  For
clients that need the <span class="sc">gnats</span> tools, the following needs to be
carried out on the remote machines:

     <ol type=1 start=1>
<li>Configure and build <span class="sc">gnats</span> on the client machine

     <li>Configure <code>send-pr</code> on the client machine
        </ol>

   <p>You should unpack the distribution and run <code>configure</code> on the
client machine in the same way as described in <a href="#Configure-and-make">Configuring and compiling the software</a>.  Note, however, that you
do not need to create a <code>gnats</code> user on the client and you should
not use the <code>make all info</code> command to build.  Instead, issue the
following commands from the top level directory of the source
distribution:

<pre class="smallexample">     cd gnats
     make install-tools
     cd ../send-pr
     make all install
</pre>
   <p>This builds and installs the <code>send-pr</code>, <code>query-pr</code> and
<code>edit-pr</code> tools on the client machine.  You should now configure
<code>send-pr</code> by editing the <span class="file">send-pr.conf</span> file
(see <a href="#send_002dpr_002econf-file">The send-pr.conf configuration file</a>.)

   <p>Users on the client machine can now either use the send-pr syntax or the
<code>GNATSDB</code>environment variable described in the previous section.

   <p>For sites that need to submit Problem Reports by having send-pr send
e-mail instead of speaking directly over the network to the <span class="sc">gnats</span>
server, you need to create a problem report template on the <span class="sc">gnats</span>
server and have that template copied to a suitable location on the
client machine (any filename and any location will do, as long as
<code>send-pr</code> on the client machine can read the file).  On the
<span class="sc">gnats</span> server, use the command

<pre class="smallexample">     send-pr -p &gt; <span class="file">filename</span>
</pre>
   <p>The file <span class="file">filename</span> now contains a PR template for your database. 
Copy this file to the client.  Then edit the <span class="file">send-pr.conf</span> file
that you created on the client, set the <code>TEMPLATE</code> variable to
point to the template file (see <a href="#send_002dpr_002econf-file">The send-pr.conf configuration file</a>) and make sure that the <code>MAILPROG</code> and
<code>MAILADDR</code> varables in <span class="file">send-pr.conf</span> are correctly set.  You
should now have a working remote tool installation.

   <p>For clients that have no direct network access to your <span class="sc">gnats</span>
server, such as those that are located behind strict firewalls, you
either need to set up a web interface such as Gnatsweb (provided that
the firewall lets web traffic through) or use the procedure above which
sets up <code>send-pr</code> to submit Problem Reports by e-mail.  In order to
query PRs, users on the remote machines will then have to use the the
e-mail functionality of <code>query-pr</code> (see <a href="#Invoking-query_002dpr">Invoking query-pr</a>. 
Editing PRs by e-mail is not possible, so clients in this group who need
edit access have to get access through a web interface if possible.

   <p>Note that when <code>send-pr</code> is set up to work over e-mail, the
<code>GNATSDB</code> environment variable and the <code>-d</code> command line
option have no effect since <code>send-pr</code> is tied to a specific
database by way of the value of <code>MAILADDR</code> in the
<span class="file">send-pr.conf</span> file.

<!--  -->
<div class="node">
<p><hr>
<a name="Upgrading"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-tools">Installing tools</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installation">Installation</a>
<br>
</div>

<h3 class="section">3.8 Upgrading from older versions</h3>

<p><a name="index-upgrading-from-older-versions-231"></a>
The following procedure covers an upgrade from all <span class="sc">gnats</span> 3 versions
newer than 3.108.  If your installation is an older 3.10x version, or
even the ancient 3.2 version, you need to review the
<span class="file">UPGRADING.old</span> file in the <span class="sc">gnats</span> distribution before carrying
out the steps detailed here.

<h4 class="subsection">3.8.1 Overview</h4>

<p><a name="index-upgrading_002c-overview-232"></a>
Although almost all of the <span class="sc">gnats</span> internals have been redesigned and
rewritten for <span class="sc">gnats</span> 4, little has changed in the format and
structure of the database data.  The only change that needs to be taken
into account when upgrading is the fact that the database index format
is binary in a default installation of <span class="sc">gnats</span> 4.  Thus, you will
need to regenerate your database index by using the <code>gen-index</code>
tool.  In addition, if your old <span class="sc">gnats</span> installation was so-called
&ldquo;release-based&rdquo;, you need to make some simple modifications to the
database setup file <span class="file">dbconfig</span>.  See below for details.

   <p>Apart from building and installing new binaries, the major changes which
impinge on the upgrade procedure are all on the configuration side.  The
main database configuration file, <span class="file">dbconfig</span>, is far more complex
and powerful than the old <span class="file">config</span> file, and while the installation
process creates a sensible set of default values which are similar to
<span class="sc">gnats</span> 3.11x's defaults, you still need to migrate any changes you
may have made to your own local configuration.

   <p>Another aspect which needs consideration are remote submitter sites. 
Such sites either need to be instructed to upgrade their locally
installed copies of the <span class="sc">gnats</span> user tools (<code>send-pr</code>,
<code>edit-pr</code> and <code>query-pr</code>), or they should be given access
through interfaces such as Gnatsweb.

   <p>Since the <span class="sc">gnats</span> network daemon has been completely reworked, with
an entirely new command set, all network-based interfaces, such as
Gnatsweb and TkGnats need to be upgraded to versions that support
<span class="sc">gnats</span> 4.  The <span class="file">contrib</span> directory of this distribution
contains some third-party interfaces, and the <span class="file">README</span> file
contains pointers to where you can obtain the newest versions of these
tools.

   <p>This document only deals with upgrading <span class="sc">gnats</span> itself.  Third-party
tools should have separate upgrading instructions in their
distributions.

<h4 class="subsection">3.8.2 Upgrading</h4>

<p><a name="index-upgrade_002c-procedure-233"></a>
     <ol type=1 start=1>
<li>Before you begin, make a backup of your entire <span class="sc">gnats</span> database
directory hierarchy, the <span class="sc">gnats</span> executables directory and the
<span class="sc">gnats</span> user tools (<code>send-pr</code>, <code>query-pr</code> etc.)  The
locations of these may vary, but in a default <span class="sc">gnats</span> 3 installation,
the database(s) reside under <span class="file">/usr/local/share/gnats</span><!-- /@w -->, the
executables are located in <span class="file">/usr/local/libexec/gnats</span><!-- /@w --> and the
user tools reside in <span class="file">/usr/local/bin</span><!-- /@w -->.

     <li>(optional) In order to avoid confusing your users, you may want to
remove the old <span class="sc">gnats</span> 3 executables and tools, escpecially if you
plan to install <span class="sc">gnats</span> 4 in a different location than version 3.

     <li>Build and install <span class="sc">gnats</span> 4.  See <a href="#Installation">Installing <span class="sc">gnats</span></a>.  It is recommended that you use the
<code>--enable-gnats-default-db</code><!-- /@w --> option when running <code>configure</code>,
in order to set the default database to be one of your already existing
<span class="sc">gnats</span> 3 databases.

     <li>Edit the <span class="sc">gnats</span> <span class="file">databases</span> file and add entries for all your
old <span class="sc">gnats</span> 3 databases.  In a default <span class="sc">gnats</span> 4 installation
the file is in <span class="file">/usr/local/etc/gnats</span><!-- /@w -->.  See <a href="#databases-file">The <span class="file">databases</span> file</a>.

     <li>In <span class="sc">gnats</span> 3, the file <span class="file">gnatsd.conf</span> specifies minimum access
levels for the different hosts accessing the <span class="sc">gnats</span> daemon,
<code>gnatsd</code>.  There is one <span class="file">gnatsd.conf</span> for each database.  In
<span class="sc">gnats</span> 4, these files have been replaced by a single file named
<span class="file">gnatsd.host_access</span> which contains settings that apply across all
the databases on the server.  This file is located in the same directory
as the <span class="file">databases</span> file.  You need to combine the host access
settings from all your <span class="sc">gnats</span> 3 databases and add them to the
<span class="file">gnatsd.host_access</span> file.  Note that you are no longer able to
control host access on a per-database basis.  Optionally, you may delete
the old <span class="file">gnatsd.conf</span> files.  See <a href="#Access-Control">Controlling access to <span class="sc">gnats</span> databases</a>.

     <li>Next, you need to migrate the settings in the old <span class="file">config</span> files of
your databases to corresponding <span class="file">dbconfig</span> files.  The database you
specified with the <code>--enable-gnats-default-db</code><!-- /@w --> configure option
got a default <span class="file">dbconfig</span> installed.  This default file contains
field definitions etc. which makes this version of <span class="sc">gnats</span> behave
almost exactly like older versions.  Copy this default file to the
<span class="file">gnats-adm</span><!-- /@w --> directories of any other <span class="sc">gnats</span> databases that
you may have on your host before you proceed to migrate your old
configuration settings.

     <p>The following is a list of the configuration directives that may be
present in a <span class="file">config</span> file and their counterparts (if any) in
<span class="sc">gnats</span> 4.

          <dl>
<dt><var>GNATS_ADDR</var><dd>This setting has no counterpart in <span class="sc">gnats</span> 4, since <span class="sc">gnats</span> no
longer needs to know its own mail address.

          <br><dt><var>GNATS_ADMIN</var><dd>This setting is now set in the <span class="file">responsible</span> file in the
<span class="file">gnats-adm</span><!-- /@w --> directory of your database(s).

          <br><dt><var>GNATS_SITE</var><dd><span class="sc">gnats</span> 4 has no concept of a named `site', so this directive is
obsolete.

          <br><dt><var>SUBMITTER</var><dd>Obsolete, since it relates to <var>GNATS_SITE</var>.

          <br><dt><var>DEFAULT_RELEASE</var><dt><var>DEFAULT_ORGANIZATION</var><dd>The <span class="sc">gnats</span> 4 <span class="file">dbconfig</span> file has separate configuration
sections for each defined field.  Field defaults are set with the
<code>default</code> keyword in these sections.  See <a href="#dbconfig-file">The <span class="file">dbconfig</span> file</a>.

          <br><dt><var>NOTIFY</var><dd>Controlled by the <code>notify-about-expired-prs</code> setting in the
<span class="file">dbconfig</span> file.

          <br><dt><var>ACKNOWLEDGE</var><dd>Controlled by the <code>send-submitter-ack</code> setting in the
<span class="file">dbconfig</span> file.

          <br><dt><var>DEFAULT_SUBMITTER</var><dd>The default submitter is now always the first entry in the
<span class="file">submitters</span> file of your database.

          <br><dt><var>KEEP_RECEIVED_HEADERS</var><dd>Controlled by the <code>keep-all-received-headers</code> setting in the
<span class="file">dbconfig</span> file.

          <br><dt><var>DEBUG_MODE</var><dd>Controlled by the <code>debug-mode</code> setting in the <span class="file">dbconfig</span> file.

          <br><dt><var>BDAY_START</var><dt><var>BDAY_END</var><dt><var>BWEEK_START</var><dt><var>BWEEK_END</var><dd>Controlled by the settings <code>business-day-hours</code> and
<code>business-week-days</code> in the <span class="file">dbconfig</span> file.

          <br><dt><var>DEFINE_CATEGORY</var><dd>The default category for PRs that arrive without one is now the first
category listed in the <span class="file">categories</span> file of your database. 
</dl>

     <p>After your are done migrating the settings, you may optionally delete
the old <span class="file">config</span> files.  Since there are many more configuration
settings available in the <span class="sc">gnats</span> 4 <span class="file">dbconfig</span> file, you should
take some time to review them all before proceeding.  See <a href="#dbconfig-file">The <span class="file">dbconfig</span> file</a>.

     <p>If your old <span class="sc">gnats</span> installations was release-based, i.e. it included
the fields Quarter, Keywords and Date-Required, you need to define those
fields in the <span class="file">dbconfig</span> file by following the instructions in
<a href="#release_002dbased-support">Supporting old <span class="sc">gnats</span> &ldquo;release-based&rdquo; fields</a>.

     <li>The file <span class="file">gnatsd.access</span> has been renamed to <span class="file">gnatsd.user_access</span>. 
Furthermore, <span class="sc">gnats</span> 4 uses a different password format in the
<span class="file">gnatsd.user_access</span> file than older versions, since it supports
<code>crypt()</code> and MD5 passwords (see <a href="#Access-Control">Controlling access to <span class="sc">gnats</span> databases</a>).  You need to translate your old
<span class="file">gnatsd.user_access</span><!-- /@w --> files to the new format by using the
<code>gnats-pwconv</code> tool which was installed in the
<var>EXEC-PREFIX</var><span class="file">/libexec/gnats</span><!-- /@w --> directory, typically
<span class="file">/usr/local/libexec/gnats</span><!-- /@w -->.  See <a href="#gnats_002dpwconv">Managing user passwords</a>.

     <li>The final step involves regenerating the indexes of your databases.  For
this, log in as the user <code>gnats</code>.  Then run the <code>gen-index</code>
command for each of your databases.  See <a href="#Admin-utils">Administrative Utilities</a> for details on how to use
<code>gen-index</code><!-- /@w -->.

     <li>Sit back and enjoy your new <span class="sc">gnats</span> 4 setup...
        </ol>

<!-- FIXME - anything else? -->
<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Management"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Locations">Locations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installation">Installation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">4 <span class="sc">gnats</span> Administration</h2>

<p><a name="index-administering-_0040sc_007bgnats_007d-234"></a><a name="index-managing-_0040sc_007bgnats_007d-235"></a><a name="index-GNATS-management-236"></a><a name="index-duties-for-_0040code_007bgnats_002dadmin_007d-237"></a>
In daily usage, <span class="sc">gnats</span> is self-maintaining.  However, there are
various administrative duties which need to be performed periodically. 
Also, requirements may change with time, so it may be necessary to
make changes to the <span class="sc">gnats</span> configuration at some point:

     <dl>
<dt><em>emptying the </em><code>pending</code><em> directory</em><dd><a name="index-emptying-the-_0040code_007bpending_007d-directory-238"></a>If a Problem Report arrives with a <code>Category</code> value that is
unrecognized by the <span class="file">categories</span> file, or if that field is missing,
<span class="sc">gnats</span> places the PR in the <span class="file">pending</span><!-- /@w --> directory
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>).  PRs
submitted in free-form by email will always be filed in the
<span class="file">pending</span><!-- /@w --> directory.  If so configured, <span class="sc">gnats</span> sends a
notice to the <code>gnats-admin</code> and to the party responsible for that
submitter (as listed in the <span class="file">submitters</span> file) when this occurs.

     <p>To have these "categoryless" PRs filed correctly, you can then use a
<span class="sc">gnats</span> tool such as <code>edit-pr</code> to set the correct category of
each PR in the <span class="file">pending</span> directory.

     <p>In order to protect yourself from problems caused by full disks, you
should arrange to have all mail that is sent to the <span class="sc">gnats</span> database
copied to a log file (<a href="#Aliases">Setting up mail aliases</a>).  Then,
should you run out of disk space, and an empty file ends up in the
database's <span class="file">pending</span> directory, you need only look in the log file,
which should still contain the full message that was submitted.

     <br><dt><em>adding another database</em><dd><a name="index-adding-another-database-239"></a><a name="index-_0040code_007bmkdb_007d-240"></a><span class="sc">gnats</span> supports multiple databases.  If you find at some point that
you need to add another database to your server, the <code>mkdb</code> tool
does most of the work for you.  See <a href="#mkdb">Adding another database</a>.

     <br><dt><em>adding new categories</em><dd><a name="index-adding-a-problem-category-241"></a><a name="index-_0040code_007bmkcat_007d-242"></a>Most installations of <span class="sc">gnats</span> will only require you to add a new line
to the <span class="file">categories</span><!-- /@w --> file.  The category directory will then be
created automatically as needed.  However, if automatic directory
creation has been switched off in the <span class="file">dbconfig</span> file
(see <a href="#dbconfig-file">The <code>dbconfig</code> file</a>), you need to use the
<span class="file">mkcat</span> program.

     <br><dt><em>removing categories</em><dd><a name="index-removing-a-problem-category-243"></a><a name="index-_0040code_007brmcat_007d-244"></a>To remove a category, you need to make sure the relevant subdirectory is
empty (in other words, make sure no PRs exist for the category you wish
to remove).  You can then remove the category listing from the
<span class="file">categories</span> file, and invoke

     <pre class="smallexample">          rmcat <var>category<small class="dots">...</small></var>
     </pre>
     <p class="noindent">to remove <var>category</var> (any number of categories may be specified on
the command line to <code>rmcat</code>, so long as they abide by the above
constraints).

     <br><dt><em>adding and removing maintainers</em><dd><a name="index-adding-and-removing-maintainers-245"></a>Edit the <span class="file">responsible</span> file to add a new maintainer or to remove an
existing maintainer.  See <a href="#responsible-file">The <code>responsible</code> file</a>.

     <br><dt><em>building a new index</em><dd><a name="index-building-a-new-index-246"></a><a name="index-_0040code_007bgen_002dindex_007d-247"></a>If your index becomes corrupted, or if you wish to generate a new one
for some reason, use the program <code>gen-index</code>
(see <a href="#gen_002dindex">Regenerating the index</a>).

     <br><dt><em>pruning log files</em><dd><a name="index-pruning-log-files-248"></a>Log files often grow to unfathomable proportions.  As with gardening, it
is best to prune these as they grow, lest they take over your disk and
leave you with no room to gather more Problem Reports.  If you keep log
files, be sure to keep an eye on them.  (See <a href="#Aliases">Setting up mail aliases</a>.) 
<!-- "gather ye rosebugs while ye may..." -->

     <br><dt><em>BACKING UP YOUR DATA</em><dd><a name="index-BACK-UP-YOUR-DATA-249"></a>Any database is only useful if its data remains uncorrupted and safe. 
Performing periodic backups ensures that problems like disk crashes and
data corruption are reversible.

   </dl>

   <p>See <a href="#Locations">Where <span class="sc">gnats</span> lives</a>.

<ul class="menu">
<li><a accesskey="1" href="#GNATS-configuration">GNATS configuration</a>:    Overview of GNATS configuration
<li><a accesskey="2" href="#databases-file">databases file</a>:         The databases file
<li><a accesskey="3" href="#dbconfig-file">dbconfig file</a>:          The dbconfig file
<li><a accesskey="4" href="#Other-config-files">Other config files</a>:     Configuration files
<li><a accesskey="5" href="#send_002dpr_002econf-file">send-pr.conf file</a>:      The send-pr.conf file
<li><a accesskey="6" href="#Admin-files">Admin files</a>:            Administrative data files
<li><a accesskey="7" href="#Admin-utils">Admin utils</a>:            Administrative utilities
<li><a accesskey="8" href="#Internal-utils">Internal utils</a>:         Internal utilities
</ul>

<div class="node">
<p><hr>
<a name="GNATS-configuration"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#databases-file">databases file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.1 Overview of <span class="sc">gnats</span> configuration</h3>

<p><a name="index-_0040sc_007bgnats_007d-configuration-250"></a><a name="index-Overview-of-_0040sc_007bgnats_007d-configuration-251"></a>
See <a href="#Locations">Where <span class="sc">gnats</span> lives</a>.

   <p><span class="sc">gnats</span> has two, well, actually three, different kinds of
configuration file.  The <dfn>site-wide</dfn> configuration files determine
overall behaviour across all the databases on your machine, while the
<dfn>database-specific</dfn> configuration files determine how <span class="sc">gnats</span>
behaves when dealing with a specific database.  In addition, there is
a single file that needs to be set up for the <code>send-pr</code> tool to
work properly.  These files can be edited at any time &mdash; the next
time a <span class="sc">gnats</span> tool is invoked, the new parameters will take
effect.

   <p>These are the site-wide configuration files used by <span class="sc">gnats</span>:

   <p><a name="index-Site-wide-configuration-files-252"></a>
     <dl>
<dt><code>databases</code><dd><a name="index-_0040file_007bdatabases_007d-253"></a>Specifies database names and their associated parameters, such as in
which directory they are located.  This file is used by the <span class="sc">gnats</span>
clients to determine the location of a database referred to by name. 
See <a href="#databases-file">The <code>databases</code> file</a>.

     <br><dt><code>defaults</code><dd><a name="index-_0040file_007bdefaults_007d-254"></a>This directory contains the set of default per-database configuration
files used when a new database is created with <code>mkdb</code>.

     <br><dt><code>gnatsd.host_access</code><dd><a name="index-_0040file_007bgnatsd_002ehost_005faccess_007d-255"></a>Controls access levels for the different machines that will do lookups
in the databases on this machine.  See <a href="#Access-Control"><span class="sc">gnats</span> access control</a>.

     <br><dt><code>gnatsd.user_access</code><dd><a name="index-_0040file_007bgnatsd_002euser_005faccess_007d-256"></a>Controls user access levels for the databases on this server. The
settings apply to all databases (there is also a database-specific
user access level file).  See <a href="#Access-Control"><span class="sc">gnats</span> access control</a>. 
</dl>

<p class="noindent">The database-specific configuration is determined by the
following files in the <span class="file">gnats-adm</span> subdirectory of the database
directory.

     
<a name="index-_0040code_007bdbconfig_007d-file-257"></a>
<dl><dt><code>dbconfig</code><dd>Controls most aspects of how <span class="sc">gnats</span> behaves when dealing with your
database.  See <a href="#dbconfig-file">The <code>dbconfig</code> file</a>.

     <p><a name="index-_0040code_007bcategories_007d-file-258"></a><br><dt><code>categories</code><dd>The list of categories that <span class="sc">gnats</span> accepts as valid for the
<code>Category</code> field, and the maintainers responsible for each
category.  Update this file whenever you have a new category, or
whenever a category is no longer valid.  You must also update this file
whenever responsibility for a category changes, or if a maintainer is
no longer valid.  See <a href="#categories-file">The <code>categories</code> file</a>.

     <p><a name="index-_0040code_007bresponsible_007d-file-259"></a><br><dt><code>responsible</code><dd>An alias list mapping names to their associated mailing addresses.  The
names in this list can have multiple email addresses associated with
them.  If a responsible user does not show up in this list, they are
assumed to be a user local to the system.  This list is not associated
with just the responsible user field; all email addresses are mapped
through this file whenever mail is sent from <span class="sc">gnats</span>. 
See <a href="#responsible-file">The <code>responsible</code> file</a>.

     <p><a name="index-_0040code_007bsubmitters_007d-file-260"></a><br><dt><code>submitters</code><dd>Lists sites from whom <span class="sc">gnats</span> accepts Problem Reports.  The existence
of this file is mandatory, although the feature it provides is not; see
<a href="#submitters-file">The <code>submitters</code> file</a>.

     <p><a name="index-_0040code_007baddresses_007d-file-261"></a><br><dt><code>addresses</code><dd>Mappings between submitter IDs and submitters' e-mail addresses.  Use of
this file is optional.  If you get Problem reports where the
<code>Submitter</code> field is not filled in, <span class="sc">gnats</span> will use entries in
this file to try to derive the submitter ID from the e-mail headers. 
See <a href="#addresses-file">The <code>addresses</code> file</a>.

     <p><a name="index-_0040code_007bstates_007d-file-262"></a><br><dt><code>states</code><dd>Lists the possible states for Problem Reports, typically ranging from
<dfn>open</dfn> to <dfn>closed</dfn>.  See <a href="#addresses-file">The <code>states</code> file</a>.

     <p><a name="index-_0040code_007bclasses_007d-file-263"></a><br><dt><code>classes</code><dd>Lists the possible classes of Problem Report.  This provides an easy way
to have &ldquo;subcategories&rdquo;, for example by setting up classes such as
<code>sw-bug</code>, <code>doc-bug</code>, <code>change-request</code> etc. 
See <a href="#classes-file">The <code>classes</code> file</a>.

     <p><a name="index-_0040code_007bgnatsd_002euser_005faccess_007d-file-264"></a><br><dt><code>gnatsd.user_access</code><dd>Specify the access levels for different users to your database. 
See <a href="#Access-Control"><span class="sc">gnats</span> access control</a>.

   </dl>

   <p>The last file in this menagerie is the <code>send-pr</code> configuration
file <span class="file">send-pr.conf</span>.  This file contains some defaults that need
to be known in order for <code>send-pr</code> to work.  The file needs to
be present on all hosts where <code>send-pr</code> is to be used. 
See <a href="#send_002dpr_002econf-file">the <span class="file">send-pr.conf</span> file</a>.

<div class="node">
<p><hr>
<a name="databases-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#dbconfig-file">dbconfig file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GNATS-configuration">GNATS configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.2 The <code>databases</code> file</h3>

<p><a name="index-_0040code_007bdatabases_007d-file-265"></a>
The <span class="file">databases</span> configuration file is a site-wide configuration
file containing the list of <span class="sc">gnats</span> databases that are available
either on the host itself or remotely over the network, together with
some parameters associated with each database.

   <p>The file contains one line for each database. For databases located on
the host itself, each line consists of three fields separated by colons:

   <p><var>database name:short description of database:path/to/database</var>

   <p>The first field is the database name.  This is the name used to identify
the database when invoking programs such as <code>query-pr</code> or
<code>send-pr</code>, either by using the <code>--database</code> option of the
program or by setting the <var>GNATSDB</var> environment variable to the name
of the database.  The second field is a short human-readable description
of the database contents, and the final field is the directory where the
database contents are kept.

   <p>For a database that is located across a network, but which should be
accessible from this host, the entry for the database should look
like this:

   <p><var>database name:short description of database::hostname:port</var>

   <p>The first two fields are the same as for local databases, the third
field is empty (notice the two adjacent <span class="samp">:</span> symbols, indicating an
empty field), the fourth field is the hostname of the remote <span class="sc">gnats</span>
server, and the fifth field is the port number that the remote
<span class="sc">gnats</span> is running on.

   <p>If <span class="sc">gnats</span> was built with default options, the <span class="file">databases</span> file
will be located in the <span class="file">/usr/local/etc/gnats</span><!-- /@w --> directory. 
However, if the option <code>--enable-gnats-dblist-file</code> was used during building
of <span class="sc">gnats</span>, the <span class="file">databases</span> file has the name and location given
to this option.  A sample <span class="file">databases</span> file is installed together
with <span class="sc">gnats</span>.

   <p>Note that if you add a new local database, you must create its data
directory, including appropriate subdirectories and administrative
files.  This is best done using the <code>mkdb</code> tool, See <a href="#mkdb">mkdb</a>.

<div class="node">
<p><hr>
<a name="dbconfig-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-config-files">Other config files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#databases-file">databases file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.3 The <code>dbconfig</code> file</h3>

<p><a name="index-_0040code_007bdbconfig_007d-file-266"></a>
The <span class="file">dbconfig</span> configuration file controls the configuration of a
<span class="sc">gnats</span> database.  Each database has its own individual copy of this
file, which is located in the <span class="file">gnats-adm</span> subdirectory of the
database.

   <p>The file consists of standard plain text.  Whitespace is completely
optional and is ignored. Sets of braces <span class="samp">@</span> are used to delimit the
different sections, and all non-keyword values must be surrounded with
double quotes.  The values in <span class="file">dbconfig</span> can be changed at any time;
the new values take effect for all subsequent iterations of <span class="sc">gnats</span>
tools.

   <p>The <span class="file">dbconfig</span> file contains 6 major sections, which must appear in the
following order:

     <ul>
<li>Overall database configuration
<li>Individual field configuration
<li>Named query definitions
<li>Audit-trail and outgoing email formats
<li>Index file description
<li>Initial Problem Report input fields
</ul>

   <p>The different sections are described below.  While reading the following
sections, it will be useful to refer to the sample <span class="file">dbconfig</span> file
which is installed when a new database is initialized with the
<code>mkdb</code> tool.  In fact, the sample file provides a configuration
that should be usable for a great range of sites, since it reproduces
the behaviour of the older, less customizable 3.x versions of
<span class="sc">gnats</span>.

<ul class="menu">
<li><a accesskey="1" href="#Overall-database-configuration">Overall database configuration</a>:  Overall database configuration. 
<li><a accesskey="2" href="#Individual-field-configuration">Individual field configuration</a>:  Individual field configuration. 
<li><a accesskey="3" href="#Field-datatypes">Field datatypes</a>:                 Field datatypes. 
<li><a accesskey="4" href="#Edit-controls">Edit controls</a>:                   Trigger on certain edit actions. 
<li><a accesskey="5" href="#Named-query-definitions">Named query definitions</a>:         Define and name standard queries. 
<li><a accesskey="6" href="#Audit_002dtrail-formats">Audit-trail formats</a>:             Specify formatting of the audit-trail. 
<li><a accesskey="7" href="#Outgoing-email-formats">Outgoing email formats</a>:          Specify contents and formatting of
                                   messages sent out by GNATS. 
<li><a accesskey="8" href="#Index-file-description">Index file description</a>:          Specify the general format and
                                   contents of the database index. 
<li><a accesskey="9" href="#Initial-PR-input-fields">Initial PR input fields</a>:         Which fields should be present on
                                   initial PR entry. 
</ul>

<div class="node">
<p><hr>
<a name="Overall-database-configuration"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Individual-field-configuration">Individual field configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.1 Overall database configuration</h4>

<p><a name="index-Overall-database-configuration-267"></a>
The overall database options are controlled by settings in the
<code>database-info</code> section of the <span class="file">dbconfig</span> file.  The following
is the general format of this section:

<pre class="example">     database-info {
       [options]
     }
</pre>
   <p>The following options and values may be used in the <code>database-info</code>
section:

     
<a name="index-_0040code_007bdebug_002dmode_007d-268"></a>
<dl><dt><code>debug-mode  </code><var>true | false</var><dd>If set to <code>true</code>, the database is placed into debug mode.  This causes all
outgoing email to be sent to the <dfn>gnats-admin</dfn> user listed in the
<span class="file">responsible</span> file of the database.  The default value is <code>false</code>.

     <p><a name="index-_0040code_007bkeep_002dall_002dreceived_002dheaders_007d-269"></a><br><dt><code>keep-all-received-headers  </code><var>true | false</var><dd>If set to <code>true</code>, all of the Received: headers for PRs submitted
via email are kept in the PR.  Otherwise, only the first one is kept.  The
default value is <code>false</code>.

     <p><a name="index-_0040code_007bnotify_002dabout_002dexpired_002dprs_007d-270"></a><br><dt><code>notify-about-expired-prs  </code><var>true | false</var><dd>If set to <code>true</code>, notification email about expired PRs is sent via
the <code>at-pr</code> command.  Otherwise, required times for PR fixes are not
used.  The default value is <code>false</code>.

     <p><a name="index-_0040code_007bsend_002dsubmitter_002dack_007d-271"></a><br><dt><code>send-submitter-ack  </code><var>true | false</var><dd>When new PRs are submitted to the database, an acknowledgment email will
be sent to the submitter of send-submitter-ack is set to <code>true</code>. 
This is in addition to the normal notification mail to the person(s)
responsible for the new PR.  The default value is <code>false</code>.

     <p><a name="index-_0040code_007blibexecdir_007d-272"></a><br><dt><code>libexecdir  </code><var>"directory"</var><dd>Specifies the directory where the <span class="sc">gnats</span> administrative executables
are located.  In particular, <code>at-pr</code> and <code>mail-pr</code> are invoked
from this directory.  The default value is the empty string, which is
unlikely to be useful.

     <p><a name="index-_0040code_007bbusiness_002dday_002dhours_007d-273"></a><br><dt><code>business-day-hours  </code><var>day-start - day-end</var><dd>Used to specify the hours that define a business day.  The values are
inclusive and should be given in 24-hour format, with a dash separating
them.  <span class="sc">gnats</span> uses these values to determine whether the required
completion time for a PR has passed.  The default values are 8 for
<code>day-start</code> and 17 for <code>day-end</code>.

     <p><a name="index-_0040code_007bbusiness_002dweek_002ddays_007d-274"></a><br><dt><code>business-week-days  </code><var>week-start - week-end</var><dd>Specifies the start and ending days of the business week, where 0 is
Sunday, 1 is Monday, etc.  The days are inclusive, and the values should
be given with a dash separating them.  <span class="sc">gnats</span> uses these values to
determine whether the required completion time for a PR has passed.  The
default values are 1 for <code>week-start</code> and 5 for <code>week-end</code>.

     <p><a name="index-_0040code_007bcreate_002dcategory_002ddirs_007d-275"></a><br><dt><code>create-category-dirs  </code><var>true | false</var><dd>If set to <code>true</code>, database directories for categories are
automatically created as needed.  Otherwise, they must be created
manually (usually with the <code>mkcat</code> script).  It is recommended that
the default value of <code>true</code> be kept.

     <p><a name="index-_0040code_007bcategory_002ddir_002dperms_007d-276"></a><br><dt><code>category-dir-perms  </code><var>mode</var><dd>Standard octal mode-specification specifying the permissions to be set
on auto-created category directories. Default is <code>0750</code>, yielding
user read, write and execute, and group read and execute.  Note that
if you have local users on the <span class="sc">gnats</span> server itself, running for
instance <code>query-pr</code>, you may need to change the permissions to
<code>0755</code>. 
</dl>

<div class="node">
<p><hr>
<a name="Individual-field-configuration"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Field-datatypes">Field datatypes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Overall-database-configuration">Overall database configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.2 Individual field configuration</h4>

<p><a name="index-Individual-field-configuration-277"></a>
Each type of field in a PR must be described with a <code>field</code> section
in the <span class="file">dbconfig</span> file.  These sections have the following general
structure:

<pre class="example">     field "fieldname" {
       description "string"
       [ field-options ... ]
       datatype [ datatype-options ... ]
       [ on-change { edit-options ... } ]
     }
</pre>
   <p><code>fieldname</code> is used as the field header in the PR.  The characters <code>&gt;</code>
and <code>:</code> are used internally as field markers by <span class="sc">gnats</span>, so they must
not be used in fieldnames.

   <p>The order in which the <code>field</code> sections appear in the
<span class="file">dbconfig</span> file determines the order in which they appear in the PR
text.  There is no required order, unlike previous versions of <span class="sc">gnats</span>
&mdash; the Unformatted field and multitext fields may appear anywhere in
the PR.

   <p>The following <code>field-options</code> may be present within a <code>field</code> section:

     
<a name="index-_0040code_007bbuiltin_002dname_007d-278"></a>
<dl><dt><code>builtin-name  </code><var>"name"</var><dd>Indicates that this field corresponds to one of the <span class="sc">gnats</span> built-in
fields.

     <p><span class="sc">gnats</span> has several fields which are required to be present in a PR,
and this option is used to map their external descriptions to their
internal usage.  The external field names are:

          <dl>
<dt><code>arrival-date</code><dd><a name="index-_0040code_007barrival_002ddate_007d-279"></a>The arrival date of the PR

          <br><dt><code>audit-trail</code><dd><a name="index-_0040code_007baudit_002dtrail_007d-280"></a>The audit-trail recording changes to the PR

          <br><dt><code>category</code><dd><a name="index-_0040code_007bcategory_007d-281"></a>The category that the PR falls into

          <br><dt><code>closed-date</code><dd><a name="index-_0040code_007bclosed_002ddate_007d-282"></a>The date that the PR was closed

          <br><dt><code>confidential</code><dd><a name="index-_0040code_007bconfidential_007d-283"></a>If set to <code>yes</code>, the PR is confidential

          <br><dt><code>description</code><dd><a name="index-_0040code_007bdescription_007d-284"></a>A description of the problem

          <br><dt><code>last-modified</code><dd><a name="index-_0040code_007blast_002dmodified_007d-285"></a>The date the PR was last modified

          <br><dt><code>number</code><dd><a name="index-_0040code_007bnumber_007d-286"></a>The PR's unique numeric identifier

          <br><dt><code>originator</code><dd><a name="index-_0040code_007boriginator_007d-287"></a>The originator of the PR

          <br><dt><code>priority</code><dd><a name="index-_0040code_007bpriority_007d-288"></a>Priority of the PR

          <br><dt><code>responsible</code><dd><a name="index-_0040code_007bresponsible_007d-289"></a>The person responsible for handling the PR

          <br><dt><code>severity</code><dd><a name="index-_0040code_007bseverity_007d-290"></a>Severity of the problem described by the PR

          <br><dt><code>state</code><dd><a name="index-_0040code_007bstate_007d-291"></a>The current state of the PR

          <br><dt><code>submitter-id</code><dd><a name="index-_0040code_007bsubmitter_002did_007d-292"></a>The user that submitted the PR

          <br><dt><code>synopsis</code><dd><a name="index-_0040code_007bsynopsis_007d-293"></a>The one-line description of the PR

          <br><dt><code>unformatted</code><dd><a name="index-_0040code_007bunformatted_007d-294"></a>PR text which cannot be parsed and associated with other fields. 
</dl>

     <p>For these built-in fields, a matching field description <em>must</em>
appear in the <span class="file">dbconfig</span> file. Otherwise, the configuration will
be considered invalid, and errors will be generated from the
<span class="sc">gnats</span> clients and <code>gnatsd</code>.  We also recommend that you
leave the actual fieldnames of these fields at their default values
(i.e. capitalized versions of their built-in names), since some
clients may depend on these names.

     <br><dt><code>description  </code><var>"description text"</var><dd>A one-line human-readable description of the field.  Clients can use
this string to describe the field in a help dialog.  The string is
returned from the FDSC command in gnatsd and is also available via the
<code>--field-description</code> option in <code>query-pr</code>.

     <p>This entry must be present in the field description, and there is no
default value.

     <br><dt><code>query-default  </code><var>exact-regexp | inexact-regexp</var><dd>Used to specify the default type of searches performed on this field. 
This is used when the <code>^</code> search operator appears in a query, and
is also used for queries in <code>query-pr</code> that use the old
<code>--field</code> query options.

     <p>If the option is not given, the default search is <code>exact-regexp</code>.

     <br><dt><code>textsearch</code><dd>If this option is present, the field will be searched when the user
performs a <code>--text</code> search from <code>query-pr</code>.  The field is
also flagged as a <code>textsearch</code> field in the set of field flags
returned by the <code>FIELDFLAGS</code> command in gnatsd.

     <p>By default, fields are not marked as <code>textsearch</code> fields.

     <br><dt><code>read-only</code><dd>When this option is present, the field contents may not be edited &mdash; they
must be set when the PR is initially created.  In general, this should
only be used for fields that are given as internal values rather than
fields supplied by the user.

     <p>By default, editing is allowed. 
</dl>

<div class="node">
<p><hr>
<a name="Field-datatypes"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Edit-controls">Edit controls</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Individual-field-configuration">Individual field configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.3 Field datatypes</h4>

<p><a name="index-Field-datatypes-295"></a>Each field description has to contain a datatype declaration which
describes what data are to be store in the field.  The general format for
such a declaration is

     
<a name="index-_0040code_007bdatatype_007d-296"></a>
<dl><dt><code>datatype  [ options ... ]</code><dd></dl>

   <p>The available datatypes are:

     
<a name="index-_0040code_007btext_007d-297"></a>
<dl><dt><code>text  [ matching { "regexp" [ "regexp" ... ] } ]</code><dd>The <code>text</code> datatype is the most commonly used type; it is a
one-line text string.

     <p>If the <code>matching</code> qualifier is present, the data in the field must
match at least one of the specified regexps.  This provides an easy and
flexible way to limit what text is allowed in a field.  If no
<code>matching</code> qualifier is present, no restriction is placed on
what values may appear in the field.

     <p><a name="index-_0040code_007bmultitext_007d-298"></a><br><dt><code>multitext  [ { default "string" } ]</code><dd>The field can contain multiple lines of text.

     <p>If the <code>default</code> option is present, the field will default to the
specified <code>string</code> if the field is not given a value when the PR is
initially created.  Otherwise, the field will be left empty.

     <p><a name="index-_0040code_007benum_007d-299"></a><br><dt><code>enum  {</code><dt><code>  values {</code><dt><code>    "string" [ "string" ... ]</code><dt><code>  }</code><dt><code>  [ default "string" ]</code><dt><code>}</code><dd>Defines an enumerated field, where the values in the PR field must match
an entry from a list of specified values.  The list of allowed values is
given with the <code>values</code> option. The <code>values</code> option is
required for an enumerated field.

     <p>If a <code>default</code> option is present, it is used to determine the
initial value of the field if no entry for the field appears in an
initial OR (or if the value in the initial PR is not one of the
acceptable values).  However, the value in the <code>default</code> statement
is not required to be one of the accepted values; this can be used to
allow the field to be initially empty, for example.

     <p>If no <code>default</code> option is specified, the default value for the
field is the first value in the <code>values</code> section.

     <p><a name="index-_0040code_007bmultienum_007d-300"></a><br><dt><code>multienum  {</code><dt><code>  values {</code><dt><code>    "string" [ "string" ... ]</code><dt><code>  }</code><dt><code>  [ separators "string" ]</code><dt><code>  [ default "string" ]</code><dt><code>}</code><dd>The <code>multienum</code> datatype is similar to the <code>enum</code> datatype,
except that the field can contain multiple values, separated by one or
more characters from the <code>separators</code> list.  If no <code>separators</code>
option is present, the default separators are space ( ) and colon
(<span class="samp">:</span>).

     <p>The values in the <code>default</code> string for this field type should be
separated by one of the defined separators.  An example clarifies this. 
If we have a field named <code>ingredients</code> where the default values
should be <span class="samp">sugar</span>, <span class="samp">flour</span> and <span class="samp">baking powder</span> and the
separator is a colon <span class="samp">:</span>, the following sets these defaults:

     <pre class="smallexample">          default "sugar:flour:baking powder"
     </pre>
     <p><a name="index-_0040code_007benumerated_002din_002dfile_007d-301"></a><br><dt><code>enumerated-in-file {</code><dt><code>  path "filename"</code><dt><code>  fields {</code><dt><code>    "name" [ "name" ... ]</code><dt><code>  } key "name"</code><dt><code>  [ allow-any-value ]</code><dt><code>}</code><dd><a name="administrative-files"></a>The <code>enumerated-in-file</code> type is used
to describe an enumerated field with an associated <dfn>administrative
file</dfn> which lists the legal values for the field, and may optionally
contain additional fields that can be examined by query clients or used
for other internal purposes.  It is similar to the <code>enum</code> datatype,
except that the list of legal values is stored in a separate file.  An
example of this kind of field is the built-in Category field with its
associeted <span class="file">categories</span> administrative file.

     <p><code>filename</code> is the name of a file in the <span class="file">gnats-adm</span>
administrative directory for the database.

     <p>The format of the administrative file should be simple ASCII. 
<dfn>Subfields</dfn> within the file are separated with colons (<span class="samp">:</span>). 
Lines beginning with a hash sign (<span class="samp">#</span>) are ignored as comments. 
Records within the file are separated with newlines.

     <p>The <code>field</code> option is used to name the subfields in the
administrative file.  There must be at least one subfield, which is used
to list the legal values for the field.  If the administrative file is
empty (or does not contain any non-empty non-comment lines), the PR
field must be empty.

     <p>The <code>key</code> option is used to designate which field in the
administrative file should be used to list the legal values for the PR
field.  The value must match one of the field names in the <code>field</code>
option.

     <p>If the <code>allow-any-value</code> option is present, the value of the PR
field is not required to appear in the administrative file &mdash; any value
will be accepted.

     <p>Note that there is no <code>default</code> keyword for
<code>enumerated-in-file</code>.  These fields get their default value from
the <em>first</em> entry in the associated administrative file.

     <p><a name="index-_0040code_007bmulti_002denumerated_002din_002dfile_007d-302"></a><br><dt><code>multi-enumerated-in-file {</code><dt><code>  path "filename"</code><dt><code>  fields {</code><dt><code>    "name" [ "name" ... ]</code><dt><code>  } key "name"</code><dt><code>  [ default "string" ]</code><dt><code>  [ allow-any-value ]</code><dt><code>  [ separators "string" ]</code><dt><code>}</code><dd>
<code>multi-enumerated-in-file</code> is to <code>multienum</code> what
<code>enumerated-in-file</code> is to <code>enum</code>.  Its options have the
same meaning as their counterparts in the <code>multienum</code> and
<code>enumerated-in-file</code> fields.

     <p><em>NOTE</em>: Keywords may appear in any sequence, with one exception &ndash;
the <code>separators</code> keyword, if present, has to come last.  This rule
only applies to fields of type <code>multi-enumerated-in-file</code>.

     <p><a name="index-_0040code_007bdate_007d-303"></a><br><dt><code>date</code><dd>The <code>date</code> datatype is used to hold dates.  Date fields must either be
empty or contain a correctly formatted date.

     <p>No defaults or other options are available.  The field is left empty if
no value for the field is given in the initial PR.

     <p><a name="index-_0040code_007binteger_007d-304"></a><br><dt><code>integer  [ { default "integer" } ]</code><dd>Integer fields are used to hold numbers.  They must either be empty or
contain a value composed entirely of digits, with an optional leading
sign.

     <p>If the <code>default</code> option is present, the field will have the value
of <code>integer</code> if the field is not given a value when the PR is
initially created.  Otherwise, the field will be left empty. 
</dl>

<div class="node">
<p><hr>
<a name="Edit-controls"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Named-query-definitions">Named query definitions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Field-datatypes">Field datatypes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.4 Edit controls</h4>

<p><a name="index-edit-controls-305"></a>
The <code>on-change</code> subsection of a <code>fields</code> section specifies one
or more actions to be performed when the field value is edited by the
user.  It has the general form

<pre class="example">     on-change [ "query-expression" ] {
       [ add-audit-trail ]
       [ audit-trail-format {
         format "formatstring"
         [ fields { "fieldname" ... } ]
       } ]
       [ require-change-reason ]
       [ set-field | append-to-field "fieldname" {
         "format-string" [ fieldlist ]
       } ]
       [ require { "fieldname" ... } ]
     }
</pre>
   <p>The optional <code>query-expression</code> controls whether or not the actions
in the <code>on-change</code> section are taken.  If the expression fails to
match, the actions are skipped.

   <p>The <code>add-audit-trail</code> option indicates that an entry should be
appended to the PR's audit-trail when this field is changed.  The format
of the entry is controlled by the optional <code>audit-trail-format</code>
section within the field, or by the global <code>audit-trail-format</code>
section. See <a href="#Audit_002dtrail-formats">Audit-trail formats</a> and <a href="#Outgoing-email-formats">Outgoing email formats</a>.

   <p>The <code>require-change-reason</code> option specifies that a change reason
must be present in the PR when this field is edited.  This option only
makes sense if an audit-trail entry is required, as the change reason is
otherwise unused.

   <p>The <code>set-field</code> and <code>append-to-field</code> options are used to
change the value of the field <code>fieldname</code> in the PR.  The supplied
format is used to format the value that will be placed in the field.

   <p><code>append-to-field</code> appends the resulting formatted string to the
existing, while <code>set-field</code> completely replaces the contents.

   <p>Any field may be edited by the <code>set-field</code> or
<code>append-to-field</code> option (the <code>read-only</code> option on a field is
ignored).  However, the changes are subject to the usual field content
checks.

   <p>The <code>require</code> option specifies that one or more fields must have
a (non-blank) value when this field is changed.

   <p>A field may be enforced to have a (non-blank) value at all times by
including it in the set of fields required for the initial PR, see
<a href="#Initial-PR-input-fields">Initial PR input fields</a>, as well as in the set of fields
required on change of the field itself.

   <p>There is also a global <code>on-change</code> section that is executed once
for each PR edit.  A typical use for such a section is to set the
last-modified date of the PR.

<div class="node">
<p><hr>
<a name="Named-query-definitions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Audit_002dtrail-formats">Audit-trail formats</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Edit-controls">Edit controls</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.5 Named query definitions</h4>

<p><a name="index-Named-query-definitions-306"></a>
When queries are performed via <code>query-pr</code>, they can refer to a
query format described by a <code>query</code> section in the <span class="file">dbconfig</span>
file:

<pre class="example">     query "queryname" {
       format "formatstring"
       [fields { "fieldname" [ "fieldname" ... ] } ]
     }
</pre>
   <p><code>formatstring</code> is as described in <a href="#Formatting-query_002dpr-output">Formatting query-pr output</a>. 
It basically contains a string with printf-like % escapes.  The output
of the query is formatted as specified by this format string.

   <p>The <code>fields</code> option lists the fields to be used with the format
string.  If the <code>fields</code> option is present without a <code>format</code>
option, the contents of the listed fields are printed out, separated by
newlines.

   <p>The named query formats <em>full</em>, <em>standard</em> amd <em>summary</em>
must be present in the <span class="file">dbconfig</span> file.  <em>full</em> and
<em>summary</em> correspond to the <code>query-pr</code> options <code>--full</code>
and <code>--summary</code>, while <em>standard</em> is used when no format
option is given to <code>query-pr</code>.

<div class="node">
<p><hr>
<a name="Audit_002dtrail-formats"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Outgoing-email-formats">Outgoing email formats</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Named-query-definitions">Named query definitions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.6 Audit-trail formats</h4>

<p><a name="index-Audit_002dtrail-format-307"></a>
These formats are similar to the named query formats, but they include
more options.  They are used for formatting audit-trail entries and for
outgoing email messages.

   <p>There is currently only one audit-trail format, defined by the
<code>audit-trail-format</code> option:

<pre class="example">     audit-trail-format {
       format "formatstring"
       [ fields { "fieldname" [ "fieldname" ... ] } ]
     }
</pre>
   <p>For those fields that require an audit-trail entry, the audit-trail text
to be appended is formatted as described by this format.  The per-field
<code>audit-trail-format</code> is used in preference to this one, if it
exists.

   <p><code>formatstring</code> and <code>fieldname</code> are similar to those used by
the named query format.  <code>fieldname</code> may also be a <dfn>format
parameter</dfn>, which is a context-specific value.  (Format parameters are
distinguished from fieldnames by a leading dollar sign (<span class="samp">$</span>)).

   <p>The following format parameters are defined for
<code>audit-trail-format</code> entries:

     
<a name="index-format-parameters-308"></a>
<dl><dt><code>$Fieldname</code><dd>The name of the field for which an audit-trail entry is being created.

     <br><dt><code>$OldValue</code><dd>The old value of the field.

     <br><dt><code>$NewValue</code><dd>The new field value.

     <br><dt><code>$EditUserEmailAddr</code><dd>The email address of the user editing the field.  Set by the
<code>EDITADDR</code> <code>gnatsd</code> command or from the <span class="file">responsible</span>
file; if not available, user's local address is used.

     <br><dt><code>$CurrentDate</code><dd>The current date.

     <br><dt><code>$ChangeReason</code><dd>The reason for the change; may be blank if no reason was supplied. 
</dl>

   <p>These parameters may be used anywhere a <code>fieldname</code> can appear.

<div class="node">
<p><hr>
<a name="Outgoing-email-formats"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Index-file-description">Index file description</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Audit_002dtrail-formats">Audit-trail formats</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.7 Outgoing email formats</h4>

<p><a name="index-Outgoing-email-formats-309"></a>
During the life of a PR, <span class="sc">gnats</span> can be configured to send out a
range of email messages.  When a PR first arrives, an acknowledgment
message is sent out if the <code>send-submitter-ack</code> parameter above is
set to <code>true</code>.  Certain edits to the PR may also cause email to be
sent out to the various parties, and if a PR is deleted, <span class="sc">gnats</span> may
send notification email.

   <p>The formats of the email messages are controlled by <code>mail-format</code>
sections in the <span class="file">dbconfig</span> file.  The general structure of a
<code>mail-format</code> section is as follows:
<!-- XXX The use of | and []'s below needs to be cleaned up -->

<pre class="example">     mail-format "format-name" {
       from-address {
         [ fixed-address "address" ]
         [ email-header-name | [ mail-header-name | ... ] ]
       }
       to-address {
         [ fixed-address "address" ]
         [ "email-header-name" | [ "mail-header-name" | ... ] ]
       }
       reply-to {
         [ fixed-address "address" ]
         [ "email-header-name" | ... ] | [ "gnats-field-name" | ... ]
       }
       header {
         format "formatstring"
         [ fields { "fieldname" [ "fieldname" ... ] } ]
       }
       body {
         format "formatstring"
         [ fields { "fieldname" [ "fieldname" ... ] } ]
       }
     }
</pre>
   <p><code>gnats</code> recognizes and uses 6 different <code>format-name</code> values:

     
<a name="index-_0040code_007bformat_002dname_007d-310"></a>
<dl><dt><code>initial-response-to-submitter</code><dd><a name="index-_0040code_007binitial_002dresponse_002dto_002dsubmitter_007d-311"></a>Format of the message used when mailing an initial response back to the
PR submitter.  This message will only be sent if
<code>send-submitter-ack</code> in the overall database configuration is set
to <code>true</code>.

     <br><dt><code>initial-pr-notification</code><dd><a name="index-_0040code_007binitial_002dpr_002dnotification_007d-312"></a>Format of the message sent to the responsible parties when a new PR with
category different from &ldquo;pending&rdquo; arrives.

     <br><dt><code>initial-pr-notification-pending</code><dd><a name="index-_0040code_007binitial_002dpr_002dnotification_002dpending_007d-313"></a>Format of the message sent to the responsible parties when a new PR that
ends up with category &ldquo;pending&rdquo; arrives.

     <br><dt><code>appended-email-response</code><dd><a name="index-_0040code_007bappended_002demail_002dresponse_007d-314"></a>Format of the notification message sent out when a response to a PR is
received via email.

     <br><dt><code>audit-mail</code><dd><a name="index-_0040code_007baudit_002dmail_007d-315"></a>Format of the message sent out when a PR edit generates an Audit-Trail
entry.

     <br><dt><code>deleted-pr-mail</code><dd><a name="index-_0040code_007bdeleted_002dpr_002dmail_007d-316"></a>Format of the message sent out when a PR is deleted. 
</dl>

   <p>The <code>from-address</code>, <code>to-address</code> and <code>reply-to</code>
subsections of a mail-format section specify the contents of the <code>To:</code>,
<code>From:</code> and <code>Reply-To:</code> headers in outgoing email.  There are
two ways to specify the contents: by using a <code>fixed-address</code>
specification, or by specifying <code>email-header-name</code>s or
<code>gnats-field-name</code>s.

   <p>When an <code>email-header-name</code> or <code>gnats-field-name</code> value is
given, <span class="sc">gnats</span> will attempt to extract an email address from the
specified location.  If several values are given on the same line,
separated by <span class="samp">|</span> characters, <span class="sc">gnats</span> will try to extract an address
from each location in turn until it finds a header or field which is
nonempty.  The following example should clarify this:

<pre class="example">     mail-format "initial-response-to-submitter" {
       from-address {
         fixed-address "gnats-admin"
       }
       to-addresses {
         "Reply-To:" | "From:" | "Submitter-Id"
       } ...
</pre>
   <p>This partial <code>mail-format</code> section specifies the format of the
address headers in the email message that is sent out as an
acknowledgment of a received PR.  The <code>From:</code> field of the message
will contain the email address of the <span class="sc">gnats</span> administrator, as
specified by the <code>gnats-admin</code> line in the <span class="file">responsible</span> file. 
To fill in the <code>To:</code> header, <span class="sc">gnats</span> will first look for the
mail header <code>Reply-To:</code> in the PR and use the contents of that, if
any.  If that header doesn't exist or is empty, it will look for the
contents of the <code>From:</code> email header, and if that yields nothing,
it will look for the <span class="sc">gnats</span> <code>Submitter-Id</code> field and use the
contents of that.

   <p>Other email headers to be included in messages sent out by <span class="sc">gnats</span>
can be specified by <code>header</code> subsections of the <code>mail-header</code>
section.  <code>formatstring</code> and <code>fieldname</code> are similar to those
used by the named query format. Each header line must have a newline
character (<span class="samp">\n</span>) at the end.

   <p>The email message body is specified in the <code>body</code> subsection of the
<code>mail-format</code> section. Just as for a <code>header</code> section, the
<code>body</code> section must contain a <code>formatstring</code> and
<code>fieldname</code> values.

   <p>For some of the formats that <span class="sc">gnats</span> recognizes, special variables
are available for use. The following table lists the formats that
provide special variables. See the example below for an illustration of
how they are used.

     <dl>
<dt><code>appended-email-response</code><dd>
          <dl>
<dt><code>$MailFrom</code><dd>The From: line of the original message.

          <br><dt><code>$MailTo</code><dd>The To: line of the original message.

          <br><dt><code>$MailSubject</code><dd>The Subject: line of the original message.

          <br><dt><code>$MailCC</code><dd>The CC: line of the original message.

          <br><dt><code>$NewAuditTrail</code><dd>The text of the new audit trail entry (corresponds to the body of the
message). 
</dl>

     <br><dt><code>audit-mail</code><dd>
          <dl>
<dt><code>$EditUserEmailAddr</code><dd>The email address of the user editing the PR.  Set by the
<code>EDITADDR</code> <code>gnatsd</code> command or from the <span class="file">responsible</span>
file; if not available, user's local address is used.

          <br><dt><code>$OldResponsible</code><dd>The previous Responsible field entry, if it was changed.

          <br><dt><code>$NewAuditTrail</code><dd>The Audit-Trail: entries that have been appended by the edits. 
</dl>

     <br><dt><code>deleted-pr-mail</code><dd>
          <dl>
<dt><code>$EditUserEmailAddr</code><dd>The email address of the user deleting the PR.  Set by the
<code>EDITADDR</code> <code>gnatsd</code> command or from the <span class="file">responsible</span>
file; if not available, user's local address is used.

          <br><dt><code>$PRNum</code><dd>The number of the PR that was deleted. 
</dl>
     </dl>

   <p>The following example illustrates the use of these special variables:

<pre class="example">     mail-format "deleted-pr-mail" {
       from-address {
         "$EditUserEmailAddr"
       }
       to-addresses {
         fixed-address "gnats-admin"
       }
       header {
         format "Subject: Deleted PR %s\n"
         fields { "$PRNum" }
       }
       body {
         format "PR %s was deleted by user %s.\n"
         fields { "$PRNum" "$EditUserEmailAddr" }
       }
     }
</pre>
   <p>This <code>mail-format</code> section specifies the format of the email
message that is sent out when a PR is deleted. The <code>From:</code> field is
set to the email address field of the user who deleted the PR, the
subject of the message contains the number of the deleted PR, and the
message body contains both the PR number and the user's email address.

<div class="node">
<p><hr>
<a name="Index-file-description"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Initial-PR-input-fields">Initial PR input fields</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Outgoing-email-formats">Outgoing email formats</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.8 Index file description</h4>

<p><a name="index-Index-file-description-317"></a>
The <code>index</code> section of the <span class="file">dbconfig</span> file lists the fields
that appear in the database index.  The index is always keyed by PR
number.  The general format for the <code>index</code> section is

<pre class="example">     index {
       path "file"
       fields { "fieldname" [ "fieldname" ... ] }
       binary-index true | false
       [ separator "symbol" ]
     }
</pre>
   <p>The <code>path</code> parameter gives the name of the index file in the
<span class="file">gnats-adm</span> directory of the database.  Only one index is allowed
per database, so only one <code>path</code> entry is allowed.

   <p>The <code>fields</code> parameter controls what fields will appear, and in
what order, in the index.  Fields are listed by their names, separated by
spaces ( ).  Fields will appear in the order they are listed.

   <p>The <code>binary-index</code> parameter controls whether the index is supposed
to be in plaintext or binary format.  Binary format is recommended, as it
avoids potential problems when field separators appear as bona-fide
field contents.

   <p>When plaintext format is used, by setting <code>binary-index false</code>, the
symbol (<span class="samp">|</span>) is used as a field separator in the index, unless
the optional <code>separator</code> parameter is used to redefine the
separator character.

<div class="node">
<p><hr>
<a name="Initial-PR-input-fields"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Index-file-description">Index file description</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dbconfig-file">dbconfig file</a>
<br>
</div>

<h4 class="subsection">4.3.9 Initial PR input fields</h4>

<p><a name="index-Initial-PR-input-fields-318"></a>
An <code>initial-entry</code> section in the <span class="file">dbconfig</span> file is used to
describe which fields should be present on initial PR entry; this is
used by tools such as send-pr to determine which fields to include in a
&ldquo;blank&rdquo; PR template. An optional <code>require</code> parameter can be
defined to specify a subset of the <code>intial-entry</code> fields which must
be assigned a value upon initial creation of the PR.

   <p>The general format for the <code>initial-entry</code> section is

<pre class="example">     initial-entry {
       fields { "fieldname" [ "fieldname" ... ] }
       [ require { "fieldname" [ "fieldname" ... ] } ]
     }
</pre>
   <div class="node">
<p><hr>
<a name="Other-config-files"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#send_002dpr_002econf-file">send-pr.conf file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dbconfig-file">dbconfig file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.4 Other database-specific config files</h3>

<ul class="menu">
<li><a accesskey="1" href="#categories-file">categories file</a>
<li><a accesskey="2" href="#responsible-file">responsible file</a>
<li><a accesskey="3" href="#submitters-file">submitters file</a>
<li><a accesskey="4" href="#states-file">states file</a>
<li><a accesskey="5" href="#addresses-file">addresses file</a>
<li><a accesskey="6" href="#classes-file">classes file</a>
</ul>

<div class="node">
<p><hr>
<a name="categories-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#responsible-file">responsible file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-config-files">Other config files</a>
<br>
</div>

<h4 class="subsection">4.4.1 The <code>categories</code> file</h4>

<p><a name="index-_0040code_007bcategories_007d-file-319"></a>
The <span class="file">categories</span> file contains a list of problem categories,
specific to the database, which <span class="sc">gnats</span> tracks.  This file also
matches responsible people with these categories.  You must edit this
file initially, creating valid categories.  In most installations,
<span class="sc">gnats</span> is configured to create directories on disk for valid
categories automatically as needed (see <a href="#Overall-database-configuration">Overall database configuration</a>). If <span class="sc">gnats</span> isn't set
up to do this, you need to run <code>mkcat</code> to create the corresponding
subdirectories of the database directory. For instructions on running
<code>mkcat</code>, see <a href="#mkcat">Adding a problem category</a>.

   <p>To create a new category, log in as <span class="sc">gnats</span>, add a line to this file,
and run <code>mkcat</code> if applicable.  Lines beginning with <span class="samp">#</span> are
ignored.

   <p>A line in the <span class="file">categories</span> file consists of four fields delimited
by colons, as follows:

<pre class="smallexample">     <var>category</var>:<var>description</var>:<var>responsible</var>:<var>notify</var>
</pre>
   <p class="noindent">
     <dl>
<dt><var>category</var><dd>A unique category name, made up of text characters.  This name cannot
contain spaces or any of the following characters:

     <pre class="smallexample">          ! $ &amp; * ( ) { } [ ] ` ' " ; : &lt; &gt; ~
     </pre>
     <p class="noindent">Ideally, category names should not contain commas or begin with periods. 
Each line has a corresponding subdirectory in the database directory.

     <br><dt><var>description</var><dd>A terse textual description of the category.

     <br><dt><var>responsible</var><dd>The name tag of the party responsible for this category of problems, as
listed in the <span class="file">responsible</span> file (see <a href="#responsible-file">The <code>responsible</code> file</a>).

     <br><dt><var>notify</var><dd>One or more other parties which should be notified when a Problem Report
with this category arrives, such as a project manager, other members of
the same project, other interested parties, or even log files.  These
should be separated with commas. 
</dl>

   <p>A good strategy for configuring this file is to have a different
category for each product your organization supports or wishes to track
information for.

<pre class="smallexample">     rock:ROCK program:me:myboss,fred
     stone:STONE utils:barney:fred
     iron:IRON firewall:me:firewall-log
</pre>
   <p>In the above example, the nametags <span class="samp">myboss</span>, <span class="samp">me</span>,
<span class="samp">fred</span>, and <span class="samp">barney</span> must be defined in the <span class="file">responsible</span>
file (see <a href="#responsible-file">The <code>responsible</code> file</a>).

   <p>Problem Reports with a category of <span class="samp">rock</span> are sent to the local
mail address (or alias) <span class="samp">me</span>, and also sent to the addresses
<span class="samp">myboss</span> and <span class="samp">fred</span>.  PRs with a category of <span class="samp">stone</span> are
sent to the local addresses <span class="samp">barney</span> and <span class="samp">fred</span> only, while
PRs with the category <span class="samp">iron</span> are sent only to <span class="samp">me</span>, and are
also filed in <code>firewall-log</code> (in this case, a mail alias should be set
up, see <a href="#Aliases">Setting up mail aliases</a>.

   <p>If you want to separate PRs in each problem category into specific
subsets, say <em>documentation</em> and <em>software bugs</em>,
using the <span class="file">classes</span> file is recommended.  See <a href="#classes-file">The <span class="file">classes</span> file</a>.

   <p>Only one category <em>must</em> be present for <span class="sc">gnats</span> to function:

<pre class="smallexample">     pending:Non-categorized PRs:gnats-admin:
</pre>
   <p><a name="index-_0040code_007bpending_007d-file-320"></a>The <span class="file">pending</span> directory is created automatically when you run
<code>mkdb</code> to initialize a new database.  (see <a href="#Configure-and-make">Configuring and compiling the software</a>).

<div class="node">
<p><hr>
<a name="responsible-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#submitters-file">submitters file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#categories-file">categories file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-config-files">Other config files</a>
<br>
</div>

<h4 class="subsection">4.4.2 The <code>responsible</code> file</h4>

<p><a name="index-_0040code_007bresponsible_007d-file-321"></a>
This file contains a list of the responsible parties.  Lines beginning
with <span class="samp">#</span> are ignored.  Each entry contains three fields, separated
by colons:

<pre class="smallexample">     <var>responsible</var>:<var>full-name</var>:<var>mail-address</var>
</pre>
   <p class="noindent">
     <dl>
<dt><var>responsible</var><dd>A name-tag description of the party in question, such as her or his user
name, or the name of the group.  This name is listed in the PR in
the <code>Responsible</code> field.

     <br><dt><var>full-name</var><dd>The full name of the party (&ldquo;Charlotte Bronte&rdquo;; &ldquo;Compiler Group&rdquo;).

     <br><dt><var>mail-address</var><dd>The full, valid mail address of the party.  This field is only necessary
if the responsible party has no local mail address or alias. 
</dl>

<p class="noindent">A sample <span class="file">responsible</span> listing might be:

<pre class="smallexample">     ren:Ren Hoek:
     stimpy:Stimpson J. Cat:stimpy@lederhosen.org
</pre>
   <p class="noindent">Here, <code>ren</code> is a local user.  <code>stimpy</code> is remote, so his full
address must be specified.

<p class="noindent">The following entry <em>must</em> be present for <span class="sc">gnats</span> to function:

<pre class="smallexample">     gnats-admin:GNATS administrator:
</pre>
   <p class="noindent"><code>gnats-admin</code> is usually defined as a mail alias when <span class="sc">gnats</span> is
installed, so for this purpose <code>gnats-admin</code> is a local address. 
However, this line can alos be used to redefine the email address of the
<span class="sc">gnats</span> administrator, by adding the desired address at the end of
the line.

<div class="node">
<p><hr>
<a name="submitters-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#states-file">states file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#responsible-file">responsible file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-config-files">Other config files</a>
<br>
</div>

<h4 class="subsection">4.4.3 The <code>submitters</code> file</h4>

<p><a name="index-_0040code_007bsubmitters_007d-file-322"></a>
This is a database of sites which submit bugs to your support site.  It
contains six fields delineated by colons.  Lines beginning with <span class="samp">#</span>
will be ignored.

   <p>Entries are of the format:

<pre class="smallexample">     <var>submitter-id</var>:<var>name</var>:<var>type</var>:<var>resp-time</var>:<var>contact</var>:<var>notify</var>
</pre>
   <p class="noindent">
     <dl>
<dt><var>submitter-id</var><dd>A unique identifier for a specific site or other entity who submits
Problem Reports. The first <code>submitter-id</code> listed in the file will
be the default for PRs that arrive with invalid or empty submitter
fields.

     <br><dt><var>name</var><dd>The full name or a description of this entity.

     <br><dt><var>type</var><dd>Optional description for the type of relationship of this submitter to
your support site.  This could indicate a contract type, a level of
expertise, etc., or it can remain blank.

     <br><dt><var>resp-time</var><dd>Optional quoted response time in <dfn>business hours</dfn>.  If the
database <span class="file">dbconfig</span> file has the <code>notify-about-expired-prs</code>
entry set to <var>true</var> (see <a href="#Overall-database-configuration">Overall database configuration</a>, <span class="sc">gnats</span> will use
this field to schedule when it should notify the gnats-admin,
responsible person and submitter contact that the PR wasn't analyzed
within the agreed response time.  Business hours and business-week
days are set in the <span class="file">dbconfig</span> file.  For information on
<code>at-pr</code>, the program which sends out this reminder, see
<a href="#at_002dpr">Timely Reminders</a>.

     <br><dt><var>contact</var><dd>The name tag of the main <dfn>contact</dfn> at the Support Site for this
submitter.  This contact should be in the <span class="file">responsible</span> file
(see <a href="#responsible-file">The <code>responsible</code> file</a>).  Incoming bugs
from <var>submitter</var> are sent to this contact.  Optionally, this field
can be left blank.

     <br><dt><var>notify</var><dd>Any other parties who should receive copies of Problem Reports sent in
by <var>submitter</var>.  They need not be listed in the <span class="file">responsible</span> file. 
</dl>

   <p>A few example entries in the <span class="file">submitters</span> file:

<pre class="smallexample">     univ-hell:University of Hades:eternal:3:beelzebub:lucifer
     tta:Telephones and Telegraphs of America:support:720:dave:
</pre>
   <p class="noindent">In this example, when a PR comes in from the University of Hades (who
has an eternal contract), it should have <span class="samp">univ-hell</span> in its
<code>Submitter-Id</code> field.  This Problem Report goes to <code>beelzebub</code>
(who should be in the <span class="file">responsible</span> file), and if it is not
analyzed within three business hours a reminder message is sent. 
<code>lucifer</code> also receives a copy of the bug, and a copy of the
reminder message as well (if it is sent).  When Telephones and
Telegraphs of America utilizes their support contract and submits a bug,
a copy is sent only to <code>dave</code>, who has 720 business hours to return
an analysis before a reminder is sent.

   <p><a name="index-disabling-_0040var_007bsubmitter_002did_007d-323"></a>To disable the feature of <span class="sc">gnats</span> which tracks the
<code>Submitter-Id</code>, simply alter the <span class="file">submitters</span> file to only
contain one <var>submitter-id</var> value, and instruct your submitters to
ignore the field.

<div class="node">
<p><hr>
<a name="states-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#addresses-file">addresses file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#submitters-file">submitters file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-config-files">Other config files</a>
<br>
</div>

<h4 class="subsection">4.4.4 The <code>states</code> file</h4>

<p><a name="index-_0040code_007bstates_007d-file-324"></a>
This file lists the possible states for Problem Reports.  Each entry
has up to three fields, separated by colons.  Lines beginning with
<span class="samp">#</span> will be ignored.

<pre class="smallexample">     <var>state</var>:<var>type</var>:<var>description</var>
</pre>
   <p class="noindent">
     <dl>
<dt><var>state</var><dd>The name of the state.  It may contain alphanumerics as well as
<span class="samp">-</span> (hyphen), <span class="samp">_</span> (underscore), or <span class="samp">.</span> (period), but no
other characters.

     <br><dt><var>type</var><dd>This is the type of the state.  This field is optional and it may
contain alphanumerics as well as <span class="samp">-</span> (hyphen), <span class="samp">_</span>
(underscore), or <span class="samp">.</span> (period), but no other characters.

     <p>The concept of the type of a state recognizes that there may for
instance be several possible states for a Problem Report which
effectively means that the PR is closed and that there may be certain
actions that need to be taken when a PR reaches a &ldquo;closed state&rdquo;. 
The problem may have been resolved, it might have been decided that
the problem is unsolvable or simply that it won't be solved.  Some
organizations may for instance wish to consider the &ldquo;suspended&rdquo;
state as a state of type &ldquo;closed&rdquo;.

     <p>Currently, the only defined state types are &ldquo;open&rdquo; and &ldquo;closed&rdquo;,
the &ldquo;open&rdquo; type isn't currently used for anything while the
&ldquo;closed&rdquo; type is only used to control the Closed-Date field of PRs. 
Changing the state of a PR to any state of type &ldquo;closed&rdquo; will set
the Closed-Date field with a time stamp and changing the state of a PR
from one &ldquo;closed&rdquo; state to another will leave the Closed-Date field
as it was.  Changing the state of a PR from any state of type
&ldquo;closed&rdquo; to a non-closed state will clear the Closed-Date field.

     <p>The <code>--skip-closed</code> option of <code>query-pr</code> refers to all
states of type &ldquo;closed&rdquo;, not to a specific state name of &ldquo;closed&rdquo;.

     <br><dt><var>description</var><dd>This is is an optional one-line description of what the state means. 
Any character is okay in the description; a newline ends it. 
<span class="sc">gnats</span> itself does not currently use the description for anything,
but certain external tools (such as TkGnats and Gnatsweb) look for it,
so it's a good idea to include one for every state. 
</dl>

   <p>The first state listed will be the state automatically assigned to
Problem Reports when they arrive; by default this is named &ldquo;open&rdquo;. 
The last state listed is the end state for Problem Reports &mdash; one
should usually assume that a PR in this state is not being actively
worked on; by default this state is named &ldquo;closed&rdquo;.  Even if a
different name has been chosen for this state, <span class="sc">gnats</span> will force
this state to be of type &ldquo;closed&rdquo;.

   <p>It is recommended that you keep the default names of &ldquo;open&rdquo; and
&ldquo;closed&rdquo; for the first and last states respectively, since there may
be external tools that depend on these names.

<div class="node">
<p><hr>
<a name="addresses-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#classes-file">classes file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#states-file">states file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-config-files">Other config files</a>
<br>
</div>

<h4 class="subsection">4.4.5 The <code>addresses</code> file</h4>

<p><a name="index-_0040code_007baddresses_007d-file-325"></a>
This file contains mappings between submitter IDs and corresponding e-mail
addresses.

   <p>When a PR comes in without a submitter ID (if someone sends unformatted
e-mail to the PR submission email address), <span class="sc">gnats</span> will try to
derive the submitter ID from the address in the "From:" header.  The
entries in this file consist of two fields, separated by a colon:

<pre class="smallexample">     <var>submitter-id</var>:<var>address-fragment</var>
</pre>
   <p class="noindent">
     <dl>
<dt><var>submitter-id</var><dd>A valid submitter ID

     <br><dt><var>address-fragment</var><dd>Part of, or all of the e-mail address to be matched
</dl>

   <p>Here is an example of an <code>addresses</code> file:

<pre class="smallexample">     # Addresses for Yoyodine Inc
     yoyodine:yoyodine.com
     yoyodine:yoyodine.co.uk
     # Addresses for Foobar Inc.
     foobar1:sales.foobar.com
     foobar2:admin.foobar.com
     foobar3:clark@research.foobar.com
</pre>
   <p><span class="sc">gnats</span> checks each line in the <code>addresses</code> file, comparing
<var>address-fragment</var> to the end of the "From:" header, until it finds
a match.  If no match is found, <span class="sc">gnats</span> uses the default submitter ID.

   <p>You can only have one address fragment per line, but you can have more than
one line for a given submitter ID.  An address fragment can be a domain
(i.e. yoyodine.com), a machine location (admin.foobar.com), or a full e-mail
address (clark@research.foobar.com).

   <p><span class="sc">gnats</span> can match addresses in three e-mail formats:

     <dl>
<dt><span class="samp">From: name@address.com</span><dd>The address by itself without a full name, not enclosed in brackets

     <br><dt><span class="samp">From: Real Person &lt;name@address.com&gt;</span><dd>A full name (optional, with or without quotation marks), followed by the
address enclosed in angle brackets

     <br><dt><span class="samp">From: name@address.com (Real Person)</span><dd>An address, followed by a name or comment in parentheses
</dl>

   <p>If <span class="sc">gnats</span> sees other e-mail address formats, it uses the default
submitter ID.

<div class="node">
<p><hr>
<a name="classes-file"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#addresses-file">addresses file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-config-files">Other config files</a>
<br>
</div>

<h4 class="subsection">4.4.6 The <code>classes</code> file</h4>

<p><a name="index-_0040code_007bclasses_007d-file-326"></a>This file lists the possible classes of Problem Reports.  Each line
consists of a class name, followed by a colon and an optional class type
name (the class type name is not used for anything in the current
implementation of <span class="sc">gnats</span>, so it may be left blank.  The <code>class</code>
and <code>class-type-name</code> fields may only contain alphanumerics,
<span class="samp">-</span>, <span class="samp">_</span>, and <span class="samp">.</span>, but no other
characters.

   <p>Then comes another colon, followed by an optional one-line
description of the class.  <span class="sc">gnats</span> itself does not use the class
description, but external tools such as Gnatsweb and TkGnats may use it. 
Therefore, a line in this file should at least contain the following:

<pre class="smallexample">     class::class description
</pre>
   <p>Lines beginning with <span class="samp">#</span> will be ignored, and the first listed
class is the default class for an incoming Problem Report.

<div class="node">
<p><hr>
<a name="send_002dpr_002econf-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Admin-files">Admin files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-config-files">Other config files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.5 The <span class="file">send-pr.conf</span> file</h3>

<p><a name="index-_0040code_007bsend_002dpr_002econf_007d-file-327"></a>This file contains some default values that need to be known in order
for <code>send-pr</code> to work properly.  This file needs to be copied to
all hosts where <code>send-pr</code> will be used.

   <p>If <span class="sc">gnats</span> was built with default options, the <span class="file">send-pr.conf</span>
file should be placed in the <span class="file">/usr/local/etc/gnats</span><!-- /@w --> directory. 
However, if the option <code>--sysconfdir</code> was used during building of
<span class="sc">gnats</span>, the <span class="file">send-pr.conf</span> file resides at the location
given to this option.

   <p>Entries in this file are on the format

<pre class="smallexample">     variable=<var>value</var>
</pre>
   <p>The valid variables are:

     <dl>
<dt><code>SUBMITTER</code><dd>The default value to be used for the Submitter-Id field when
<code>send-pr</code> is invoked.

     <br><dt><code>DEFAULT_RELEASE</code><dd>The default value to be used for the Release field (only applicable if
the Release field is defined in the <span class="file">dbconfig</span> file.

     <br><dt><code>DEFAULT_ORGANIZATION</code><dd>The default value to be used for the Organization field.  (only
applicable if the Organization field is defined in the <span class="file">dbconfig</span>
file.

     <br><dt><code>MAILPROG</code><dd>If the <span class="sc">gnats</span> server can't be reached directly over the network,
i.e. it is behind a firewall or suchlike, <code>send-pr</code> can be set up
to submit Problem Reports by e-mail.  This is done by setting the
<code>MAILPROG</code> variable to point to a mailer such as Sendmail.  If
<code>MAILPROG</code> needs to have the address that the mail is being sent
to specified on the command line, it should be specified here as well
(for example, <span class="samp">MAILPROG=''mail bugs@foo.bar.com''</span> should work). 
If Sendmail is used, use <span class="samp">MAILPROG=''/usr/lib/sendmail -oi
-t''</span>.  See also <code>MAILADDR</code> and <code>TEMPLATE</code> below.

     <br><dt><code>MAILADDR</code><dd>If using e-mail to submit PRs, this is the address that PRs should be
sent to.

     <br><dt><code>TEMPLATE</code><dd>When invoked, <code>send-pr</code> communicates directly over the network
with the <span class="sc">gnats</span> server to determine what fields to include in a
correctly formatted Problem Report so that it can present the user
with a template.  If the <span class="sc">gnats</span> server can't be reached directly
over the network, a template must be provided.  Set the
<code>TEMPLATE</code> variable to point to a template file created on the
<span class="sc">gnats</span> server by using the command <span class="command">send-pr -p</span>. 
See <a href="#Installing-tools">Installing the user tools</a>. 
</dl>

<div class="node">
<p><hr>
<a name="Admin-files"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Admin-utils">Admin utils</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#send_002dpr_002econf-file">send-pr.conf file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.6 Administrative data files</h3>

<p><a name="index-admin-files-328"></a><a name="index-files-used-for-_0040sc_007bgnats_007d-administration-329"></a>
The following files are database-specific and are located in the
<span class="file">gnats-adm</span> subdirectory of the database directory.  These files
are maintained by <span class="sc">gnats</span>; you should never need to touch them.

<ul class="menu">
<li><a accesskey="1" href="#index-file">index file</a>:       The `index' file
<li><a accesskey="2" href="#current-file">current file</a>:     The `current' file
</ul>

<div class="node">
<p><hr>
<a name="index-file"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#current-file">current file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-files">Admin files</a>
<br>
</div>

<h4 class="subsection">4.6.1 The <code>index</code> file</h4>

<p><a name="index-_0040code_007bindex_007d-file-330"></a>
The index is used to accelerate searches on the database by
<code>query-pr</code> and <code>edit-pr</code>.  This file is not created until the
first PR comes in.  It is then kept up to date by <span class="sc">gnats</span>; you should
never touch this file.

   <p>Searches on subjects contained in the index are much faster than
searches which depend on data not in the index.  Inexes come in two
different formats: <dfn>binary</dfn> and <dfn>plain-text</dfn>.  Binary indexes
are safer, in that they avoid certain problems that may crop up if the
field separators used by plain-text indexes appear in field data.

   <p>A plain-text index contains single-line entries for all PR fields
except for the multitext fields such as Description, How-To-Repeat,
etc. Fields are separated by bars (<span class="samp">|</span>) except for
<code>Category</code> and <code>Number</code>, which are separated by a slash
(<span class="samp">/</span>).

   <p>Binary indexes are not meant to be human-readable, but they are safer
than the plain-text variety, in that they avoid certain problems that may
crop up if the field separators used by plain-text indexes appear in
field data.

   <p>The format of the index for a database is set in the <span class="file">dbconfig</span>
file. See <a href="#Index-file-description">Index file description</a>.

   <p>Should the <span class="file">index</span> file become corrupted, the <code>gen-index</code>
utility can be used to regenerate it. See <a href="#gen_002dindex">Regenerating the index</a>.

<div class="node">
<p><hr>
<a name="current-file"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#index-file">index file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-files">Admin files</a>
<br>
</div>

<h4 class="subsection">4.6.2 The <code>current</code> file</h4>

<p><a name="index-_0040code_007bcurrent_007d-file-331"></a>
This file contains the last serial number assigned to an incoming PR. 
It is used internally by <span class="sc">gnats</span>; you need never touch this file.

<div class="node">
<p><hr>
<a name="Admin-utils"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Internal-utils">Internal utils</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Admin-files">Admin files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.7 Administrative utilities</h3>

<p><a name="index-administrative-utilities-332"></a>
These tools are used by the <span class="sc">gnats</span> administrator as part of the
periodic maintenance and configuration of <span class="sc">gnats</span>. 
See <a href="#Management"><span class="sc">gnats</span> Administration</a>.

<ul class="menu">
<li><a accesskey="1" href="#mkdb">mkdb</a>:           Adding another database
<li><a accesskey="2" href="#mkcat">mkcat</a>:          Adding a problem category
<li><a accesskey="3" href="#rmcat">rmcat</a>:          Removing a problem category
<li><a accesskey="4" href="#gen_002dindex">gen-index</a>:      Regenerating the index
<li><a accesskey="5" href="#check_002ddb">check-db</a>:       Checking database health
<li><a accesskey="6" href="#gnats_002dpwconv">gnats-pwconv</a>:   Managing user passwords
</ul>

<div class="node">
<p><hr>
<a name="mkdb"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#mkcat">mkcat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-utils">Admin utils</a>
<br>
</div>

<h4 class="subsection">4.7.1 Adding another database</h4>

<p><a name="index-_0040code_007bmkdb_007d-333"></a><a name="index-initializing-a-database-334"></a><a name="index-new-database-335"></a>
To initialize a new <span class="sc">gnats</span> database:

     <ol type=1 start=1>
<li>Add a line for the new database in the <span class="file">databases</span> file
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>.

     <li>Run <code>mkdb</code>, using

     <pre class="smallexample">          mkdb <var>database</var>
     </pre>
     <p>where <var>database</var> is the database you specified in the
<span class="file">databases</span> file.  <code>mkdb</code> creates the database directory and
populates it with the directories <span class="file">pending</span>, <span class="file">gnats-queue</span>
and <span class="file">gnats-adm</span>.  A full set of sample configuration files is
copied to the <span class="file">gnats-adm</span> directory.
        </ol>

<div class="node">
<p><hr>
<a name="mkcat"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#rmcat">rmcat</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mkdb">mkdb</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-utils">Admin utils</a>
<br>
</div>

<h4 class="subsection">4.7.2 Adding a problem category</h4>

<p><a name="index-_0040code_007bmkcat_007d-336"></a><a name="index-adding-a-problem-category-337"></a><a name="index-new-problem-categories-338"></a><a name="index-_0040code_007bcategories_007d-file-339"></a>
To add new categories to the database:

     <ol type=1 start=1>
<li>Add a line to for each new category to the <span class="file">categories</span> file in the
gnats-adm directory of the database. See <a href="#categories-file">The <code>categories</code> file</a>.

     <li>Run <code>mkcat</code> If applicable.  If <code>create-category-dirs</code> is set
to <code>false</code> in the database <span class="file">dbconfig</span> file, you need to create
category directories with <code>mkcat</code>.  <code>mkcat</code> creates a
subdirectory under the database directory for any new categories which
appear in the <span class="file">categories</span> file.
        </ol>

<div class="node">
<p><hr>
<a name="rmcat"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gen_002dindex">gen-index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#mkcat">mkcat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-utils">Admin utils</a>
<br>
</div>

<h4 class="subsection">4.7.3 Removing a problem category</h4>

<p><a name="index-_0040code_007brmcat_007d-340"></a><a name="index-removing-a-problem-category-341"></a><a name="index-_0040code_007bcategories_007d-file-342"></a>
To remove a category from the database:

     <ol type=1 start=1>
<li>Remove the Problem Reports from the subdirectories corresponding to the
categories you wish to remove, or assign the PRs to new categories.  All
PRs for a given category reside in a subdirectory of the database
directory, with the same name as the category.

     <li>Run <code>rmcat</code> using

     <pre class="smallexample">          rmcat <var>category</var> [ <var>category<small class="dots">...</small></var> ]
     </pre>
     <p class="noindent">where <var>category</var> is the category you wish to remove.  You can
specify as many categories as you wish as long as each category has no
PRs associated with it.  <code>rmcat</code> removes the directory where the
Problem Reports for that category had been stored.
        </ol>

<!-- FIXME!  Should we suggest this? -->
<div class="node">
<p><hr>
<a name="gen_002dindex"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#check_002ddb">check-db</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#rmcat">rmcat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-utils">Admin utils</a>
<br>
</div>

<h4 class="subsection">4.7.4 Regenerating the index</h4>

<p><a name="index-_0040code_007bgen_002dindex_007d-343"></a><a name="index-_0040code_007bindex_007d-file-344"></a>
If your <span class="file">index</span> file becomes corrupted, or if you need a copy of
the current index for some reason, use

<pre class="smallexample">     gen-index [ -n | --numeric ]
               [ -d <var>databasename</var> | --database=<var>databasename</var> ]
               [ -o <var>filename</var> | --outfile=<var>filename</var> ]
               [ -i | --import ] [ -e | --export ]
               [ -h | --help] [ -V | --version ]
</pre>
   <p class="noindent">With no options, <code>gen-index</code> generates an index that is sorted by
the order that the categories appear in the <span class="file">categories</span> file. The
index is generated in plaintext or binary format according to the value
of <code>binary-index</code> in the <span class="file">dbconfig</span> file (see <a href="#Index-file-description">Index file description</a>).  The results are printed to
standard output.  The options are:

     <dl>
<dt><code>-n</code><dt><code>--numeric</code><dd>Sorts index entries numerically.

     <br><dt><code>-d </code><var>databasename</var><dt><code>--database=</code><var>databasename</var><dd>Specifies the database to index.  If this option is left out,
<code>gen-index</code> attempts to index the database with name taken from the
the <var>GNATSDB</var> environment variable, and if that is undefined, the
default database, as set when <span class="sc">gnats</span> was built (usually
<code>default</code>).

     <br><dt><code>-o </code><var>filename</var><dt><code>--outfile=</code><var>filename</var><dd>Places output in <var>filename</var> rather than sending it to standard
output.

     <br><dt><code>-i</code><dt><code>--import</code><dd>Import the existing index file instead of re-indexing the database.

     <br><dt><code>-e</code><dt><code>--export</code><dd>Force plaintext output.

     <br><dt><code>-h</code><dt><code>--help</code><dd>Prints the usage for <code>gen-index</code>.

     <br><dt><code>-V</code><dt><code>--version</code><dd>Prints the version number for <code>gen-index</code>. 
</dl>

<div class="node">
<p><hr>
<a name="check_002ddb"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnats_002dpwconv">gnats-pwconv</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#gen_002dindex">gen-index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-utils">Admin utils</a>
<br>
</div>

<h4 class="subsection">4.7.5 Checking database health</h4>

<p><a name="index-_0040code_007bcheck_002ddb_007d-345"></a>
The <span class="file">check-db</span> script is useful for performing periodic checks on
database health.  It accepts the following options:

     <dl>
<dt><code>-d </code><var>databasename</var><dt><code>--database=</code><var>databasename</var><dd>Determines the database which to operate on.

     <br><dt><code>--all-databases</code><dd>Check all <span class="sc">gnats</span> databases on the system.  This option takes
precedence over the <code>--database</code> option. 
</dl>

   <p>If no option is given, the default database is checked.

   <p>During its operation, <code>check-db</code> first attempts to lock
<var>database</var>.  If this is not possible, it repeats the locking
attempts for five minutes; if it fails, it sends a mail message
notifying the administrator of the failure and exits.

   <p>Once the database is locked, the script searches the database for lock
files that are more than 24 hours old.  Any old lock files are reported
to the administrator in a mail message.

   <p>After checking for old lock files, it calls <code>gen-index</code>
(see <a href="#gen_002dindex">Regenerating the index</a>) and compares the
results with the current <span class="file">index</span> file of the database; any
inconsistencies are reported to the administrators in a mail message.

   <p>After checking the index file for inconsistencies, the script unlocks
the database and exits.

<div class="node">
<p><hr>
<a name="gnats_002dpwconv"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#check_002ddb">check-db</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Admin-utils">Admin utils</a>
<br>
</div>

<h4 class="subsection">4.7.6 Managing user passwords</h4>

<p><a name="index-_0040code_007bgnats_002dpwconv_007d-346"></a>
Older versions of <span class="sc">gnats</span>, up to and including version 3.x, stored
user passwords in plaintext in the <span class="file">gnatsd.user_access</span> files. Version 4
has the options of storing the password as MD5 or standard DES
<code>crypt()</code> hashes (as most UNIX versions do in the system password
files) as well as in plaintext. Since the password strings require a
prefix to indicate how they are encrypted, one is forced to convert the
old password files to a new format when upgrading to <span class="sc">gnats</span> version
4. See <a href="#Upgrading">Upgrading from older versions</a>.

   <p>The <code>gnats-pwconv</code> tool takes care of converting the old password
files to the new format:

<pre class="smallexample">     gnats-pwconv [ -c | --crypt ] [ -m | --md5 ] [ -p | --plaintext ]
              [ -h | --help] [ -V | --version ] <var>INFILE</var> [<var>OUTFILE</var>]
</pre>
   <p>Unless the <code>--version</code> or <code>--help</code> options are given, exactly
one encryption method must be specified, as well as an input file. The
output file parameter is optional. If one is not specified, results will
be printed on standard output.

<div class="node">
<p><hr>
<a name="Internal-utils"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Admin-utils">Admin utils</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Management">Management</a>
<br>
</div>

<h3 class="section">4.8 Internal utilities</h3>

<p><a name="index-internal-utilities-347"></a>
These tools are used internally by <span class="sc">gnats</span>.  You should never need to
run these by hand; however, a complete understanding may help you locate
problems with the <span class="sc">gnats</span> tools or with your local implementation.

<ul class="menu">
<li><a accesskey="1" href="#queue_002dpr">queue-pr</a>:     Handling incoming traffic
<li><a accesskey="2" href="#file_002dpr">file-pr</a>:      Processing incoming traffic
<li><a accesskey="3" href="#at_002dpr">at-pr</a>:        Timely reminders
<li><a accesskey="4" href="#pr_002dedit">pr-edit</a>:      The edit-pr driver
<li><a accesskey="5" href="#diff_002dprs">diff-prs</a>:     The <code>diff-prs</code> tool
<li><a accesskey="6" href="#pr_002dage">pr-age</a>:       The <code>pr-age</code> tool
</ul>

<div class="node">
<p><hr>
<a name="queue_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#file_002dpr">file-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-utils">Internal utils</a>
<br>
</div>

<h4 class="subsection">4.8.1 Handling incoming traffic</h4>

<p><a name="index-_0040code_007bqueue_002dpr_007d-348"></a><a name="index-handling-incoming-traffic-349"></a>
The program <code>queue-pr</code> handles traffic coming into <span class="sc">gnats</span>. 
<code>queue-pr</code> queues incoming Problem Reports in the
<span class="file">gnats-queue</span> directory of the database, and then periodically (via
<code>cron</code>) passes them on to <code>file-pr</code> to be filed in the
<span class="sc">gnats</span> database.  See <a href="#Installation">Installing <span class="sc">gnats</span></a>.

   <p>The usage for <code>queue-pr</code> is as follows:

<pre class="smallexample">     queue-pr [ -q | --queue ] [ -r | --run ]
              [ -f <var>filename</var> | --file=<var>filename</var> ]
              [ -m <var>kbytes</var> | --max-size=<var>kbytes</var> ]
              [ -d <var>databasename</var> | --database=<var>databasename</var> ]
              [ -h | --help] [ -V | --version ]
</pre>
   <p>One of <span class="samp">-q</span> or <span class="samp">-r</span> (or their longer-named counterparts) must
be present upon each call to <code>queue-pr</code>.  These options provide
different functions, as described below.

     <dl>
<dt><code>-q</code><dt><code>--queue</code><dd>Accepts standard input as an incoming mail message, placing this
message in an incrementally numbered file in the
<span class="file">gnats-queue</span><!-- /@w --> directory under the database directory
(see <a href="#Locations">Where <span class="sc">gnats</span> lives</a>).

     <br><dt><code>-r</code><dt><code>--run</code><dd>Redirects files in the <span class="file">gnats-queue</span> directory into the program
<code>file-pr</code> one by one.

     <br><dt><code>-f </code><var>filename</var><dt><code>--file=</code><var>filename</var><dd>Used with <span class="samp">-q</span> (or <span class="samp">--queue</span>), accepts the file denoted by
<var>filename</var> as input rather than reading from standard input.

     <br><dt><code>-m </code><var>kbytes</var><dt><code>--max-size=</code><var>kbytes</var><dd>Do not process messages larger then <var>kbytes</var> kilobytes.  Files
larger than the limit are left for human intervention.

     <br><dt><code>-d </code><var>databasename</var><dt><code>--directory=</code><var>databasename</var><dd>Specifies database to operate on.  If this option is left out, the value
of the <var>GNATSDB</var> environment variable is used, and if that is
undefined, the default database name set when <span class="sc">gnats</span> was built is
used (usually <code>default</code>).

     <br><dt><code>-h</code><dt><code>--help</code><dd>Prints the usage for <code>gen-index</code>.

     <br><dt><code>-V</code><dt><code>--version</code><dd>Prints the version number for <code>gen-index</code>. 
</dl>

<div class="node">
<p><hr>
<a name="file_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#at_002dpr">at-pr</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#queue_002dpr">queue-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-utils">Internal utils</a>
<br>
</div>

<h4 class="subsection">4.8.2 Processing incoming traffic</h4>

<p><a name="index-_0040code_007bfile_002dpr_007d-350"></a><a name="index-processing-incoming-traffic-351"></a>
<code>queue-pr</code> hands off queued Problem Reports to <code>file-pr</code> one
at a time.  <code>file-pr</code> checks each Problem Report for correct
information in its fields (particularly a correct <code>Category</code>),
assigns it an identification number, and files it in the database under
the appropriate category.

   <p>If the <code>Category</code> field does not contain a valid category value
(i.e., matching a line in the <code>categories</code> file; see <a href="#categories-file">The <code>categories</code> file</a>), the PR is assigned to the default
category, as set in the <code>dbconfig</code> file.  If there is no default
category defined, the PR is given a <code>Category</code> value of
<span class="samp">pending</span> and is placed in the <span class="file">pending</span> directory.  The
<span class="sc">gnats</span> administrator is notified of the unplaceable PR.

   <p><code>file-pr</code> assigns the Problem Report an identification number,
files it in the <span class="sc">gnats</span> database (under the default, if the
<code>Category</code> field contains an invalid category), and sends
acknowledgments to appropriate parties.  For the default <span class="sc">gnats</span>
configuration, the person responsible for that category of problem
(see <a href="#categories-file">The <code>categories</code> file</a>) and the person
responsible for the submitter site where the PR originated
(see <a href="#submitters-file">The <code>submitters</code> file</a>) receive a copy of
the PR in its entirety.  Optionally, the originator of the PR receives
an acknowledgment that the PR arrived and was filed (see <a href="#GNATS-configuration">Changing your <span class="sc">gnats</span> configuration</a>).

   <p>The usage for <code>file-pr</code> is as follows:

<pre class="smallexample">     file-pr [ -f <var>filename</var> | --file=<var>filename</var> ]
             [ -d <var>databasename</var> | --database=<var>databasename</var> ]
     	    [ -h | --help ] [ -V | --version ]
     
            network options:
             [ -H <var>host</var> | --host=<var>host</var> ]
             [ -P <var>port</var> | --port=<var>port</var> ]
             [ -v <var>username</var> | --user=<var>username</var> ]
             [ -w <var>password</var> | --passwd=<var>password</var> ]
</pre>
   <p><code>file-pr</code> requires no options in order to operate, and takes input
from standard input (normally, the output of <span class="samp">queue-pr&nbsp;-r</span><!-- /@w -->)
unless otherwise specified.  The options include:

     <dl>
<dt><code>-f </code><var>filename</var><dt><code>--filename=</code><var>filename</var><dd>Uses <var>filename</var> as input rather than standard input.

     <br><dt><code>-d </code><var>databasename</var><dt><code>--database=</code><var>databasename</var><dd>Performs refiling operations on <var>database</var>.  If this option is left
out, the value of the <var>GNATSDB</var> environment variable is used, and if
that is undefined, the default database name set when <span class="sc">gnats</span> was
built is used (usually <code>default</code>).

     <br><dt><code>-h</code><dt><code>--help</code><dd>Prints the usage for <code>file-pr</code>.

     <br><dt><code>-V</code><dt><code>--version</code><dd>Prints the version number for <code>file-pr</code>. 
</dl>

<p class="noindent"><code>file-pr</code> can file PRs across a network, talking to a remote
gnatsd. The following options relate to network access:

     <dl>
<dt><code>-H </code><var>host</var><dt><code>--host=</code><var>host</var><dd>Hostname of the <span class="sc">gnats</span> server.

     <br><dt><code>-P </code><var>port</var><dt><code>--port=</code><var>port</var><dd>The port that the <span class="sc">gnats</span> server runs on.

     <br><dt><code>-v </code><var>username</var><dt><code>--username=</code><var>username</var><dd>Username used to log into the <span class="sc">gnats</span> server.

     <br><dt><code>-w </code><var>password</var><dt><code>--passwd=</code><var>password</var><dd>Password used to log into the <span class="sc">gnats</span> server. 
</dl>

<div class="node">
<p><hr>
<a name="at_002dpr"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#pr_002dedit">pr-edit</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#file_002dpr">file-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-utils">Internal utils</a>
<br>
</div>

<h4 class="subsection">4.8.3 Timely reminders</h4>

<p><a name="index-_0040code_007bat_002dpr_007d-352"></a><a name="index-timely-reminders-353"></a><a name="index-automatic-notification-354"></a><a name="index-notification-of-overdue-PRs-355"></a>
<code>at-pr</code> creates a queued job using <code>at</code> which, after an
allotted <dfn>response time</dfn> is past, checks the PR to see if its state
has changed from <span class="samp">open</span>. When the PR is originally filed,
<code>file-pr</code> checks the <code>notify-about-expired-prs</code> parameter in
the <span class="file">dbconfig</span> file. If this parameter is set to <code>true</code>,
<code>file-pr</code> calls <code>at-pr</code>, which sets up the expiry check.

   <p>The <span class="file">submitters</span> file contains the response time for each
<code>&gt;Submitter-Id:</code><!-- /@w --> (see <a href="#submitters-file">The <code>submitters</code> file</a>).  The time is determined in <dfn>business hours</dfn>, which are
defined in the database's <span class="file">dbconfig</span> file (see <a href="#Overall-database-configuration">Overall database configuration</a>).

   <p>If the PR is urgent and is still open after the requisite time period
has passed, <code>at-pr</code> sends a reminder to the <span class="sc">gnats</span>
administrator, to the maintainer responsible for that submitter, and
to the maintainer responsible for the PR with the following message:

   <p><a name="index-reminder-message-356"></a><a name="index-_0040code_007bat_002dpr_007d-357"></a>
<pre class="smallexample">     To: <var>submitter-contact</var> <var>responsible</var> <var>gnats-admin</var>
     Subject: PR <var>gnats-id</var> not analyzed in <var>#hours</var> hours
     
     PR <var>gnats-id</var> was not analyzed within the acknowledgment period
     of <var>#hours</var> business hours.  The pertinent information is:
     
      Submitter-Id: <var>submitter</var>
      Originator: <var>full name of the submitter</var>
      Synopsis: <var>synopsis</var>
      Person responsible for the PR: <var>responsible</var>
     
     --
     The GNU Problem Report Management System (GNATS)
</pre>
   <p>The PR is <dfn>urgent</dfn> if its priority is <span class="samp">critical</span> or if its
priority is <span class="samp">serious</span> and the severity is <span class="samp">high</span>.

<div class="node">
<p><hr>
<a name="pr_002dedit"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#diff_002dprs">diff-prs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#at_002dpr">at-pr</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-utils">Internal utils</a>
<br>
</div>

<h4 class="subsection">4.8.4 The <code>edit-pr</code> driver</h4>

<p><a name="index-_0040code_007bpr_002dedit_007d-358"></a><a name="index-_0040code_007bedit_002dpr_007d-driver-359"></a><a name="index-driver-for-_0040code_007bedit_002dpr_007d-360"></a>
<code>pr-edit</code> does the background work for <code>edit-pr</code>, including
error-checking and refiling newly edited Problem Reports, handling file
and database locks and deletion of PRs.  It can be called interactively,
though it has no usable editing interface.

   <p>The usage for <code>pr-edit</code> is:

<pre class="smallexample">     pr-edit   [ -l <var>username</var> | --lock=<var>username</var> ] [ -u | --unlockdb ]
               [ -L | --lockdb ] [ -U | --unlockdb ] [ -c | --check ]
               [ -C | --check-initial ] [ -s | --submit [ --show-prnum ] ]
               [ -a <var>field</var> | --append field=<var>field</var> ]
               [ -r <var>field</var> | --replace=<var>field</var> ] [ --delete-pr ]
               [ -R <var>reason</var> | --reason=<var>reason</var> ]
               [ -p <var>process-id</var> | --process=<var>process-id</var> ]
               [ -d <var>databasename</var> | --database=<var>databasename</var> ]
               [ -f <var>filename</var> | --filename=<var>filename</var> ]
               [ -V | --version ]
               [ -h | --help ] [ -v <var>username</var> | --user=<var>username</var> ]
               [ -w <var>passwd</var> | --passwd=<var>passwd</var> ]
               [ -H <var>host</var> | --host=<var>host</var> ]
               [ -P <var>port</var> | --port=<var>port</var> ]
               [ -D | --debug ] [ <var>PR number</var> ]
</pre>
   <p><a name="index-PR-locks-361"></a><a name="index-locks-362"></a>A <dfn>lock</dfn> is placed on a Problem Report while the PR is being edited. 
The lock is simply a file in the <span class="file">locks</span> subdirectory of the
<span class="file">gnats-adm</span> directory of the database, with the name
<var>gnats-id</var><span class="file">.lock</span><!-- /@w -->, which contains the name of the
user who created the lock.  <var>user</var> then &ldquo;owns&rdquo; the
lock, and must remove it before the PR can be locked again, even by the
same <var>user</var><a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>.  If a PR is already
locked when you attempt to edit it, <code>pr-edit</code> prints an error
message giving the name of the user who is currently editing the
PR.

   <p>If you do not specify <var>PR&nbsp;number</var><!-- /@w -->, <code>pr-edit</code> reads from
standard input.  You must specify <var>PR&nbsp;number</var><!-- /@w --> for the functions
which affect PR locks, <span class="samp">--lock=</span><var>username</var> and
<span class="samp">--unlock</span>.

     <dl>
<dt><code>-L</code><dt><code>--lockdb</code><dd>Locks the database specified with the <code>--database</code> or <code>-d</code>
option.  No PRs may be edited, created or deleted while the database is
locked.  This option is generally used when editing the index file.

     <br><dt><code>-U</code><dt><code>--unlockdb</code><dd>Unlocks the specified database.  No check is made that the invoking user
actually had locked the database in the first place; hence, it is
possible for anyone to steal a database lock.

     <br><dt><code>-c</code><dt><code>--check</code><dt><code>-C</code><dt><code>--check-initial</code><dd>The <code>--check</code> options are used to verify that a proposed PR's field
contents are valid.  The PR is read in (either from stdin or a file
specified with <code>--filename</code>), and its fields are compared against
the rules specified by the database configuration of the selected
database.  Warnings are given for enumerated fields whose contents do
not contain one of the required values or fields that do not match
required regexps. <code>--check-initial</code> is used to verify initial PRs,
rather than proposed edits of existing PRs.

     <br><dt><code>-s</code><dt><code>--submit</code><dd>Used to submit a new PR to the database.  The PR is read in and verified
for content; if the PR is valid as an initial PR, it is then added to
the database.  If the submission is successful a zero exit code is
returned.  Otherwise, the reason(s) for the PR being rejected are
printed, and a non-zero exit code is returned.

     <br><dt><code>--show-prnum</code><dd>This option is used with the <code>--submit</code> option to display the PR
number associated with the submitted PR. 
</dl>

<p class="noindent">The following options require a PR number to be given.

     <dl>
<dt><code>--delete-pr</code><dd>Deletes the specified PR from the database.  The PR must be in a closed
state, and not locked.  Only the user <em>gnats</em> (or the user name
specified instead of <em>gnats</em> during the building of <span class="sc">gnats</span>) is
permitted to delete PRs.

     <br><dt><code>-l </code><var>username</var><dt><code>--lock=</code><var>username</var><dd>Locks the PR.  <var>username</var> is associated with the lock, so the system
administrator can determine who actually placed the lock on the PR. 
However, anyone is permitted to remove locks on a PR.  If the optional
<code>--process</code> or <code>-p</code> option is also given, that process-id is
associated with the lock.

     <br><dt><code>-u</code><dt><code>--unlock</code><dd>Unlocks the specified PR.

     <br><dt><code>-a </code><var>field</var><dt><code>--append=</code><var>field</var><br><dt><code>-r </code><var>field</var><dt><code>--replace=</code><var>field</var><dd><code>--append</code> and <code>--replace</code> are used to append or replace
content of a specific field within a PR.  The new field content is read
in from stdin (or from the file specified with the <code>--filename</code>
option), and either appended or replaced to the specified field.  The
field contents are verified for correctness before the PR is rewritten. 
If the edit is successful, a zero exit status is returned.  If the edit
failed, a non-zero exit status is returned, and the reasons for the
failure are printed to stdout.

     <br><dt><code>-R </code><var>reason</var><dt><code>--reason=</code><var>reason</var><dd>Certain PR fields are configured in the database configuration to
require a short text describing the reason of every change that
happens to them, See <a href="#dbconfig-file">dbconfig file</a>.  If you edit a problem and
change any of such fields, you must issue a short text, the
<var>reason</var> of the change, through this option.  If the option is
used and no change-reason requiring field is actually changed, the
option has no effect.

     <br><dt><code>PR number</code><dd>If only a <code>PR number</code> is specified with no other options, a
replacement PR is read in (either from stdin or the file specified with
<code>--filename</code>).  If the PR contents are valid and correct, the
existing PR is replaced with the new PR contents.  If the edit is
successful, a zero exit status is re turned.  If the edit failed, a
non-zero exit status is returned, and the reasons for the failure are
printed to stdout.

     <br><dt><code>-d </code><var>database</var><dt><code>--database=</code><var>database</var><dd>Specifies the database which is to be manipulated.  If no database is
specified, the default database name set when <span class="sc">gnats</span> was built is
used (usually <code>default</code>).  This option overrides the database
specified in the GNATSDB environment variable.

     <br><dt><code>-f </code><var>filename</var><dt><code>--filename=</code><var>filename</var><dd>For actions that require reading in a PR or field content, this
specifies the name of a file to read.  If <code>--filename</code> is not
specified, the PR or field content is read in from stdin.

     <br><dt><code>-h</code><dt><code>--help</code><dd>Prints the usage for <code>pr-edit</code>.

     <br><dt><code>-V</code><dt><code>--version</code><dd>Prints the version number for <code>pr-edit</code>. 
</dl>

<p class="noindent"><code>pr-edit</code> can edit PRs across a network, talking to a
remote gnatsd. The following options relate to network access:

     <dl>
<dt><code>-H </code><var>host</var><dt><code>--host=</code><var>host</var><dd>Hostname of the <span class="sc">gnats</span> server.

     <br><dt><code>-P </code><var>port</var><dt><code>--port=</code><var>port</var><dd>The port that the <span class="sc">gnats</span> server runs on.

     <br><dt><code>-v </code><var>username</var><dt><code>--username=</code><var>username</var><dd>Username used to log into the <span class="sc">gnats</span> server.

     <br><dt><code>-w </code><var>password</var><dt><code>--passwd=</code><var>password</var><dd>Password used to log into the <span class="sc">gnats</span> server.

     <br><dt><code>-D</code><dt><code>--debug</code><dd>Used to debug network connections. 
</dl>

<div class="node">
<p><hr>
<a name="diff_002dprs"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#pr_002dage">pr-age</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#pr_002dedit">pr-edit</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-utils">Internal utils</a>
<br>
</div>

<h4 class="subsection">4.8.5 The <code>diff-prs</code> tool</h4>

<p><a name="index-_0040code_007bdiff_002dprs_007d-363"></a>
The <code>diff-prs</code> tool is invoked as follows:

<pre class="example">     diff-prs <var>prfile1</var> <var>prfile2</var>
</pre>
   <p><code>diff-prs</code> simply reads the PRs contained in <var>prfile1</var> and
<var>prfile2</var> and returns a list of the fields that are different
between the two.  No output is produced if the PRs are identical.

<div class="node">
<p><hr>
<a name="pr_002dage"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#diff_002dprs">diff-prs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-utils">Internal utils</a>
<br>
</div>

<h4 class="subsection">4.8.6 The <code>pr-age</code> tool</h4>

<p><a name="index-_0040code_007bpr_002dage_007d-364"></a><a name="index-age-of-PR-365"></a>
The <code>pr-age</code> tool reports the time, in days and hours, since the PR
arrived.  Usage is

<pre class="smallexample">     pr-age  [ -d <var>databasename</var> | --database=<var>databasename</var> ]
             [ -H <var>host</var> | --host=<var>host</var> ]
             [ -P <var>port</var> | --port=<var>port</var> ]
             [ -v <var>username</var> | --user=<var>username</var> ]
             [ -w <var>password</var> | --passwd=<var>password</var> ]
             [ -h | --help ] [ -V | --version ]
</pre>
   <p>For an explanation of the arguments listed above, please refer to the
usage description for <code>file-pr</code> (<a href="#file_002dpr"><code>file-pr</code></a>).

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Locations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd">gnatsd</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Management">Management</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix A Where <span class="sc">gnats</span> lives</h2>

<p><a name="index-locations-366"></a><a name="index-where-_0040sc_007bgnats_007d-lives-367"></a><a name="index-default-installation-locations-368"></a>
We use a few conventions when referring to the installation structure
<span class="sc">gnats</span> uses.  These values are adjustable when you build and install
<span class="sc">gnats</span> (see <a href="#Installation">Installing <span class="sc">gnats</span></a>).

<ul class="menu">
<li><a accesskey="1" href="#prefix">prefix</a>
<li><a accesskey="2" href="#exec_002dprefix">exec-prefix</a>
<li><a accesskey="3" href="#gnats_002dadm">gnats-adm</a>
<li><a accesskey="4" href="#defaults">defaults</a>:                     Default installation locations
</ul>

<div class="node">
<p><hr>
<a name="prefix"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#exec_002dprefix">exec-prefix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h3 class="section">A.1 <var>prefix</var></h3>

<p><a name="index-_0040var_007bprefix_007d-369"></a>
<var>prefix</var> corresponds to the variable <span class="samp">prefix</span> for
<code>configure</code>, which passes it on to the <span class="file">Makefile</span> it creates. 
<var>prefix</var> sets the root installation directory for
<dfn>host-independent</dfn> files as follows:

<!-- FIXME - check these -->
<dl>
<dt>the directory path of the default database<dd><var>prefix</var><span class="file">/com</span><br>

     <br><dt>site-wide configuration files<dd><var>prefix</var><span class="file">/etc/gnats</span><br>

     <br><dt><code>man</code> pages<dd><var>prefix</var><span class="file">/man</span>

     <br><dt><code>info</code> documents<dd><var>prefix</var><span class="file">/info</span>

     <br><dt><code>include</code> files<dd><var>prefix</var><span class="file">/include</span>

     <br><dt><em>etc<small class="dots">...</small></em><dd></dl>

   <p>The default value for <var>prefix</var> is <span class="file">/usr/local</span><!-- /@w -->, which can
be changed on the command line to <code>configure</code> using

<pre class="smallexample">     configure --prefix=<var>prefix</var> ...
</pre>
   <p class="noindent">See <a href="#Configure-and-make">Configuring and compiling the software</a>.

<div class="node">
<p><hr>
<a name="exec_002dprefix"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnats_002dadm">gnats-adm</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#prefix">prefix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h3 class="section">A.2 <var>exec-prefix</var></h3>

<p><a name="index-_0040var_007bexec_002dprefix_007d-370"></a>
<var>exec-prefix</var> corresponds to the variable <span class="samp">exec-prefix</span> for
<code>configure</code>, which passes it on to the <span class="file">Makefile</span> it creates. 
<var>exec-prefix</var><!-- /@w --> sets the root installation for
<dfn>host-dependent</dfn> files as follows:

     <dl>
<dt><span class="sc">gnats</span> user tools<dd><var>exec-prefix</var><span class="file">/bin</span>

     <br><dt>administrative and support utilities<dd><var>exec-prefix</var><span class="file">/libexec/gnats</span>

     <br><dt>compiled libraries<dd><var>exec-prefix</var><span class="file">/lib</span><br>

     <br><dt><em>etc<small class="dots">...</small></em><dd></dl>

   <p><code>configure</code> supports several more options which allow you to
specify in great detail where different files are installed.  The
locations given in this appendix do not take into account highly
customized installations, but fairly ordinary <span class="sc">gnats</span> installations
should be covered by the material here.  For a complete list of options
accepted by <code>configure</code>, run <code>./configure --help</code> in the
<span class="file">gnats</span> subdirectory of the distribution.

   <p>Since most installations are not intended to be distributed around a
network, the default value for <var>exec-prefix</var><!-- /@w --> is the value of
<span class="samp">prefix</span>, i.e., <span class="file">/usr/local</span><!-- /@w -->.  However, using
<var>exec-prefix</var> saves space when you are installing a package on
several different platforms for which many files are identical; rather
than duplicate them for each host, these files can be shared in a common
repository, and you can use symbolic links on each host to find the
host-dependent files.

   <p>Use <var>exec-prefix</var> in conjunction with <var>prefix</var> to share
host-independent files, like libraries and <code>info</code> documents.  For
example:

<pre class="smallexample">        <em>for each host:</em>
     configure --prefix=/usr/gnu --exec-prefix=/usr/gnu/H-<var>host</var>
     make all install ...
</pre>
   <p class="noindent">Using this paradigm, all host-dependent binary files are installed into
<span class="file">/usr/gnu/H-</span><var>host</var><span class="file">/bin</span><!-- /@w -->, while files which do not depend on
the host type for which they were configured are installed into
<span class="file">/usr/gnu</span><!-- /@w -->.

   <p>You can then use a different symbolic link for <span class="file">/usr/gnu</span><!-- /@w -->
on each host (<span class="file">/usr</span> is usually specific to a particular machine;
it is always specific to a particular architecture).

<pre class="smallexample">       <em>on host-1:</em>
     ln -s /usr/gnu/H-<var>host-1</var> /usr/gnu
       <em>on host-2:</em>
     ln -s /usr/gnu/H-<var>host-2</var> /usr/gnu
</pre>
   <p class="noindent">To the end user, then, placing <span class="file">/usr/gnu/bin</span><!-- /@w --> in her or his
<code>PATH</code> simply works transparently for each <var>host</var> type.

   <p>You can change <var>exec-prefix</var><!-- /@w --> on the command line to
<code>configure</code> using

<pre class="smallexample">     configure --exec-prefix=<var>exec-prefix</var> ...
</pre>
   <p>We recommend that you consult <a href="configure.html#Using-configure">Using <code>configure</code> (Cygnus configure)</a>, before attempting this.

<div class="node">
<p><hr>
<a name="gnats_002dadm"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#defaults">defaults</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#exec_002dprefix">exec-prefix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h3 class="section">A.3 The <span class="file">gnats-adm</span> directory</h3>

<p><a name="index-_0040var_007bgnats_002dadm_007d-371"></a>
Each <span class="sc">gnats</span> database located on a server has its own directory, as
listed in the <span class="file">databases</span> (see <a href="#databases-file">The <code>databases</code> file</a> and given when the <code>mkdb</code> utility is invoked
to initialize the database (see <a href="#mkdb">Initializing a new database</a>). 
This directory has several subdirectories, one of which is named
<span class="file">gnats-adm</span>.  This directory contains all configuration files
related to this specific database, including the <span class="file">categories</span>,
<span class="file">submitters</span>, <span class="file">responsible</span>, <span class="file">states</span>, <span class="file">classes</span>,
<span class="file">dbconfig</span>, <span class="file">addresses</span>, <span class="file">states</span> and
<span class="file">gnatsd.user_access</span>, as well as two
files generated and maintained by <span class="sc">gnats</span>, <span class="file">index</span> and
<span class="file">current</span>.

<div class="node">
<p><hr>
<a name="defaults"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnats_002dadm">gnats-adm</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h3 class="section">A.4 Default installation locations</h3>

<p><a name="index-default-installation-locations-372"></a>
     <dl>
<dt><var>prefix</var><dd>defaults to <span class="file">/usr/local</span>; change using <code>configure</code>
(see <a href="#Configure-and-make">Configuring and compiling the software</a>).

     <br><dt><var>exec-prefix</var><dd>defaults to <var>prefix</var>; change using <code>configure</code>
(see <a href="#Configure-and-make">Configuring and compiling the software</a>). 
</dl>

<p class="noindent"><span class="sc">gnats</span> installs tools, utilities, and files into the following
locations.

     <dl>
<dt><var>exec-prefix</var><code>/bin</code><dd>
          <dl>
<dt><code>send-pr</code><dd>See <a href="#send_002dpr">Submitting Problem Reports</a>. 
<br><dt><code>edit-pr</code><dd>See <a href="#edit_002dpr">Editing existing Problem Reports</a>. 
<br><dt><code>query-pr</code><dd>See <a href="#query_002dpr">Querying the database</a>. 
</dl>

     <br><dt><var>exec-prefix</var><code>/libexec/gnats</code><dd>
          <dl>
<dt><code>at-pr</code><dd>See <a href="#at_002dpr">Timely reminders</a>.

          <br><dt><code>check-db</code><dd>See <a href="#check_002ddb">Checking database health</a>.

          <br><dt><code>delete-pr</code><dd>Tool for deleting PRs.  Deprecated.  Use the &ndash;delete-pr option of
<code>pr-edit</code> instead (see <a href="#pr_002dedit">The edit-pr driver</a>).

          <br><dt><code>diff-prs</code><dd>See <a href="#diff_002dprs">The <code>diff-prs</code> tool</a>.

          <br><dt><code>file-pr</code><dd>See <a href="#file_002dpr">Interface to pr-edit for filing new PRs</a>.

          <br><dt><code>gen-index</code><dd>See <a href="#gen_002dindex">Regenerating the index</a>.

          <br><dt><code>gnatsd</code><dd>The <span class="sc">gnats</span> daemon.

          <br><dt><code>gnats-pwconv</code><dd>See <a href="#gnats_002dpwconv">Converting old password files</a>.

          <br><dt><code>mail-query</code><dd>See <a href="#Aliases">Setting up mail aliases</a>.

          <br><dt><code>mkcat</code><dd>See <a href="#mkcat">Adding a problem category</a>.

          <br><dt><code>mkdb</code><dd>See <a href="#mkdb">Script for creating new databases</a>.

          <br><dt><code>pr-age</code><dd>See <a href="#pr_002dage">The <code>pr-age</code> tool</a>.

          <br><dt><code>pr-edit</code><dd>See <a href="#pr_002dedit">The main PR processor</a>.

          <br><dt><code>queue-pr</code><dd>See <a href="#queue_002dpr">Handling incoming traffic</a>.

          <br><dt><code>rmcat</code><dd>See <a href="#rmcat">Removing categories</a>. 
</dl>

     <br><dt><var>exec-prefix</var><code>/lib/libiberty.a</code><dd>The <span class="sc">gnu</span> <code>libiberty</code> library.

     <br><dt><var>prefix</var><code>/etc/gnats</code><dd>
          <dl>
<dt><span class="file">databases</span><dd>See <a href="#databases-file">The <span class="file">databases</span> file</a>.

          <br><dt><span class="file">defaults</span><dd>See <a href="#GNATS-configuration">Overview of <span class="sc">gnats</span> configuration</a>.

          <br><dt><span class="file">gnatsd.host_access</span><dd>See <a href="#gnatsd_002ehost_005faccess">The <span class="file">gnatsd.host_access</span> file</a>.

          <br><dt><span class="file">gnatsd.user_access</span><dd>See <a href="#gnatsd_002euser_005faccess">The <span class="file">gnatsd.user_access</span> file</a>. 
</dl>

     <br><dt><var>prefix</var><code>/share/emacs/site-lisp</code><dd>
          <dl>
<dt><span class="file">gnats.el</span><dt><span class="file">gnats.elc</span><dd>The Emacs versions of the programs <code>send-pr</code>, <code>query-pr</code>,
<code>edit-pr</code>, and <code>view-pr</code>.  See <a href="#GNATS-user-tools">The <span class="sc">gnats</span> user tools</a>.  To change this directory you must change the
<code>lispdir</code> variable in <span class="file">Makefile.in</span>; see <a href="#Configure-and-make">Configuring and compiling the software</a>. 
</dl>

     <br><dt><var>prefix</var><code>/info</code><dd>
          <dl>
<dt><span class="file">gnats.info</span><dt><span class="file">send-pr.info</span><dd>The <span class="sc">gnats</span> manuals, in a form readable by <code>info</code> (the <span class="sc">gnu</span>
hypertext browser).  See <a href="infoman.html#Info">Reading GNU Online Documentation (GNU Online Documentation)</a>. 
</dl>

     <br><dt><var>prefix</var><code>/man/man1</code><dt><var>prefix</var><code>/man/man8</code><dd>
          <dl>
<dt><code>man</code> pages for all the <span class="sc">gnats</span> tools and utilities.<dd>See <a href="#GNATS-user-tools">The <span class="sc">gnats</span> user tools</a>. 
</dl>

     <br><dt><code>Per-database directory</code><dd>
          <dl>
<dt><span class="file">gnats-adm</span><dd>Administration and configuration data files that define behaviour of the
particular database.  The files

               <dl>
<dt><span class="file">categories</span>
<br><dt><span class="file">submitters</span>
<br><dt><span class="file">responsible</span>
<br><dt><span class="file">states</span>
<br><dt><span class="file">classes</span>
<br><dt><span class="file">dbconfig</span>
<br><dt><span class="file">addresses</span>
<br><dt><span class="file">states</span>
<br><dt><span class="file">gnatsd.user_access</span>
<br><dt><span class="file">index</span><dd>(<em>This file is created by </em><span class="sc">gnats</span><em>.</em>)

               <br><dt><span class="file">current</span><dd>(<em>This file is created by </em><span class="sc">gnats</span><em>.</em>)
</dl>

          <p class="noindent">exist here. 
See <a href="#Other-config-files">Other database-specific config files</a>,
<a href="#Admin-files">Administrative data files</a> and <a href="#Access-Control">Controlling access to databases</a>.

          <br><dt><span class="file">gnats-queue</span><dd>Incoming Problem Reports are queued here until the next iteration of
<span class="samp">queue-pr&nbsp;-r</span><!-- /@w --> (see <a href="#queue_002dpr">Handling incoming traffic</a>).

          <br><dt><span class="file">pending</span><dd>If no default category is set, problem reports without a category are
reassigned to the category <span class="samp">pending</span> and placed here pending
intervention by <span class="sc">gnats</span> administrators. 
See <a href="#Management"><span class="sc">gnats</span> administration</a>.

          <br><dt><var>category</var><dd>Each valid category has a corresponding subdirectory in the database. 
All Problem Reports associated with that category are kept in that
subdirectory. 
</dl>

   </dl>

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="gnatsd"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Access-Control">Access Control</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Locations">Locations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix B The <span class="sc">gnats</span> network server &ndash; <code>gnatsd</code></h2>

<p><a name="index-_0040code_007bgnatsd_007d-373"></a>
This section describes in details how the <span class="sc">gnats</span> network daemon
works.  This information is mainly assumed to be useful for developers
of <span class="sc">gnats</span> client software.

<ul class="menu">
<li><a accesskey="1" href="#Description-of-gnatsd">Description of gnatsd</a>
<li><a accesskey="2" href="#gnatsd-options">gnatsd options</a>
<li><a accesskey="3" href="#gnatsd-command-protocol">gnatsd command protocol</a>
<li><a accesskey="4" href="#gnatsd-commands">gnatsd commands</a>
<li><a accesskey="5" href="#gnatsd-environment-variables">gnatsd environment variables</a>
</ul>

<div class="node">
<p><hr>
<a name="Description-of-gnatsd"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd-options">gnatsd options</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#gnatsd">gnatsd</a>
<br>
</div>

<h3 class="section">B.1 Description of <code>gnatsd</code></h3>

<p><a name="index-_0040code_007bgnatsd_007d-description-374"></a>
The <code>gnatsd</code> network daemon is used to service remote <span class="sc">gnats</span>
requests such as querying PRs, PR creation, deletion, and editing, and
miscellaneous database queries.  It uses a simple ASCII-based command
protocol (similar to SMTP or POP3) for communicating with remote
clients.

   <p>It also provides a security model based either on IP-based
authentication (generally considered very weak) or username/passwords,
where passwords may be in cleartext, UNIX crypt or MD5 hash format. 
Access through <code>gnatsd</code> is granted according to certain predefined
<dfn>access levels</dfn>.  Access levels are further discussed in <a href="#Access-Control">Controlling access to databases</a>.  It should be emphasized that
security has not been a focus of development until now, but future
versions are expected to address this more thoroughly.

   <p>All of the <span class="sc">gnats</span> clients are capable of communicating via the <span class="sc">gnats</span>
remote protocol to perform their functions. 
<!-- XXX Add reference to remote tool installation section here. -->

   <p><code>gnatsd</code> is usually started from the inetd facility and should run as
the <code>gnats</code> user (the actual username of this user is configurable
during installation, see <a href="#Configure-and-make">Configuring and compiling the software</a> for details.)

<div class="node">
<p><hr>
<a name="gnatsd-options"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd-command-protocol">gnatsd command protocol</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Description-of-gnatsd">Description of gnatsd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#gnatsd">gnatsd</a>
<br>
</div>

<h3 class="section">B.2 <code>gnatsd</code> options</h3>

<p><a name="index-_0040code_007bgnatsd_007d-options-375"></a>
The daemon supports the following command-line options:

<pre class="smallexample">     gnatsd [--database database | -d database]
            [--not-inetd | -n] [--max-access-level <var>level</var> | -m <var>level</var>]
            [--version | -V] [--help | -h]
</pre>
   <p><a name="index-_0040code_007bgnatsd_007d-startup-options-376"></a>
     <dl>
<dt><code>-V, --version</code><dd>Prints the program version to stdout and exits.

     <br><dt><code>-h, --help</code><dd>Prints a short help text to stdout and exits.

     <br><dt><code>-d, --database</code><dd>Specifies the default database which is to be serviced by this
invocation of <code>gnatsd</code>. (The selected database may be changed via
the <code>CHDB</code> command; the name set with this option is simply the
default if no <code>CHDB</code> command is issued.)  If no database is
specified, the database named default is assumed. This option overrides
the database specified in the <code>GNATSDB</code> environment variable.

     <br><dt><code>-n, --not-inetd</code><dd>As its name suggests, indicates that <code>gnatsd</code> is not being invoked
from inetd. This can be used when testing <code>gnatsd</code>, or if it is
being run via ssh or some other mechanism.

     <p>This has the effect of using the local hostname where <code>gnatsd</code> is
being invoked for authentication purposes, rather than the remote
address of the connecting client.

     <br><dt><code>--max-access-level, -m</code><dd>Specifies the maximum access level that the connecting client can
authenticate to.  Authentication is as normal but if the user or host
authenticates at a higher level, access level is still forced to this
level.  See <a href="#Access-Control">Controlling access to databases</a> for
details on access levels. 
</dl>

<div class="node">
<p><hr>
<a name="gnatsd-command-protocol"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd-commands">gnatsd commands</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnatsd-options">gnatsd options</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#gnatsd">gnatsd</a>
<br>
</div>

<h3 class="section">B.3 <code>gnatsd</code> command protocol</h3>

<p><a name="index-_0040code_007bgnatsd_007d-command-protocol-377"></a>
Commands are issued to <code>gnatsd</code> as one or more words followed by a
carriage-return/linefeed pair.  For example, the <code>CHDB</code> (change
database) command is sent as <span class="samp">CHDB database&lt;CR&gt;&lt;LF&gt;</span> (the
<code>CRLF</code> will not be explicitly written for future examples.)

   <p>Replies from <code>gnatsd</code> are returned as one or more response lines
containing a 3-digit numeric code followed by a human-readable string;
the line is terminated with a <code>&lt;CR&gt;&lt;LF&gt;</code> pair.  For example, one
possible response to the <code>CHDB</code> command above would be:

<pre class="smallexample">     210 Now accessing GNATS database 'database'.
</pre>
   <p>The three-digit code is normally followed by a single ASCII space
(character 0x20).  However, if additional response lines are to be
returned from the server, there will be a single dash <span class="samp">-</span> instead
of the space character after the three-digit code.

   <p>Response code values are divided into ranges.  The first digit reflects
the general type of response (such as &rdquo;successful&rdquo; or &rdquo;error&rdquo;), and
the subsequent digits identify the specific type of response.

     <dl>
<dt><var>Codes 200-299</var><dd>Positive response indicating that the command was successful.  No
subsequent data will be transmitted with the response.  In particular,
code 210 (<code>CODE_OK</code>) is used as the positive result code for most
simple commands.

     <p>Commands that expect additional data from the client (such as
<code>SUBM</code> or <code>VFLD</code>) use a two-step mechanism for sending the
data.  The server will respond to the initial command with either a 211
(<code>CODE_SEND_PR</code>) or 212 (<code>CODE_SEND_TEXT</code>) response line, or
an error code if an error occurred with the initial command.  The client
is then expected to send the remaining data using the same quoting
mechanism as described for server responses in the 300-349 range.  The
server will then send a final response line to the command.

     <br><dt><var>Codes 300-399</var><dd>Positive response indicating that the query request was successful, and
that a PR or other data will follow.  Codes 300-349 are used when
transmitting PRs, and 350-399 are used for other responses.

     <p>Codes in the 300-349 range are followed by a series of
<code>CRLF</code>-terminated lines containing the command response, usually a
PR.  The final line of the result is a single period <span class="samp">.</span>.  Result
lines that begin with a period have an extra period prepended to them.

     <p>Codes in the 350-399 range use a different scheme for sending their
responses. The three-digit numeric code will be followed by either a
dash <span class="samp">-</span> or a single space.  If the code is followed by a dash,
that indicates that another response line will follow.  The final line
of the response has a single space after the three-digit code.

     <p>In previous versions of the protocol the first line of a
<code>CODE_INFORMATION</code> (310) response was to be ignored.  This is no
longer the case.  Instead, any lines marked with code
<code>CODE_INFORMATION_FILLER</code> (351) are to be ignored.  This allows the
server to transmit additional headers or other human-readable text that
can be safely ignored by the clients.

     <br><dt><var>Codes 400-599</var><dd>An error occurred, usually because of invalid command parameters or
invalid input from the client, missing arguments to the command, or a
command was issued out of sequence.  The human-readable message
associated with the response line describes the general problem
encountered with the command.

     <p>Multiple error messages may be returned from a command; in this case the
<span class="samp">-</span> continuation character is used on all but the last response
line.

     <br><dt><var>Codes 600-799</var><dd>An internal error occurred on the server, a timeout occurred reading
data from the client, or a network failure occurred.  These errors are
of the &rdquo;this should not occur&rdquo; nature, and retrying the operation may
resolve the problem.  Fortunately, most <span class="sc">gnats</span> transactions are
idempotent; unfortunately, locking the database or a PR are not
repeatable actions (we cannot determine if an existing lock is the one
we originally requested, or someone else's). 
</dl>

<div class="node">
<p><hr>
<a name="gnatsd-commands"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd-environment-variables">gnatsd environment variables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnatsd-command-protocol">gnatsd command protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#gnatsd">gnatsd</a>
<br>
</div>

<h3 class="section">B.4 <code>gnatsd</code> commands</h3>

<p><a name="index-_0040code_007bgnatsd_007d-commands-378"></a><a name="index-_0040code_007bgnatsd_007d-commands-379"></a>
Note that the set of <span class="sc">gnats</span> commands and their responses is somewhat
inconsistent and is very much in flux.  At present the <span class="sc">gnats</span>
clients are rather simple-minded and not very strict about processing
responses.  For example, if the server were to issue a code 300
(<code>CODE_PR_READY</code>) response to a <code>CHDB</code> command, the client
would happily expect to see a PR appear (and would print it out if one
was sent).

   <p>It is thus suggested that any clients that use the <span class="sc">gnats</span> protocol
be equally flexible about the way received responses are handled; in
particular, only the first digit of the response code should be assumed
to be meaningful, although subsequent digits are needed in some cases
(codes 300-399).  No attempt should be made to parse the message strings
on error response lines; they are only intended to be read by humans,
and will be changed on a regular basis.

   <p>Almost every command may result in the response 440
(<code>CODE_CMD_ERROR</code>).  This indicates that there was a problem with
the command arguments, usually because of insufficient or too many
arguments being specified.

   <p>Access to most <code>gnatsd</code> commands requires a certain <dfn>access
level</dfn>.  For details of this, see <a href="#Privileged-gnatsd-commands">Privileged <code>gnatsd</code> commands</a>.

     <dl>
<dt><code>USER [</code><var>userid</var> <var>password</var><code>]</code><dd>Specifies the userid and password for database access.  Either both a
username and password must be specified, or they both may be omitted; in
the latter case, the current access level is returned.

     <p>The possible server responses are:

     <p><code>350 (CODE_INFORMATION)</code>
<br>The current access level is specified.

     <p><code>422 (CODE_NO_ACCESS)</code>
<br>A matching username and password could not be found.

     <p><code>200 (CODE_OK)</code>
<br>A matching username and password was found, and the login was
successful.

     <br><dt><code>QUIT</code><dd>Requests that the connection be closed. Possible responses:

     <p><code>201 (CODE_CLOSING)</code>
<br>Normal exit.

     <p>The <code>QUIT</code> command has the dubious distinction of being the only command
that cannot fail.

     <br><dt><code>LIST </code><var>list type</var><dd>Describes various aspects of the database.  The lists are returned as a
list of records, one per line.  Each line may contain a number of
colon-separated fields.

     <p>Possible values for <var>list type</var> include

     <p><code>Categories</code>
<br>Describes the legal categories for the database.

     <p><code>Submitters</code>
<br>Describes the set of submitters for the database.

     <p><code>Responsible</code>
<br>Lists the names in the responsible administrative file, including
their full names and email addresses.

     <p><code>States</code>
<br>Lists the states listed in the state administrative file, including
the state type (usually blank for most states; the closed state has a
special type).

     <p><code>FieldNames</code>
<br>Lists the entire set of PR fields.

     <p><code>InitialInputFields</code>
<br>Lists the fields that <em>should</em> be present when a PR is
initially entered.

     <p><code>InitialRequiredFields</code>
<br>Lists fields that <em>have</em> to be present and nonempty when a PR
is initially entered (fields containing only blank characters such as
spaces or newlines are considered empty.)

     <p><code>Databases</code>
<br>Lists the set of databases.

     <p>The possible responses are:

     <p><code>301 (CODE_TEXT_READY)</code>
<br>Normal response, followed by the records making up the list as
described above.

     <p><code>416 (CODE_INVALID_LIST)</code>
<br>The requested list does not exist.

     <br><dt><code>FTYP </code><var>field</var><code> [</code><var>field</var><code> ...]</code><dd>Describes the type of data held in the field(s) specified with the
command.  The currently defined data types are:

     <p><code>Text</code>
<br>A plain text field, containing exactly one line.

     <p><code>MultiText</code>
<br>A text field possibly containing multiple lines of text.

     <p><code>Enum</code>
<br>An enumerated data field; the value is restricted to one entry out of
a list of values associated with the field.

     <p><code>MultiEnum</code>
<br>The field contains one or more enumerated values.  Values are
separated with spaces or colons <span class="samp">:</span>.

     <p><code>Integer</code>
<br>The field contains an integer value, possibly signed.

     <p><code>Date</code>
<br>The field contains a date.

     <p><code>TextWithRegex</code>
<br>The value in the field must match one or more regular expressions
associated with the field.

     <p>The possible responses are:

     <p><code>350 (CODE_INFORMATION)</code>
<br>The normal response; the supplied text is the data type.

     <p><code>410 (CODE_INVALID_FIELD_NAME)</code>
<br>The specified field does not exist.

     <p>If multiple field names were given, multiple response lines will be
sent, one for each field, using the standard continuation protocol; each
response except the last will have a dash <span class="samp">-</span> immedately after the
response code.

     <br><dt><code>FTYPINFO </code><var>field</var> <var>property</var><dd>
Provides field-type-related information.  Currently, only the property
<span class="samp">separators</span> for MultiEnum fields is supported.  When
<span class="samp">separators</span> is specified, the possible return codes are:

     <p><code>350 (CODE_INFORMATION)</code>
A proper MultiEnum <var>field</var> was specified and the returned text is
the string of separators specified for the field in the dbconfig file
(see <a href="#Field-datatypes">Field datatypes</a>) quoted in <code>'</code>'s.

     <p><code>435 (CODE_INVALID_FTYPE_PROPERTY)</code>
The <span class="samp">separators</span> property is not defined for this field, i.e.  the
specified <var>field</var> is not of type MultiEnum.

     <p>Currently, specifying a different property than <span class="samp">separators</span>
results in return code 435 as above.

     <br><dt><code>FDSC </code><var>field</var><code> [</code><var>field</var><code> ... ]</code><dd>Returns a human-readable description of the listed field(s).  The
possible responses are:

     <p><code>350 (CODE_INFORMATION)</code>
The normal response; the supplied text is the field description.

     <p><code>410 (CODE_INVALID_FIELD_NAME)</code>
The specified field does not exist.

     <p>Like the <code>FVLD</code> command, the standard continuation protocol will be
used if multiple fields were specified with the command.

     <br><dt><code>FIELDFLAGS </code><var>field</var><code> [</code><var>field</var><code> ... ]</code><dd>Returns a set of flags describing the specified field(s).  The possible
responses are either

     <p><code>410 (CODE_INVALID_FIELD_NAME)</code>
<br>meaning that the specified field is invalid or nonexistent, or

     <p><code>350 (CODE_INFORMATION)</code>
<br>which contains the set of flags for the field.  The flags may be
blank, which indicate that no special flags have been set for this
field.

     <p>Like the <code>FDSC</code> and <code>FTYP</code> commands, multiple field names may
be listed with the command, and a response line will be returned for
each one in the order that the fields appear on the command line.

     <p>The flags include:

     <p><code>textsearch</code>
<br>The field will be searched when a text field search is requested.

     <p><code>allowAnyValue</code>
<br>For fields that contain enumerated values, any legal value may be used
in the field, not just ones that appear in the enumerated list.

     <p><code>requireChangeReason</code>
<br>If the field is edited, a reason for the change must be supplied in
the new PR text describing the reason for the change. The reason must be
supplied as a multitext PR field in the new PR whose name is
<code>field-Changed-Why</code> (where <code>field</code> is the name of the field
being edited).

     <p><code>readonly</code>
<br>The field is read-only, and cannot be edited.

     <br><dt><code>FVLD </code><var>field</var><dd><br>Returns one or more regular expressions or strings that describe the
valid types of data that can be placed in field.  Exactly what is
returned is dependent on the type of data that can be stored in the
field.  For most fields a regular expression is returned; for enumerated
fields, the returned values are the list of legal strings that can be
held in the field.

     <p>The possible responses are:

     <p><code>301 (CODE_TEXT_READY)</code>
<br>The normal response, which is followed by the list of regexps or
strings.

     <p><code>410 (CODE_INVALID_FIELD_NAME)</code>
The specified field does not exist.

     <br><dt><code>VFLD </code><var>field</var><dd><code>VFLD</code> can be used to validate a given value for a field in the
database.  The client issues the <code>VFLD</code> command with the name of
the field to validate as an argument.  The server will either respond
with <code>212 (CODE_SEND_TEXT)</code>, or <code>410
(CODE_INVALID_FIELD_NAME)</code> if the specified field does not exist.

     <p>Once the <code>212</code> response is received from the server, the client
should then send the line(s) of text to be validated, using the normal
quoting mechanism described for PRs.  The final line of text is followed
by a line containing a single period, again as when sending PR text.

     <p>The server will then either respond with <code>210 (CODE_OK)</code>,
indicating that the text is acceptable, or one or more error codes
describing the problems with the field contents.

     <br><dt><code>INPUTDEFAULT </code><var>field</var><code> [</code><var>field</var><code> ... ]</code><dd>Returns the suggested default value for a field when a PR is initially
created.  The possible responses are either <code>410
(CODE_INVALID_FIELD_NAME)</code>, meaning that the specified field is invalid
or nonexistent, or <code>350 (CODE_INFORMATION)</code> which contains the
default value for the field.

     <p>Like the <code>FDSC</code> and <code>FTYP</code> commands, multiple field names may
be listed with the command, and a response line will be returned for
each one in the order that the fields appear on the command line.

     <br><dt><code>RSET</code><dd>Used to reset the internal server state.  The current query expression
is cleared, and the index of PRs may be reread if it has been updated
since the start of the session.  The possible responses are:

     <p><code>200 (CODE_OK)</code>
<br>The state has been reset.

     <p><code>440 (CODE_CMD_ERROR)</code>
<br>One or more arguments were supplied to the command.

     <p><code>6xx (internal error)</code>
<br>There were problems resetting the state (usually because the index could
not be reread).  The session will be immediately terminated.

     <br><dt><code>LKDB</code><dd>Locks the main <span class="sc">gnats</span> database.  No subsequent database locks will
succeed until the lock is removed.  Sessions that attempt to write to
the database will fail.  The possible responses are:

     <p><code>200 (CODE_OK)</code>
The lock has been established.

     <p><code>440 (CODE_CMD_ERROR)</code>
One or more arguments were supplied to the command.

     <p><code>431 (CODE_GNATS_LOCKED)</code>
The database is already locked, and the lock could not be obtained after
10 seconds.

     <p><code>6xx (internal error)</code>
An internal error occurred, usually because of permission or other
filesystem-related problems. The lock may or may not have been
established.

     <br><dt><code>UNDB</code><dd>
Unlocks the database.  Any session may steal a database lock; no
checking of any sort is done.  The possible responses are:

     <p><code>200 (CODE_OK)</code>
<br>The lock has been removed.

     <p><code>432 (CODE_GNATS_NOT_LOCKED)</code>
<br>The database was not locked.

     <p><code>440 (CODE_CMD_ERROR)</code>
<br>One or more arguments were supplied to the command.

     <p><code>6xx (internal error)</code>
<br>The database lock could not be removed, usually because of permissions
or other filesystem-related issues.

     <br><dt><code>LOCK </code><var>PR user</var><code> [</code><var>pid</var><code>]</code><dd>Locks the specified <var>PR</var>, marking the lock with the <var>user</var> name
and the optional <var>pid</var>. (No checking is done that the <var>user</var> or
<var>pid</var> arguments are valid or meaningful; they are simply treated as
strings.)

     <p>The <code>EDIT</code> command requires that the PR be locked before it may be
successfully executed.  However, it does not require that the lock is
owned by the editing session, so the usefulness of the lock is simply as
an advisory measure.

     <p>The <code>APPN</code> and <code>REPL</code> commands lock the PR as part of the
editing process, and they do not require that the PR be locked before
they are invoked.

     <p>The possible responses are:

     <p><code>440 (CODE_CMD_ERROR)</code>
<br>Insufficient or too many arguments were specified to the command.

     <p><code>300 (CODE_PR_READY)</code>
<br>The lock was successfully obtained; the text of the PR (using the
standard quoting mechanism for PRs) follows.

     <p><code>400 (CODE_NONEXISTENT_PR)</code>
<br>The PR specified does not exist.

     <p><code>430 (CODE_LOCKED_PR)</code>
<br>The PR is already locked by another session.

     <p><code>6xx (internal error)</code>
<br>The PR lock could not be created, usually because of permissions or
other filesystem-related issues.

     <br><dt><code>UNLK </code><var>PR</var><dd>Unlocks <var>PR</var>.  Any user may unlock a PR, as no checking is done to
determine if the requesting session owns the lock.

     <p>The possible responses are:

     <p><code>440 (CODE_CMD_ERROR)</code>
<br>Insufficient or too many arguments were specified to the command.

     <p><code>200 (CODE_OK)</code>
<br>The PR was successfully unlocked.

     <p><code>433 (CODE_PR_NOT_LOCKED)</code>
<br>The PR was not locked.

     <p><code>6xx (internal error)</code>
<br>The PR could not be unlocked, usually because of permission or other
filesystem-related problems.

     <br><dt><code>DELETE </code><var>PR</var><dd>Deletes the specified <var>PR</var>. The user making the request must have
admin privileges (see <a href="#Access-Control">Controlling access to databases</a>).  If successful, the PR is removed from the filesystem and
the index file; a gap will be left in the numbering sequence for PRs. 
No checks are made that the PR is closed.

     <p>The possible responses are:

     <p><code>200 (CODE_OK)</code>
<br>The PR was successfully deleted.

     <p><code>422 (CODE_NO_ACCESS)</code>
<br>The user requesting the delete does not have admin privileges.

     <p><code>430 (CODE_LOCKED_PR)</code>
<br>The PR is locked by another session.

     <p><code>431 (CODE_GNATS_LOCKED)</code>
<br>The database has been locked, and no PRs may be updated until the lock
is cleared.

     <p><code>6xx (internal error)</code>
<br>The PR could not be successfully deleted, usually because of
permission or other filesystem-related problems.

     <br><dt><code>CHEK [initial]</code><dd>Used to check the text of an entire PR for errors.  Unlike the
<code>VFLD</code> command, it accepts an entire PR at once instead of the
contents of an individual field.

     <p>The <code>initial</code> argument indicates that the PR text to be checked is
for a PR that will be newly created, rather than an edit or replacement
of an existing PR.

     <p>After the <code>CHEK</code> command is issued, the server will respond with
either a <code>440 (CODE_CMD_ERROR)</code> response indicating that the
command arguments were incorrect, or a <code>211 (CODE_SEND_PR)</code>
response code will be sent.

     <p>Once the <code>211</code> response is received from the server, the client
should send the PR using the normal PR quoting mechanism; the final line
of the PR is then followed by a line containing a single period, as
usual.

     <p>The server will then respond with either a <code>200 (CODE_OK)</code>
response, indicating there were no problems with the supplied text, or
one or more error codes listing the problems with the PR.

     <br><dt><code>EDIT </code><var>PR</var><dd>Verifies the replacement text for <var>PR</var>.  If the command is
successful, the contents of <var>PR</var> are completely replaced with the
supplied text.  The PR must previously have been locked with the
<code>LOCK</code> command.

     <p>The possible responses are:

     <p><code>431 (CODE_GNATS_LOCKED)</code>
<br>The database has been locked, and no PRs may be updated until the lock
is cleared.

     <p><code>433 (CODE_PR_NOT_LOCKED)</code>
<br>The PR was not previously locked with the <code>LOCK</code> command.

     <p><code>400 (CODE_NONEXISTENT_PR)</code>
<br>The specified PR does not currently exist.  The <code>SUBM</code> command
should be used to create new PRs.

     <p><code>211 (CODE_SEND_PR)</code>
<br>The client should now transmit the replacement PR text using the
normal PR quoting mechanism.  After the PR has been sent, the server
will respond with either <code>200 (CODE_OK)</code> indicating that the edit
was successful, or one or more error codes listing problems either with
the replacement PR text or errors encountered while updating the PR file
or index.

     <br><dt><code>EDITADDR </code><var>address</var><dd>Sets the e-mail address of the person communicating with
<code>gnatsd</code>.  The command requires at least the <code>edit</code> access
level.

     <p>The possible responses are:

     <p><code>200 (CODE_OK)</code>
<br>The address was successfully set.

     <p><code>440 (CODE_CMD_ERROR)</code>
<br>Invalid number of arguments were supplied.

     <br><dt><code>APPN </code><var>PR</var> <var>field</var><dt><code>REPL </code><var>PR</var> <var>field</var><dd>Appends to or replaces the contents of <var>field</var> in <var>PR</var> with the
supplied text.  The command returns a <code>201 (CODE_SEND_TEXT)</code>
response; the client should then transmit the new field contents using
the standard PR quoting mechanism.  After the server has read the new
contents, it then attempts to make the requested change to the PR.

     <p>The possible responses are:

     <p><code>200 (CODE_OK)</code>
<br>The PR field was successfully changed.

     <p><code>400 (CODE_NONEXISTENT_PR)</code>
<br>The PR specified does not exist.

     <p><code>410 (CODE_INVALID_FIELD_NAME)</code>
<br>The specified field does not exist.

     <p><code>402 (CODE_UNREADABLE_PR)</code>
<br>The PR could not be read.

     <p><code>431 (CODE_GNATS_LOCKED)</code>
<br>The database has been locked, and no PRs may be updated until the lock
is cleared.

     <p><code>430 (CODE_LOCKED_PR)</code>
<br>The PR is locked, and may not be altered until the lock is cleared.

     <p><code>413 (CODE_INVALID_FIELD_CONTENTS)</code>
<br>The supplied (or resulting) field contents are not valid for the
field.

     <p><code>6xx (internal error)</code>
<br>An internal error occurred, usually because of permission or other
filesystem-related problems.  The PR may or may not have been altered.

     <br><dt><code>SUBM</code><dd>Submits a new PR into the database.  The supplied text is verified for
correctness, and if no problems are found a new PR is created.

     <p>The possible responses are:

     <p><code>431 (CODE_GNATS_LOCKED)</code>
<br>The database has been locked, and no PRs may be submitted until the
lock is cleared.

     <p><code>211 (CODE_SEND_PR)</code>
<br>The client should now transmit the new PR text using the normal
quoting mechanism.  After the PR has been sent, the server will respond
with either <code>351 (CODE_INFORMATION_FILLER)</code> and
<code>350 (CODE_INFORMATION)</code> responses indicating that the new PR
has been created and supplying the number assigned to it, or one or
more error codes listing problems with the new PR text.

     <br><dt><code>CHDB </code><var>database</var><dd>Switches the current database to the name specified in the command.

     <p>The possible responses are:

     <p><code>422 (CODE_NO_ACCESS)</code>
<br>The user does not have permission to access the requested database.

     <p><code>417 (CODE_INVALID_DATABASE)</code>
<br>The database specified does not exist, or one or more configuration
errors in the database were encountered.

     <p><code>220 (CODE_OK)</code>
<br>The current database is now <var>database</var>.  Any operations performed
will now be applied to <var>database</var>.

     <br><dt><code>DBLS</code><dd>Lists the known set of databases.

     <p>The possible responses are:

     <p><code>6xx (internal error)</code>
<br>An internal error was encountered while trying to obtain the list of
available databases, usually due to lack of permissions or other
filesystem-related problems, or the list of databases is empty.

     <p><code>301 (CODE_TEXT_READY)</code>
<br>The list of databases follows, one per line, using the standard
quoting mechanism.  Only the database names are sent.

     <p>The <code>gnatsd</code> access level <span class="samp">listdb</span> denies access until the
user has authenticated with the USER command.  The only other command
available at this access level is <code>DBLS</code>.  This access level
provides a way for a site to secure its <span class="sc">gnats</span> databases while still
providing a way for client tools to obtain a list of the databases for
use on login screens etc.  See <a href="#Access-Control">Controlling access to databases</a>.

     <br><dt><code>DBDESC </code><var>database</var><dd>Returns a human-readable description of the specified <var>database</var>.

     <p>Responses include:

     <p><code>6xx (internal error)</code>
<br>An internal error was encountered while trying to read the list of
available databases, usually due to lack of permissions or other
filesystem-related problems, or the list of databases is empty.

     <p><code>350 (CODE_INFORMATION)</code>
<br>The normal response; the supplied text is the database description.

     <p><code>417 (CODE_INVALID_DATABASE)</code>
<br>The specified database name does not have an entry.

     <br><dt><code>EXPR </code><var>query expression</var><dd>Specifies a <var>query expression</var> used to limit which PRs are returned
from the <code>QUER</code> command.  The expression uses the normal query
expression syntax, (see <a href="#Query-expressions">Query expressions</a>).

     <p>Multiple <code>EXPR</code> commands may be issued; the expressions are boolean
ANDed together.

     <p>Expressions are cleared by the <code>RSET</code> command.

     <p>Possible responses include:

     <p><code>415 (CODE_INVALID_EXPR)</code>
<br>The specified expression is invalid, and could not be parsed.

     <p><code>200 (CODE_OK)</code>
<br>The expression has been accepted and will be used to limit the
results returned from <code>QUER</code>.

     <br><dt><code>QFMT </code><var>query format</var><dd>Use the specified <var>query format</var> to format the output of the
<code>QUER</code> command.  The query format may be either the name of a query
format known to the server (see <a href="#Named-query-definitions">Named query definitions</a>), or an
actual query format (see <a href="#Formatting-query_002dpr-output">Formatting query-pr output</a>).  The possible
responses are:

     <p><code>200 (CODE_OK)</code>
<br>The normal response, which indicates that the query format is
acceptable.

     <p><code>440 (CODE_CMD_ERROR)</code>
<br>No query format was supplied.

     <p><code>418 (CODE_INVALID_QUERY_FORMAT)</code>
<br>The specified query format does not exist, or could not be parsed.

     <br><dt><code>QUER [</code><var>PR</var><code>] [</code><var>PR</var><code>] [...]</code><dd>Searches the contents of the database for PRs that match the
(optional) specified expressions with the <code>EXPR</code> command. If no
expressions were specified with <code>EXPR</code>, the entire set of PRs is
returned.

     <p>If one or more PRs are specified on the command line, only those PRs
will be searched and/or output.

     <p>The format of the output from the command is determined by the query
format selected with the <code>QFMT</code> command.

     <p>The possible responses are:

     <p><code>418 (CODE_INVALID_QUERY_FORMAT)</code>
<br>A valid format was not specified with the <code>QFMT</code> command prior to
invoking <code>QUER</code>.

     <p><code>300 (CODE_PR_READY)</code>
<br>One or more PRs will be output using the requested query format. The
PR text is quoted using the normal quoting mechanisms for PRs.

     <p><code>220 (CODE_NO_PRS_MATCHED)</code>
<br>No PRs met the specified criteria.

     <br><dt><code>ADMV </code><var>field key</var><code> [</code><var>subfield</var><code>]</code><dd>Returns an entry from an administrative data file associated with
<var>field</var>. <var>key</var> is used to look up the entry in the data file. If
<var>subfield</var> is specified, only the value of that subfield is
returned; otherwise, all of the fields in the adm data file are
returned, separated by colons <span class="samp">:</span>.

     <p>The responses are:

     <p><code>410 (CODE_INVALID_FIELD_NAME)</code>
The specified field does not exist.

     <p><code>221 (CODE_NO_ADM_ENTRY)</code>
An adm entry matching the key was not found, or the field does not have
an adm file associated with it.

     <p><code>350 (CODE_INFORMATION)</code>
The normal response; the supplied text is the requested field(s). 
</dl>

<div class="node">
<p><hr>
<a name="gnatsd-environment-variables"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnatsd-commands">gnatsd commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#gnatsd">gnatsd</a>
<br>
</div>

<h3 class="section">B.5 <code>gnatsd</code> environment variables</h3>

<p><a name="index-_0040code_007bgnatsd_007d-environment-variables-380"></a><a name="index-_0040code_007bGNATSDB_007d-381"></a>
<code>gnatsd</code> supports the <code>GNATSDB</code> environment varable,
See <a href="#Environment">Environment</a>, in almost the same way as the <span class="sc">gnats</span> tools do. 
This variable is used to determine which database to use.  For a local
database, it contains the name of the database to
access. <code>gnatsd</code> cannot service remote databases (though it might
be interesting if it could) so the database is always assumed to be
local.

   <p>If <code>GNATSDB</code> is not set and the <code>--database</code> option is not
supplied, it is assumed that the database is local and that its name is
<span class="samp">default</span>.

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Access-Control"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Regexps">Regexps</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnatsd">gnatsd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix C Controlling access to databases</h2>

<ul class="menu">
<li><a accesskey="1" href="#Overview">Overview</a>
<li><a accesskey="2" href="#Overall-gnatsd-access-level">Overall gnatsd access level</a>
<li><a accesskey="3" href="#gnatsd_002ehost_005faccess">gnatsd.host_access</a>:            Per-host access settings
<li><a accesskey="4" href="#gnatsd_002euser_005faccess">gnatsd.user_access</a>:            Access levels per user
<li><a accesskey="5" href="#Privileged-gnatsd-commands">Privileged gnatsd commands</a>
</ul>

<div class="node">
<p><hr>
<a name="Overview"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Overall-gnatsd-access-level">Overall gnatsd access level</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Access-Control">Access Control</a>
<br>
</div>

<h3 class="section">C.1 Overview</h3>

<p><span class="sc">gnats</span> supports granting various levels of access to the <span class="sc">gnats</span>
databases served by the network daemon, <code>gnatsd</code>.

   <p><span class="sc">gnats</span> access can be controlled at these levels:

     <dl>
<dt><code>deny</code><dd>gnatsd closes the connection

     <br><dt><code>none</code><dd>no further access until userid and password given

     <br><dt><code>listdb</code><dd>only listing of available databases is allowed

     <br><dt><code>view</code><dd>query and view PRs with Confidential=no only

     <br><dt><code>viewconf</code><dd>query and view PRs with Confidential=yes

     <br><dt><code>edit</code><dd>full edit access

     <br><dt><code>admin</code><dd>full admin access
</dl>

<p class="noindent">These access levels are used in the following settings:

     <ul>
<li>overall gnatsd access level

     <li>overall access level set by host name or IP address

     <li>overall access level set by userid and password

     <li>per-database access level set by userid and password
</ul>

<div class="node">
<p><hr>
<a name="Overall-gnatsd-access-level"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd_002ehost_005faccess">gnatsd.host_access</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Overview">Overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Access-Control">Access Control</a>
<br>
</div>

<h3 class="section">C.2 Overall <code>gnatsd</code> access level</h3>

<p class="noindent">The overall <code>gnatsd</code> access level is set by starting <code>gnatsd</code>
with the option

<pre class="example">     <code>-m</code> <var>level</var> or <code>--maximum-access-level</code>=<var>level</var>,
</pre>
   <p class="noindent">where <var>level</var> is one of the six access levels listed
above.  This restricts any access to the <span class="sc">gnats</span> daemon to levels up
to and including <var>level</var>, regardless of the settings in the access
control files discussed below.  If this option is left out, any access
levels set in the access control files will be allowed.

   <p>The discussion below assumes that the pre-build configure of <span class="sc">gnats</span>
was done without altering the default values for the
<code>--enable-gnatsd-user-access-file</code> and
<code>--enable-gnatsd-host-access-file</code> options.  If non-default values
were given, substitute as appropriate below.

<div class="node">
<p><hr>
<a name="gnatsd_002ehost_005faccess"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#gnatsd_002euser_005faccess">gnatsd.user_access</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Overall-gnatsd-access-level">Overall gnatsd access level</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Access-Control">Access Control</a>
<br>
</div>

<h3 class="section">C.3 Overall access levels per host</h3>

<p><a name="index-_0040file_007bgnatsd_002ehost_005faccess_007d-382"></a>
The host access file (by default
<span class="file">/usr/local/etc/gnats/gnatsd.host_access</span>) controls overall
access levels on a per-host basis, meaning that settings in this file
apply across all databases on the server.  Entries in this file are in
the following format:

   <p><var>host:access-level:whatever</var>

<p class="noindent"><var>host</var> is the hostname or IP address of the host contacting
gnatsd.  Wildcard characters are supported: <span class="samp">*</span> matches anything;
<span class="samp">?</span> matches any single character.  By using wildcards, you can
specify access levels for entire network subnets and domains.  Note
that when <span class="sc">gnats</span> authenticates hosts, it reads the entries in this
file in sequence until a match is found.  This means that wildcard
entries must be placed near the end of the file, otherwise, they
will override non-wildcard entries appearing after the wildcard
ones.

   <p>The second field is the access level of <var>host</var>.  The default is
<code>deny</code>.  If the user's hostname isn't in the file or its access
level is set to <code>deny</code>, the connection is closed immediately.

   <p><span class="sc">gnats</span> currently doesn't make use of the third field. Remember to
still include the second <span class="samp">:</span> on the line if you choose to leave the third
field empty.

   <p>Whenever a <code>CHDB</code> command is processed (or defaulted), the user's
access level is set to the level for their host, as determined by the
values in the <span class="file">gnatsd.host_access</span> file.  However, even if a host
is given the <code>none</code> access level, an individual can still give the
<code>USER</code> command to possibly gain a higher (but never lower) access
than is set for their host.  The gnatsd <code>USER</code> command takes two
arguments: <code>USER &lt;userid&gt; &lt;passwd&gt;</code>.

<div class="node">
<p><hr>
<a name="gnatsd_002euser_005faccess"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Privileged-gnatsd-commands">Privileged gnatsd commands</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnatsd_002ehost_005faccess">gnatsd.host_access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Access-Control">Access Control</a>
<br>
</div>

<h3 class="section">C.4 Access levels per user</h3>

<p><a name="index-_0040file_007bgnatsd_002euser_005faccess_007d-383"></a>
Access levels per user can be set both across all databases on the
server or on a per-database basis.  The <span class="file">gnatsd.user_access</span> file
in a database's <span class="file">gnats-adm</span> directory specifies the user access
rules for that database.  If it doesn't exist, or doesn't contain the
user name given to <code>gnatsd</code>, then the overall user access file
(by default <span class="file">/usr/local/etc/gnats/gnatsd.user_access</span><!-- /@w -->)
specifying the per-user access levels across all the databases on the
server is checked.

   <p>The user access files can only <em>increase</em> the access level
defined in the host access files for the given host, they can never
lower it.

   <p>If the access level is <code>none</code> after processing the userid and
password, the connection is closed.

   <p>The <span class="file">gnatsd.user_access</span> files can contain plain text passwords, in
such a case they should be owned by the <span class="sc">gnats</span> user with file
permission 600.

   <p>Wildcard characters are supported for the userid and password with
plain text passwords.  A null string or <span class="samp">*</span> matches anything;
<span class="samp">?</span> matches any one character.  Note that when <span class="sc">gnats</span>
authenticates users, it reads the entries in this file in sequence
until a match is found.  This means that wildcard entries must be
placed near the end of the file, otherwise, they will override
non-wildcard entries appearing after the wildcard ones.

   <p>Entries in the database-specific <span class="file">gnatsd.user_access</span> user access file
in the <span class="file">gnats-adm</span> directory of the database have the following
general format:

   <p><var>userid:password:access-level</var>

   <p>The overall <span class="file">gnatsd.user_access</span> user access file adds a fourth
<var>databases</var> field:

   <p><var>userid:password:access-level:databases</var>

<p class="noindent"><var>password</var> should either be in plain text, DES
<code>crypt()</code><a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a> or MD5 hash format<a rel="footnote" href="#fn-5" name="fnd-5"><sup>5</sup></a>.

   <p>If the password is in plain text format, it must be prefixed by
<span class="samp">$0$</span> and if it is in MD5 format, it needs to be prefixed by the
string <span class="samp">$1$</span>.<a rel="footnote" href="#fn-6" name="fnd-6"><sup>6</sup></a> Passwords encrypted by <code>crypt()</code> should have no
prefix. If no password is given then users can login with an empty
password string.

   <p>A <code>gnats-passwd</code> tool to manage <span class="file">gnatsd.user_access</span> files is
planned.  In the meantime, <code>crypt()</code> passwords can be generated by
using standard UNIX passwords tools, while MD5 passwords can be
generated with the following little Perl snippet:

<pre class="example">     perl -e 'use Crypt::PasswdMD5 ; print Crypt::PasswdMD5::unix_md5_crypt
     "<var>password</var>" , time() % 100000000'
</pre>
   <p class="noindent">If your Perl installation doesn't have the Crypt module
installed, you need to install it.  On most systems, the following
command achieves this:

<pre class="example">     perl -MCPAN -e 'install Crypt::PasswdMD5'
</pre>
   <p>A tool for conversion of pre-version 4 <span class="file">gnatsd.user_access</span> files is
distributed with <span class="sc">gnats</span> 4.  See <a href="#gnats_002dpwconv">Converting old password files</a>.

<p class="noindent">The <var>access-level</var> field should contain one of the values listed at
the beginning of this appendix.  This overrides (increases but never
lowers) the access level given as the default for the user's host in the
global gnatsd.host_access file.

   <p>The following shows an example <span class="file">gnatsd.user_access</span> file with
plain text passwords:

<pre class="example">     rickm:$0$ruckm:edit
     pablo:$0$pueblo:view
     *::none
</pre>
   <p class="noindent">And this is the same file with MD5-encrypted passwords:
<pre class="example">     rickm:$1$92388613$D7ZIYikzTUqd./dODTFrI.:edit
     pablo:$1$92388652$QRfAhIBG5elT.FQjQKhj80:view
     *::none
</pre>
   <p class="noindent">In these examples, anybody other than rickm and pablo get
denied access, assuming that the host access level is also <code>none</code>. 
You could set the catch-all rule at the end to be <code>*::view</code> to
allow view access to anyone who does not supply a password.  Note the
important detail that such a rule would allow view access only to
persons who do not supply a password at all, i.e. if rickm or pablo tries
to log in but mistypes his password, this rule would not apply and
they would be denied access entirely.  This is by design, since people
might be surprised if they suddenly found themselves logged in, but with
a lower access level than they usually have.

   <p>The <var>databases</var> field contains a comma-separated list of database
names, as defined in the <span class="file">databases</span> file (see <a href="#databases-file">The <code>databases</code> file</a>.  Wildcard characters are
supported. The databases listed in this field are the ones to which
the other settings on the same line will be applied.

<div class="node">
<p><hr>
<a name="Privileged-gnatsd-commands"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#gnatsd_002euser_005faccess">gnatsd.user_access</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Access-Control">Access Control</a>
<br>
</div>

<h3 class="section">C.5 Privileged <code>gnatsd</code> commands</h3>

<p>Every <code>gnatsd</code> command has a minimum access level attached to
it.  If your access level is too low for a command, you get this
response:

<pre class="example">       LOCK 12
       422 You are not authorized to perform this operation (LOCK).
</pre>
   <p class="noindent">The commands <code>CHDB</code>, <code>USER</code> and <code>QUIT</code> are
unrestricted.

<p class="noindent">The <code>DBLS</code> command requires at least <code>listdb</code> access.

<p class="noindent">A user must have at least <code>edit</code> access for these commands:

     <dl>
<dt><code>LKDB</code><dd>lock the main <span class="sc">gnats</span> database.

     <br><dt><code>UNDB</code><dd>unlock the main <span class="sc">gnats</span> database.

     <br><dt><code>LOCK </code><var>PR user pid</var><dd>lock <var>PR</var> for <var>user</var> and optional <var>pid</var> and return PR text.

     <br><dt><code>UNLK </code><var>PR</var><dd>unlock <var>PR</var>.

     <br><dt><code>EDIT </code><var>PR</var><dd>check in edited <var>PR</var>.

     <br><dt><code>APPN </code><var>PR</var> <var>field</var><code>, REPL </code><var>PR</var> <var>field</var><dd>Appends to or replaces the contents of <var>field</var> in <var>PR</var>. 
</dl>

   <p>The <code>DELETE</code> <var>PR</var> command is special in that it requires
<code>admin</code> access.

<p class="noindent">All other commands require <code>view</code> access.

   <p><code>edit-pr</code> and <code>query-pr</code> accept the command line arguments
<code>-v|--user</code> and <code>-w|--passwd</code>.  See <a href="#GNATS-user-tools">The <span class="sc">gnats</span> User Tools</a>.

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Regexps"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#dbconfig-recipes">dbconfig recipes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Access-Control">Access Control</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix D Querying using regular expressions</h2>

<p><a name="index-querying-using-regexps-384"></a><a name="index-regular-expressions-385"></a><a name="index-syntax-of-regexps-386"></a>
See also <a href="#Query-expressions">Query expressions</a>.

   <p>Unfortunately, we do not have room in this manual for a complete
exposition on regular expressions.  The following is a basic summary of
some regular expressions you might wish to use.

   <p><em>NOTE: When you use query expressions containing regular
expressions as part of an ordinary query-pr shell command line, you need
to quote them with </em><code>''</code><em>, otherwise the shell will try to interpret
the special characters used, yielding highly unpredictable results.</em>

   <p>See <a href="regex.html#Regular-Expression-Syntax">Regular Expression Syntax (Regex)</a>,
for details on regular expression syntax.  Also see <a href="emacs.html#Regexps">Syntax of Regular Expressions (GNU Emacs Manual)</a>, but beware that the
syntax for regular expressions in Emacs is slightly different.

   <p>All search criteria options to <code>query-pr</code> rely on regular
expression syntax to construct their search patterns.  For example,

<pre class="smallexample">     query-pr --expr 'State="open"' --format full
</pre>
   <p class="noindent">matches all PRs whose <code>State</code> values match with the regular
expression <span class="samp">open</span>.

   <p>We can substitute the expression <span class="samp">o</span> for <span class="samp">open</span>, according
to <span class="sc">gnu</span> regular expression syntax.  This matches all values of
<code>State</code> which begin with the letter <span class="samp">o</span>.

   <p>We see that

<pre class="smallexample">     query-pr --expr 'State="o"' --format full
</pre>
   <p>is equivalent to

<pre class="smallexample">     query-pr --expr 'State="open"' --format full
</pre>
   <p class="noindent">in this case, since the only value for <code>State</code> which matches
the expression <span class="samp">o</span> in a standard installation is <span class="samp">open</span>. 
<span class="samp">State="o"</span> also matches <span class="samp">o</span>, <span class="samp">oswald</span>, and even
<span class="samp">oooooo</span>, but none of those values are valid states for a Problem
Report in default <span class="sc">gnats</span> installations.

   <p>We can also use the expression operator <span class="samp">|</span> to signify a logical
<code>OR</code>, such that

<pre class="smallexample">     query-pr --expr 'State="o|a"' --format full
</pre>
   <p class="noindent">matches all <span class="samp">open</span> or <span class="samp">analyzed</span> Problem Reports.

   <p>Regular expression syntax considers a regexp token surrounded with
parentheses, as in <span class="samp">(</span><var>regexp</var><span class="samp">)</span><!-- /@w -->, to be a <dfn>group</dfn>.  This
means that <span class="samp">(ab)*</span><!-- /@w --> matches any number (including zero) of
contiguous instances of <span class="samp">ab</span>.  Matches include , <span class="samp">ab</span>,
and <span class="samp">ababab</span>.

   <p>Regular expression syntax considers a regexp token surrounded with
square brackets, as in <span class="samp">[</span><var>regexp</var><span class="samp">]</span><!-- /@w -->, to be a <dfn>list</dfn>. 
This means that <span class="samp">Char[(ley)(lene)(broiled)</span><!-- /@w --> matches any of the
words <span class="samp">Charley</span>, <span class="samp">Charlene</span>, or <span class="samp">Charbroiled</span> (case is
significant; <span class="samp">charbroiled</span> is not matched).

   <p>Using groups and lists, we see that

<pre class="smallexample">     query-pr --expr 'Category="gcc|gdb|gas"' --format full
</pre>
   <p class="noindent">is equivalent to

<pre class="smallexample">     query-pr --expr 'Category="g(cc|db|as)"' --format full
</pre>
   <p class="noindent">and is also very similar to

<pre class="smallexample">     query-pr --expr 'Category="g[cda]"' --format full
</pre>
   <p class="noindent">with the exception that this last search matches any values which begin
with <span class="samp">gc</span>, <span class="samp">gd</span>, or <span class="samp">ga</span>.

   <p>The <span class="samp">.</span> character is known as a <dfn>wildcard</dfn>.  <span class="samp">.</span> matches
on any single character.  <span class="samp">*</span> matches the previous character
(except newlines), list, or group any number of times, including zero. 
Therefore, we can understand <span class="samp">.*</span> to mean &ldquo;match zero or more
instances of any character.&rdquo;

<pre class="smallexample">     query-pr --expr 'State=".*a"' --format full
</pre>
   <p class="noindent">matches all values for <code>State</code> which contain an <span class="samp">a</span>.  (These
include <span class="samp">analyzed</span> and <span class="samp">feedback</span>.)

   <p>Another way to understand what wildcards do is to follow them on their
search for matching text.  By our syntax, <span class="samp">.*</span> matches any
character any number of times, including zero.  Therefore, <span class="samp">.*a</span>
searches for any group of characters which end with <span class="samp">a</span>, ignoring
the rest of the field.  <span class="samp">.*a</span> matches <span class="samp">analyzed</span> (stopping at
the first <span class="samp">a</span>) as well as <span class="samp">feedback</span>.

   <p><em>Note:</em> When using <span class="samp">fieldtype:Text</span> or
<span class="samp">fieldtype:Multitext</span> (see <a href="#Query-expressions">Query expressions</a>), you do not have
to specify the token <span class="samp">.*</span> at the beginning of your expression to
match the entire field.  For the technically minded, this is because
these queries use <span class="samp">re_search</span> rather than <span class="samp">re_match</span>. 
<span class="samp">re_match</span> <dfn>anchors</dfn> the search at the beginning of the field,
while <span class="samp">re_search</span> does not anchor the search.

   <p>For example, to search in the <code>&gt;Description:</code> field for the text

<pre class="smallexample">     The defrobulator component returns a nil value.
</pre>
   <p class="noindent">we can use

<pre class="smallexample">     query-pr --expr 'fieldtype:Multitext="defrobulator.*nil"' --format full
</pre>
   <p>To also match newlines, we have to include the expression <span class="samp">(.|^M)</span>
instead of just a dot (<span class="samp">.</span>).  <span class="samp">(.|^M)</span> matches &ldquo;any single
character except a newline (<span class="samp">.</span>) <em>or</em> (<span class="samp">|</span>) any newline
(<span class="samp">^M</span>).&rdquo;  This means that to search for the text

<pre class="smallexample">     The defrobulator component enters the bifrabulator routine
     and returns a nil value.
</pre>
   <p class="noindent">we must use

<pre class="smallexample">     query-pr --expr 'fieldtype:Multitext="defrobulator(.|^M)*nil"'
              --format full
</pre>
   <p>To generate the newline character <span class="samp">^M</span>, type the following
depending on your shell:

     <dl>
<dt><code>csh</code><dd><em>control</em><span class="samp">-V </span><em>control</em><span class="samp">-M</span>

     <br><dt><code>tcsh</code><dd><em>control</em><span class="samp">-V </span><em>control</em><span class="samp">-J</span>

     <br><dt><code>sh (</code><em>or</em><code> bash)</code><dd>Use the &lt;RETURN&gt; key, as in

     <pre class="smallexample">          (.|
          )
     </pre>
     </dl>

   <p>Again, see <a href="regex.html#Regular-Expression-Syntax">Regular Expression Syntax (Regex)</a>, for a much more complete discussion on regular
expression syntax.

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="dbconfig-recipes"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Support">Support</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Regexps">Regexps</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix E <span class="file">dbconfig</span> recipes</h2>

<p><a name="index-dbconfig-387"></a><a name="index-_0040file_007bdbconfig_007d-recipes-388"></a>
The <span class="file">dbconfig</span> file (<a href="#dbconfig-file">The <span class="file">dbconfig</span> file</a>) is the heart of any <span class="sc">gnats</span> installation.  It contains some
very powerful machinery, something which this appendix tries to
illustrate.

   <p>We provide a range of examples that are both intended to be useful in
their own right and to serve as starting points or building blocks for
your own modifications.

<h5 class="subsubheading">Provide Gnatsweb URL in initial response</h5>

<p>Sites that have Gnatsweb installed may wish to modify the response
e-mail which is sent to the submitter of a PR so that it includes a
URL where the status of the PR can be monitored.  In order to allow
this, you should first create an entry in <span class="file">gnatsd.user_access</span>
which allows viewing of PRs in your database
(See <a href="#gnatsd_002euser_005faccess">The <span class="file">gnatsd.user_access</span> file</a>.)

   <p>Next, locate the entry <code>mail-format
"initial-response-to-submitter"</code> in the <span class="file">dbconfig</span> file of your
database and add the following <em>before</em> the line reading &ldquo;The
individual assigned...&rdquo; in the <code>body</code> section:

<pre class="verbatim">
\nYou can follow the status of this report on\n\
http://hostname/cgi-bin/scriptname?\n\
cmd=view&amp;database=dbname&amp;user=username&amp;\n\
password=passwd&amp;pr=%s\n\n\
</pre>

<p class="noindent">Substitute <code>hostname</code>, <code>cgi-bin</code> and <code>scriptname</code> as
appropriate for the setup of your web server.  The part before the
<span class="samp">?</span> would typically look something like
<code>http://www.example.com/cgi-bin/gnatsweb.pl</code>.  Substitute the
name of your database for <code>dbname</code>, and the username and password
of the user with <code>view</code> rights for <code>username</code> and
<code>passwd</code>.

<p class="noindent">Next, add a <code>Number</code> to the <code>fields</code> list statement inside
the <code>body</code> so it reads as follows:

<pre class="verbatim">
fields { "Category" "Number" "Number" "Responsible"
         "Category" "Responsible" "Synopsis"
         "Arrival-Date" }
</pre>

<h5 class="subsubheading">State full name of responsible in initial response</h5>

<p>The initial e-mail response to the submitter of a PR identifies the
responsible person assigned to the PR as follows: &ldquo;The individual
assigned to look at your report is: <var>GNATS username</var>&rdquo;.  Some
sites may wish to modify this so that the full name of the responsible
person is used instead of the <span class="sc">gnats</span> user name.

   <p>The full name is contained in the <code>fullname</code> subfield of the
user's entry in the <span class="file">responsible</span> file and can be accessed as
<code>Responsible[fullname]</code> (see <a href="#administrative-files">Enumerated field administrative files</a>.)

   <p>The change is achieved by editing the <span class="file">dbconfig</span> item
<code>mail-format "initial-response-to-submitter"</code> and changing the
<code>fields</code> part of the <code>Body</code> from

<pre class="verbatim">
fields { "Category" "Number" "Responsible"
         "Category" "Responsible" "Synopsis"
         "Arrival-Date" }
</pre>

<p class="noindent">to

<pre class="verbatim">
fields { "Category" "Number" "Responsible[fullname]"
         "Category" "Responsible" "Synopsis"
         "Arrival-Date" }
</pre>

<h5 class="subsubheading">Append-only Audit-Trail</h5>

<p>The Audit-Trail of a PR is by default editable.  For some
applications, one might want to make the Audit-Trail append-only, so
it provides a full and unchangeable case history.  Also by default,
only certain changes, such as change of state and change of
responsible gets recorded in the Audit-Trail.  In some cases, it might
also be convenient to have a way of inserting comments directly into
the Audit-Trail.

   <p>The following procedure creates such an append-only Audit-Trail and
adds a PR field which makes it possible to register comments in the
Audit-Trail.

<p class="noindent">First, add the keyword <code>read-only</code> to the Audit-Trail field
definition in <span class="file">dbconfig</span>.

<p class="noindent">Then, add the following field definition to <span class="file">dbconfig</span>:

<pre class="verbatim">
field "Add-To-Audit-Trail" {
   description "Add a log entry to the Audit Trail"
   multitext { default "\n" }
   on-change  {
        add-audit-trail
        audit-trail-format {
        format "**** Comment added by %s on %s ****\n %s\n\n"
        fields { "$EditUserEmailAddr" "$CurrentDate" "$NewValue"
        }
        }
    }
    on-change {
        set-field "Add-To-Audit-Trail" { "\n" }
    }
}
</pre>

   <p><a name="release_002dbased-support"></a>

<h5 class="subsubheading">Supporting <span class="sc">gnats</span> &ldquo;release-based&rdquo; fields</h5>

<p>When installing <span class="sc">gnats</span> version 3.x, it was possible to choose
whether to enable three optional fields: <code>Quarter</code>, <code>Keywords</code>
and <code>Date-Required</code>.  Default installations had these fields
switched off, and installations which had them were called
&ldquo;release-based&rdquo;.

   <p>The default <span class="file">dbconfig</span> shipped with <span class="sc">gnats</span> version 4 or newer
does not have these fields, so if you are upgrading from an old
release-based system, you need to add the following field definitions to
your <span class="file">dbconfig</span> file:

<pre class="verbatim">
field "Quarter" {
    description "What quarter does the PR fall into?"
    text
    query-default inexact-regexp
    textsearch
}

field "Keywords" {
    description "Keywords used to index this PR"
    text
    query-default inexact-regexp
    textsearch
}

field "Date-Required" {
    description "Date that the PR must be fixed by"
    date
}
</pre>

   <p>A side note: Pre-release versions of <span class="sc">gnats</span> 4 also had a field
named <code>Cases</code>.  For those who may need it, here is the field
definition of <code>Cases</code>:

<pre class="verbatim">
field "Cases" {
    text
    query-default inexact-regexp
    textsearch
}
</pre>
<!-- =============================================================== -->

<div class="node">
<p><hr>
<a name="Support"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Index">Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dbconfig-recipes">dbconfig recipes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix F <span class="sc">gnats</span> support</h2>

<p><a name="index-_0040sc_007bgnats_007d-support-389"></a>The <span class="sc">gnats</span> home page is located at
<a href="http://www.gnu.org/software/gnats">http://www.gnu.org/software/gnats</a>.  It contains all the
important references to the available information about <span class="sc">gnats</span> and
the related software.

   <p>There is also a special page dedicated to the <span class="sc">gnats</span> development
at <a href="http://savannah.gnu.org/projects/gnats">http://savannah.gnu.org/projects/gnats</a>.

   <p><a name="index-mailing-lists-390"></a>There are several <span class="sc">gnats</span> mailing lists.  The most important ones
are:

     <dl>
<dt><a href="mailto:info-gnats@gnu.org">info-gnats@gnu.org</a><dd>Announcements and other important information about <span class="sc">gnats</span> and the
related software.  This is a very low volume moderated list.

     <br><dt><a href="mailto:bug-gnats@gnu.org">bug-gnats@gnu.org</a><dd>The bug reporting mailing list on the <span class="sc">gnats</span> itself.  Please note
that the preferred way to report <span class="sc">gnats</span> bugs is to submit them via
the web interface at
<a href="http://bugs.gnu.org/cgi-bin/gnatsweb.pl?database=gnats">http://bugs.gnu.org/cgi-bin/gnatsweb.pl?database=gnats</a>.  New bug
reports submitted via the web interface are copied to the mailing list
automatically.

     <br><dt><a href="mailto:help-gnats@gnu.org">help-gnats@gnu.org</a><dd>General discussion about <span class="sc">gnats</span>.  Anything related to <span class="sc">gnats</span>
(user questions, development, suggestions, etc.) can be discussed
there. 
</dl>

   <p>The complete list of <span class="sc">gnats</span> related mailing lists is available
from the web page at <a href="http://savannah.gnu.org/project/gnats">http://savannah.gnu.org/project/gnats</a>.

   <p><a name="index-bug-reporting-391"></a>When you report problems concerning <span class="sc">gnats</span> itself, please do not
forget to provide especially the following information:

     <ul>
<li>The <span class="sc">gnats</span> version you are using.

     <li>The <em>exact</em> way how to reproduce the bug.

     <li>Your configuration.

     <li>If you encounter a compilation or build problem, it is especially
important to mention the operating system, compiler and possibly other
build utilities you use. 
</ul>

   <p>Providing this information in the initial report avoids further
unnecessary communication, saves our limited development resources and
helps to track down and fix the problem soon.

<!-- =============================================================== -->
<div class="node">
<p><hr>
<a name="Index"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Support">Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Index</h2>

<ul class="index-cp" compact>
<li><a href="#index-_002d_002denable_002dgnats_002ddblist_002dfile-201">--enable-gnats-dblist-file</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002denable_002dgnats_002ddefault_002ddb-202">--enable-gnats-default-db</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002denable_002dgnats_002dservice-197">--enable-gnats-service</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002denable_002dgnats_002duser-198">--enable-gnats-user</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002denable_002dgnatsd_002dhost_002daccess_002dfile-200">--enable-gnatsd-host-access-file</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002denable_002dgnatsd_002duser_002daccess_002dfile-199">--enable-gnatsd-user-access-file</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002dwith_002dkerberos-203">--with-kerberos</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_002d_002dwith_002dkrb4-204">--with-krb4</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_0040code_007b_003eSubmitter_002dId_007d-123"><code>&gt;Submitter-Id</code></a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-_0040emph_007banalyzed_007d-state-26"><em>analyzed</em> state</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040emph_007bchange_002drequest_007d-class-73"><em>change-request</em> class</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bclosed_007d-state-30"><em>closed</em> state</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040emph_007bcritical_007d-severity-problems-62"><em>critical</em> severity problems</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bdoc_002dbug_007d-class-72"><em>doc-bug</em> class</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bduplicate_007d-class-75"><em>duplicate</em> class</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bfeedback_007d-state-28"><em>feedback</em> state</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040emph_007bhigh_007d-priority-problems-66"><em>high</em> priority problems</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007blow_007d-priority-problems-68"><em>low</em> priority problems</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bmedium_007d-priority-problems-67"><em>medium</em> priority problems</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bmistaken_007d-class-76"><em>mistaken</em> class</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bnon_002dcritical_007d-severity-problems-64"><em>non-critical</em> severity problems</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bopen_007d-state-23"><em>open</em> state</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040emph_007bserious_007d-severity-problems-63"><em>serious</em> severity problems</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bsupport_007d-class-74"><em>support</em> class</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040emph_007bsuspended_007d-state-33"><em>suspended</em> state</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040emph_007bsw_002dbug_007d-class-71"><em>sw-bug</em> class</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-adding-a-problem-category-337">adding a problem category</a>: <a href="#mkcat">mkcat</a></li>
<li><a href="#index-adding-a-problem-category-241">adding a problem category</a>: <a href="#Management">Management</a></li>
<li><a href="#index-adding-and-removing-maintainers-245">adding and removing maintainers</a>: <a href="#Management">Management</a></li>
<li><a href="#index-adding-another-database-239">adding another database</a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040code_007baddresses_007d-file-325"><code>addresses</code> file</a>: <a href="#addresses-file">addresses file</a></li>
<li><a href="#index-_0040code_007baddresses_007d-file-261"><code>addresses</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-admin-files-328">admin files</a>: <a href="#Admin-files">Admin files</a></li>
<li><a href="#index-administering-_0040sc_007bgnats_007d-234">administering <span class="sc">gnats</span></a>: <a href="#Management">Management</a></li>
<li><a href="#index-administrative-utilities-332">administrative utilities</a>: <a href="#Admin-utils">Admin utils</a></li>
<li><a href="#index-age-of-PR-365">age of PR</a>: <a href="#pr_002dage">pr-age</a></li>
<li><a href="#index-alias-for-incoming-Problem-Reports-220">alias for incoming Problem Reports</a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-aliases-216">aliases</a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-_0040code_007bappended_002demail_002dresponse_007d-314"><code>appended-email-response</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-_0040code_007barrival_002ddate_007d-279"><code>arrival-date</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bArrival_002dDate_007d-field-85"><code>Arrival-Date</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bat_007d-213"><code>at</code></a>: <a href="#Setting-up-the-default-database">Setting up the default database</a></li>
<li><a href="#index-_0040code_007bat_002dpr_007d-352"><code>at-pr</code></a>: <a href="#at_002dpr">at-pr</a></li>
<li><a href="#index-_0040code_007baudit_002dmail_007d-315"><code>audit-mail</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-_0040code_007baudit_002dtrail_007d-280"><code>audit-trail</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bAudit_002dTrail_007d-field-88"><code>Audit-Trail</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-Audit_002dtrail-format-307">Audit-trail format</a>: <a href="#Audit_002dtrail-formats">Audit-trail formats</a></li>
<li><a href="#index-_0040code_007bautoload_007d-commands-208"><code>autoload</code> commands</a>: <a href="#Installing-utils">Installing utils</a></li>
<li><a href="#index-automatic-notification-354">automatic notification</a>: <a href="#at_002dpr">at-pr</a></li>
<li><a href="#index-automatic-notification-22">automatic notification</a>: <a href="#States">States</a></li>
<li><a href="#index-BACK-UP-YOUR-DATA-249">BACK UP YOUR DATA</a>: <a href="#Management">Management</a></li>
<li><a href="#index-bad-Problem-Reports-124">bad Problem Reports</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-bug-alias-218">bug alias</a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-bug-reporting-391">bug reporting</a>: <a href="#Support">Support</a></li>
<li><a href="#index-building-a-new-index-246">building a new index</a>: <a href="#Management">Management</a></li>
<li><a href="#index-building-GNATS-185">building GNATS</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-building-in-a-different-directory-205">building in a different directory</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_0040code_007bbuiltin_002dname_007d-278"><code>builtin-name</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bbury_002dbuffer_007d-162"><code>bury-buffer</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bbusiness_002dday_002dhours_007d-273"><code>business-day-hours</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-_0040code_007bbusiness_002dweek_002ddays_007d-274"><code>business-week-days</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-_0040code_007bcategories_007d-file-342"><code>categories</code> file</a>: <a href="#rmcat">rmcat</a></li>
<li><a href="#index-_0040code_007bcategories_007d-file-339"><code>categories</code> file</a>: <a href="#mkcat">mkcat</a></li>
<li><a href="#index-_0040code_007bcategories_007d-file-319"><code>categories</code> file</a>: <a href="#categories-file">categories file</a></li>
<li><a href="#index-_0040code_007bcategories_007d-file-258"><code>categories</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bcategory_007d-281"><code>category</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bCategory_007d-field-69"><code>Category</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bcategory_002ddir_002dperms_007d-276"><code>category-dir-perms</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-_0040code_007bcheck_002ddb_007d-345"><code>check-db</code></a>: <a href="#check_002ddb">check-db</a></li>
<li><a href="#index-_0040code_007bClass_007d-field-70"><code>Class</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bclasses_007d-file-326"><code>classes</code> file</a>: <a href="#classes-file">classes file</a></li>
<li><a href="#index-_0040code_007bclasses_007d-file-263"><code>classes</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bclosed_002ddate_007d-282"><code>closed-date</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-command-line-options-109">command line options</a>: <a href="#send_002dpr-from-the-shell">send-pr from the shell</a></li>
<li><a href="#index-comment-section-in-the-PR-template-119">comment section in the PR template</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-compiling-the-software-188">compiling the software</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_0040code_007bconfidential_007d-283"><code>confidential</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bConfidential_007d-field-57"><code>Confidential</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-confidentiality-in-PRs-58">confidentiality in PRs</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bconfigure_007d-189"><code>configure</code></a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-configuring--GNATS-183">configuring  GNATS</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-configuring-and-compiling-the-software-187">configuring and compiling the software</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-configuring-_0040sc_007bgnats_007d-for-remote-users-230">configuring <span class="sc">gnats</span> for remote users</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-configuring-_0040sc_007bgnats_007d-on-a-local-network-228">configuring <span class="sc">gnats</span> on a local network</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-configuring-_0040sc_007bgnats_007d-on-a-network-226">configuring <span class="sc">gnats</span> on a network</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-_0040code_007bcreate_002dcategory_002ddirs_007d-275"><code>create-category-dirs</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-creating-an-account-for-the-_0040sc_007bgnats_007d-user-193">creating an account for the <span class="sc">gnats</span> user</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_0040code_007bcron_007d-212"><code>cron</code></a>: <a href="#Setting-up-the-default-database">Setting up the default database</a></li>
<li><a href="#index-_0040code_007bcrontab_007d-214"><code>crontab</code></a>: <a href="#Setting-up-periodic-jobs">Setting up periodic jobs</a></li>
<li><a href="#index-_0040code_007bcurrent_007d-file-331"><code>current</code> file</a>: <a href="#current-file">current file</a></li>
<li><a href="#index-daemon-222">daemon</a>: <a href="#Installing-the-daemon">Installing the daemon</a></li>
<li><a href="#index-database-paradigm-7">database paradigm</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-database-rationale-5">database rationale</a>: <a href="#Introduction">Introduction</a></li>
<li><a href="#index-database-similarities-37">database similarities</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-_0040file_007bdatabases_007d-253"><span class="file">databases</span></a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bdatabases_007d-file-265"><code>databases</code> file</a>: <a href="#databases-file">databases file</a></li>
<li><a href="#index-_0040code_007bdatatype_007d-296"><code>datatype</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-_0040code_007bdate_007d-303"><code>date</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-_0040code_007bDate_002dRequired_007d-86"><code>Date-Required</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bDate_002dRequired_007d-field-87"><code>Date-Required</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-dbconfig-387">dbconfig</a>: <a href="#dbconfig-recipes">dbconfig recipes</a></li>
<li><a href="#index-_0040code_007bdbconfig_007d-file-266"><code>dbconfig</code> file</a>: <a href="#dbconfig-file">dbconfig file</a></li>
<li><a href="#index-_0040code_007bdbconfig_007d-file-257"><code>dbconfig</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-dbconfig-mode-176">dbconfig mode</a>: <a href="#dbconfig-mode">dbconfig mode</a></li>
<li><a href="#index-_0040file_007bdbconfig_007d-recipes-388"><span class="file">dbconfig</span> recipes</a>: <a href="#dbconfig-recipes">dbconfig recipes</a></li>
<li><a href="#index-_0040code_007bdebug_002dmode_007d-268"><code>debug-mode</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-default-installation-locations-372">default installation locations</a>: <a href="#defaults">defaults</a></li>
<li><a href="#index-default-installation-locations-368">default installation locations</a>: <a href="#Locations">Locations</a></li>
<li><a href="#index-_0040file_007bdefaults_007d-254"><span class="file">defaults</span></a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bdeleted_002dpr_002dmail_007d-316"><code>deleted-pr-mail</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-_0040code_007bdescription_007d-284"><code>description</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bDescription_007d-field-79"><code>Description</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bdiff_002dprs_007d-363"><code>diff-prs</code></a>: <a href="#diff_002dprs">diff-prs</a></li>
<li><a href="#index-Direct-e_002dmail-127">Direct e-mail</a>: <a href="#Submitting-via-e_002dmail">Submitting via e-mail</a></li>
<li><a href="#index-disabling-_0040var_007bsubmitter_002did_007d-323">disabling <var>submitter-id</var></a>: <a href="#submitters-file">submitters file</a></li>
<li><a href="#index-driver-for-_0040code_007bedit_002dpr_007d-360">driver for <code>edit-pr</code></a>: <a href="#pr_002dedit">pr-edit</a></li>
<li><a href="#index-duties-for-_0040code_007bgnats_002dadmin_007d-237">duties for <code>gnats-admin</code></a>: <a href="#Management">Management</a></li>
<li><a href="#index-edit-controls-305">edit controls</a>: <a href="#Edit-controls">Edit controls</a></li>
<li><a href="#index-_0040code_007bedit_002dpr_007d-168"><code>edit-pr</code></a>: <a href="#Emacs-editing">Emacs editing</a></li>
<li><a href="#index-_0040code_007bedit_002dpr_007d-137"><code>edit-pr</code></a>: <a href="#edit_002dpr">edit-pr</a></li>
<li><a href="#index-_0040code_007bedit_002dpr_007d-driver-359"><code>edit-pr</code> driver</a>: <a href="#pr_002dedit">pr-edit</a></li>
<li><a href="#index-_0040code_007bedit_002dpr_007d-from-the-shell-138"><code>edit-pr</code> from the shell</a>: <a href="#edit_002dpr-from-the-shell">edit-pr from the shell</a></li>
<li><a href="#index-effective-problem-reporting-131">effective problem reporting</a>: <a href="#Helpful-hints">Helpful hints</a></li>
<li><a href="#index-Emacs-151">Emacs</a>: <a href="#Emacs">Emacs</a></li>
<li><a href="#index-Emacs-functions-210">Emacs functions</a>: <a href="#Installing-utils">Installing utils</a></li>
<li><a href="#index-Emacs-lisp-file-installation-192">Emacs lisp file installation</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-emptying-the-_0040code_007bpending_007d-directory-238">emptying the <code>pending</code> directory</a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040code_007benum_007d-299"><code>enum</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-_0040code_007benumerated_002din_002dfile_007d-301"><code>enumerated-in-file</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-_0040code_007bEnvironment_007d-field-78"><code>Environment</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-environment-variables-and-GNATS-tools-103">environment variables and GNATS tools</a>: <a href="#Environment">Environment</a></li>
<li><a href="#index-errors-125">errors</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-example-Problem-Report-40">example Problem Report</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-example-queries-150">example queries</a>: <a href="#Example-queries">Example queries</a></li>
<li><a href="#index-_0040var_007bexec_002dprefix_007d-370"><var>exec-prefix</var></a>: <a href="#exec_002dprefix">exec-prefix</a></li>
<li><a href="#index-_0040var_007bexec_002dprefix_007d-196"><var>exec-prefix</var></a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-Field-datatypes-295">Field datatypes</a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-field-format-50">field format</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-fields-38">fields</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-fields-_002d-list-51">fields - list</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bfile_002dpr_007d-350"><code>file-pr</code></a>: <a href="#file_002dpr">file-pr</a></li>
<li><a href="#index-files-used-for-_0040sc_007bgnats_007d-administration-329">files used for <span class="sc">gnats</span> administration</a>: <a href="#Admin-files">Admin files</a></li>
<li><a href="#index-final-state-_0028_0040dfn_007bclosed_007d_0029-32">final state (<dfn>closed</dfn>)</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040code_007bFix_007d-field-81"><code>Fix</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-flowchart-of-GNATS-activities-17">flowchart of GNATS activities</a>: <a href="#Flowchart">Flowchart</a></li>
<li><a href="#index-follow_002dup-via-email-139">follow-up via email</a>: <a href="#follow_002dup-via-email">follow-up via email</a></li>
<li><a href="#index-follow_002dup-via-email-97">follow-up via email</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-foreword-2">foreword</a>: <a href="#Top">Top</a></li>
<li><a href="#index-format-36">format</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-format-parameters-308">format parameters</a>: <a href="#Audit_002dtrail-formats">Audit-trail formats</a></li>
<li><a href="#index-_0040code_007bformat_002dname_007d-310"><code>format-name</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-_0040code_007bFrom_007d-header-46"><code>From</code> header</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-_0040code_007bgen_002dindex_007d-343"><code>gen-index</code></a>: <a href="#gen_002dindex">gen-index</a></li>
<li><a href="#index-_0040code_007bgen_002dindex_007d-247"><code>gen-index</code></a>: <a href="#Management">Management</a></li>
<li><a href="#index-GNATS-administrator-13">GNATS administrator</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-_0040sc_007bgnats_007d-configuration-250"><span class="sc">gnats</span> configuration</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-GNATS-database-fields-49">GNATS database fields</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-GNATS-fields-_002d-list-52">GNATS fields - list</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-GNATS-management-236">GNATS management</a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040sc_007bgnats_007d-support-389"><span class="sc">gnats</span> support</a>: <a href="#Support">Support</a></li>
<li><a href="#index-_0040var_007bgnats_002dadm_007d-371"><var>gnats-adm</var></a>: <a href="#gnats_002dadm">gnats-adm</a></li>
<li><a href="#index-_0040code_007bgnats_002dadmin_007d-alias-217"><code>gnats-admin</code> alias</a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-_0040code_007bgnats_002dapply_002dor_002dsubmit_007d-171"><code>gnats-apply-or-submit</code></a>: <a href="#Emacs-editing-buffer">Emacs editing buffer</a></li>
<li><a href="#index-_0040code_007bgnats_002dchange_002ddatabase_007d-173"><code>gnats-change-database</code></a>: <a href="#Emacs-and-databases">Emacs and databases</a></li>
<li><a href="#index-_0040code_007bgnats_002dchange_002ddatabase_007d-161"><code>gnats-change-database</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bgnats_002ddbconfig_002dmode_007d-177"><code>gnats-dbconfig-mode</code></a>: <a href="#dbconfig-mode">dbconfig mode</a></li>
<li><a href="#index-_0040code_007bgnats_002ddbconfig_002dmode_002dhook_007d-178"><code>gnats-dbconfig-mode-hook</code></a>: <a href="#dbconfig-mode">dbconfig mode</a></li>
<li><a href="#index-_0040var_007bgnats_002ddefault_002dorganization_007d-166"><var>gnats-default-organization</var></a>: <a href="#Emacs-submitting">Emacs submitting</a></li>
<li><a href="#index-_0040var_007bgnats_002ddefault_002dsubmitter_007d-167"><var>gnats-default-submitter</var></a>: <a href="#Emacs-submitting">Emacs submitting</a></li>
<li><a href="#index-_0040code_007bgnats_002dedit_002dmode_002dhook_007d-172"><code>gnats-edit-mode-hook</code></a>: <a href="#Emacs-editing-buffer">Emacs editing buffer</a></li>
<li><a href="#index-_0040code_007bgnats_002dnext_002dfield_007d-169"><code>gnats-next-field</code></a>: <a href="#Emacs-editing-buffer">Emacs editing buffer</a></li>
<li><a href="#index-_0040code_007bgnats_002dprevious_002dfield_007d-170"><code>gnats-previous-field</code></a>: <a href="#Emacs-editing-buffer">Emacs editing buffer</a></li>
<li><a href="#index-_0040code_007bgnats_002dpwconv_007d-346"><code>gnats-pwconv</code></a>: <a href="#gnats_002dpwconv">gnats-pwconv</a></li>
<li><a href="#index-_0040code_007bgnats_002dquery_002dedit_002dpr_007d-157"><code>gnats-query-edit-pr</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bgnats_002dquery_002dmode_002dhook_007d-164"><code>gnats-query-mode-hook</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bgnats_002dquery_002dreread_007d-158"><code>gnats-query-reread</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040var_007bgnats_002dquery_002dreverse_002dlisting_007d-163"><var>gnats-query-reverse-listing</var></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bgnats_002dquery_002dview_002dpr_007d-156"><code>gnats-query-view-pr</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bgnats_002dshow_002dconnection_007d-181"><code>gnats-show-connection</code></a>: <a href="#Other-Emacs-commands">Other Emacs commands</a></li>
<li><a href="#index-_0040code_007bgnats_002dview_002dedit_002dpr_007d-153"><code>gnats-view-edit-pr</code></a>: <a href="#Emacs-viewing">Emacs viewing</a></li>
<li><a href="#index-_0040code_007bgnats_002dview_002dmode_002dhook_007d-154"><code>gnats-view-mode-hook</code></a>: <a href="#Emacs-viewing">Emacs viewing</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-373"><code>gnatsd</code></a>: <a href="#gnatsd">gnatsd</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-command-protocol-377"><code>gnatsd</code> command protocol</a>: <a href="#gnatsd-command-protocol">gnatsd command protocol</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-commands-378"><code>gnatsd</code> commands</a>: <a href="#gnatsd-commands">gnatsd commands</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-description-374"><code>gnatsd</code> description</a>: <a href="#Description-of-gnatsd">Description of gnatsd</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-environment-variables-380"><code>gnatsd</code> environment variables</a>: <a href="#gnatsd-environment-variables">gnatsd environment variables</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-options-375"><code>gnatsd</code> options</a>: <a href="#gnatsd-options">gnatsd options</a></li>
<li><a href="#index-_0040code_007bgnatsd_007d-startup-options-376"><code>gnatsd</code> startup options</a>: <a href="#gnatsd-options">gnatsd options</a></li>
<li><a href="#index-gnatsd_002c-Emacs-174">gnatsd, Emacs</a>: <a href="#Emacs-and-databases">Emacs and databases</a></li>
<li><a href="#index-_0040file_007bgnatsd_002ehost_005faccess_007d-382"><span class="file">gnatsd.host_access</span></a>: <a href="#gnatsd_002ehost_005faccess">gnatsd.host_access</a></li>
<li><a href="#index-_0040file_007bgnatsd_002ehost_005faccess_007d-255"><span class="file">gnatsd.host_access</span></a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040file_007bgnatsd_002euser_005faccess_007d-383"><span class="file">gnatsd.user_access</span></a>: <a href="#gnatsd_002euser_005faccess">gnatsd.user_access</a></li>
<li><a href="#index-_0040file_007bgnatsd_002euser_005faccess_007d-256"><span class="file">gnatsd.user_access</span></a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bgnatsd_002euser_005faccess_007d-file-264"><code>gnatsd.user_access</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bGNATSDB_007d-381"><code>GNATSDB</code></a>: <a href="#gnatsd-environment-variables">gnatsd environment variables</a></li>
<li><a href="#index-_0040code_007bGNATSDB_007d-104"><code>GNATSDB</code></a>: <a href="#Environment">Environment</a></li>
<li><a href="#index-handling-incoming-traffic-349">handling incoming traffic</a>: <a href="#queue_002dpr">queue-pr</a></li>
<li><a href="#index-helpful-hints-129">helpful hints</a>: <a href="#Helpful-hints">Helpful hints</a></li>
<li><a href="#index-_0040code_007bHow_002dTo_002dRepeat_007d-field-80"><code>How-To-Repeat</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-incoming-alias-for-Problem-Reports-219">incoming alias for Problem Reports</a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-incoming-PRs-that-_0040sc_007bgnats_007d-cannot-parse-16">incoming PRs that <span class="sc">gnats</span> cannot parse</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-_0040code_007bindex_007d-file-344"><code>index</code> file</a>: <a href="#gen_002dindex">gen-index</a></li>
<li><a href="#index-_0040code_007bindex_007d-file-330"><code>index</code> file</a>: <a href="#index-file">index file</a></li>
<li><a href="#index-Index-file-description-317">Index file description</a>: <a href="#Index-file-description">Index file description</a></li>
<li><a href="#index-Individual-field-configuration-277">Individual field configuration</a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-information-to-submit-133">information to submit</a>: <a href="#Helpful-hints">Helpful hints</a></li>
<li><a href="#index-Initial-PR-input-fields-318">Initial PR input fields</a>: <a href="#Initial-PR-input-fields">Initial PR input fields</a></li>
<li><a href="#index-initial-state-_0028_0040dfn_007bopen_007d_0029-24">initial state (<dfn>open</dfn>)</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040code_007binitial_002dpr_002dnotification_007d-312"><code>initial-pr-notification</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-_0040code_007binitial_002dpr_002dnotification_002dpending_007d-313"><code>initial-pr-notification-pending</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-_0040code_007binitial_002dresponse_002dto_002dsubmitter_007d-311"><code>initial-response-to-submitter</code></a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-initializing-a-database-334">initializing a database</a>: <a href="#mkdb">mkdb</a></li>
<li><a href="#index-installing-GNATS-182">installing GNATS</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-installing-the-utilities-207">installing the utilities</a>: <a href="#Installing-utils">Installing utils</a></li>
<li><a href="#index-_0040code_007binteger_007d-304"><code>integer</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-interactive-interface-116">interactive interface</a>: <a href="#send_002dpr-in-Emacs">send-pr in Emacs</a></li>
<li><a href="#index-internal-utilities-347">internal utilities</a>: <a href="#Internal-utils">Internal utils</a></li>
<li><a href="#index-Internet-standard-RFC_002d822-43">Internet standard RFC-822</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-introduction-to-GNATS-3">introduction to GNATS</a>: <a href="#Introduction">Introduction</a></li>
<li><a href="#index-invalid-Problem-Reports-126">invalid Problem Reports</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-invoking-_0040code_007bedit_002dpr_007d-136">invoking <code>edit-pr</code></a>: <a href="#edit_002dpr">edit-pr</a></li>
<li><a href="#index-invoking-_0040code_007bquery_002dpr_007d-143">invoking <code>query-pr</code></a>: <a href="#query_002dpr">query-pr</a></li>
<li><a href="#index-invoking-_0040code_007bsend_002dpr_007d-107">invoking <code>send-pr</code></a>: <a href="#send_002dpr">send-pr</a></li>
<li><a href="#index-invoking-_0040code_007bsend_002dpr_007d-from-Emacs-115">invoking <code>send-pr</code> from Emacs</a>: <a href="#send_002dpr-in-Emacs">send-pr in Emacs</a></li>
<li><a href="#index-invoking-_0040code_007bsend_002dpr_007d-from-the-shell-110">invoking <code>send-pr</code> from the shell</a>: <a href="#send_002dpr-from-the-shell">send-pr from the shell</a></li>
<li><a href="#index-invoking-the-_0040sc_007bgnats_007d-user-tools-102">invoking the <span class="sc">gnats</span> user tools</a>: <a href="#GNATS-user-tools">GNATS user tools</a></li>
<li><a href="#index-_0040code_007bkeep_002dall_002dreceived_002dheaders_007d-269"><code>keep-all-received-headers</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-kinds-of-helpful-information-132">kinds of helpful information</a>: <a href="#Helpful-hints">Helpful hints</a></li>
<li><a href="#index-_0040code_007blast_002dmodified_007d-285"><code>last-modified</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007blibexecdir_007d-272"><code>libexecdir</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-life_002dcycle-of-a-Problem-Report-19">life-cycle of a Problem Report</a>: <a href="#States">States</a></li>
<li><a href="#index-lisp-file-installation-191">lisp file installation</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-loading-_0040code_007b_002eel_007d-files-209">loading <code>.el</code> files</a>: <a href="#Installing-utils">Installing utils</a></li>
<li><a href="#index-locations-366">locations</a>: <a href="#Locations">Locations</a></li>
<li><a href="#index-locks-362">locks</a>: <a href="#pr_002dedit">pr-edit</a></li>
<li><a href="#index-mail-aliases-215">mail aliases</a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-mail-header-fields-42">mail header fields</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-mail-header-section-120">mail header section</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-mailing-lists-390">mailing lists</a>: <a href="#Support">Support</a></li>
<li><a href="#index-maintenance-10">maintenance</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-_0040code_007bmake_007d-190"><code>make</code></a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-managing-_0040sc_007bgnats_007d-235">managing <span class="sc">gnats</span></a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040code_007bmkcat_007d-336"><code>mkcat</code></a>: <a href="#mkcat">mkcat</a></li>
<li><a href="#index-_0040code_007bmkcat_007d-242"><code>mkcat</code></a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040code_007bmkdb_007d-333"><code>mkdb</code></a>: <a href="#mkdb">mkdb</a></li>
<li><a href="#index-_0040code_007bmkdb_007d-240"><code>mkdb</code></a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040code_007bmulti_002denumerated_002din_002dfile_007d-302"><code>multi-enumerated-in-file</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-_0040code_007bmultienum_007d-300"><code>multienum</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-_0040code_007bmultitext_007d-298"><code>multitext</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-Named-query-definitions-306">Named query definitions</a>: <a href="#Named-query-definitions">Named query definitions</a></li>
<li><a href="#index-networks-224">networks</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-new-database-335">new database</a>: <a href="#mkdb">mkdb</a></li>
<li><a href="#index-new-problem-categories-338">new problem categories</a>: <a href="#mkcat">mkcat</a></li>
<li><a href="#index-notification-of-overdue-PRs-355">notification of overdue PRs</a>: <a href="#at_002dpr">at-pr</a></li>
<li><a href="#index-_0040code_007bnotify_002dabout_002dexpired_002dprs_007d-270"><code>notify-about-expired-prs</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-_0040code_007bNotify_002dList_007d-field-54"><code>Notify-List</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bnumber_007d-286"><code>number</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bNumber_007d-field-82"><code>Number</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040var_007bobjdir_007d-206"><var>objdir</var></a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-_0040code_007bOrganization_007d-field-56"><code>Organization</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007boriginator_007d-287"><code>originator</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bOriginator_007d-field-55"><code>Originator</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-Outgoing-email-formats-309">Outgoing email formats</a>: <a href="#Outgoing-email-formats">Outgoing email formats</a></li>
<li><a href="#index-Overall-database-configuration-267">Overall database configuration</a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-Overview-of-_0040sc_007bgnats_007d-configuration-251">Overview of <span class="sc">gnats</span> configuration</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-overview-to-GNATS-1">overview to GNATS</a>: <a href="#Top">Top</a></li>
<li><a href="#index-paradigm-6">paradigm</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-password_002c-Emacs-175">password, Emacs</a>: <a href="#Emacs-and-databases">Emacs and databases</a></li>
<li><a href="#index-_0040code_007bpending_007d-directory-14"><code>pending</code> directory</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-_0040code_007bpending_007d-file-320"><code>pending</code> file</a>: <a href="#categories-file">categories file</a></li>
<li><a href="#index-PR-confidentiality-59">PR confidentiality</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-PR-locks-361">PR locks</a>: <a href="#pr_002dedit">pr-edit</a></li>
<li><a href="#index-_0040code_007bpr_002dage_007d-364"><code>pr-age</code></a>: <a href="#pr_002dage">pr-age</a></li>
<li><a href="#index-_0040code_007bpr_002dedit_007d-358"><code>pr-edit</code></a>: <a href="#pr_002dedit">pr-edit</a></li>
<li><a href="#index-_0040var_007bprefix_007d-369"><var>prefix</var></a>: <a href="#prefix">prefix</a></li>
<li><a href="#index-_0040var_007bprefix_007d-195"><var>prefix</var></a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-prepare-_0040file_007bsend_002dpr_002econf_007d-211">prepare <span class="file">send-pr.conf</span></a>: <a href="#Installing-utils">Installing utils</a></li>
<li><a href="#index-_0040code_007bpriority_007d-288"><code>priority</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bPriority_007d-field-65"><code>Priority</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-Problem-Report-format-35">Problem Report format</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-Problem-Report-states-21">Problem Report states</a>: <a href="#States">States</a></li>
<li><a href="#index-Problem-Report-template-41">Problem Report template</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-processing-incoming-traffic-351">processing incoming traffic</a>: <a href="#file_002dpr">file-pr</a></li>
<li><a href="#index-pruning-log-files-248">pruning log files</a>: <a href="#Management">Management</a></li>
<li><a href="#index-query-expressions-149">query expressions</a>: <a href="#Query-expressions">Query expressions</a></li>
<li><a href="#index-_0040code_007bquery_002dpr_007d-155"><code>query-pr</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bquery_002dpr_007d-144"><code>query-pr</code></a>: <a href="#query_002dpr">query-pr</a></li>
<li><a href="#index-_0040code_007bquery_002dpr_007d-by-mail-146"><code>query-pr</code> by mail</a>: <a href="#Invoking-query_002dpr">Invoking query-pr</a></li>
<li><a href="#index-query_002dpr-output-format-148">query-pr output format</a>: <a href="#Formatting-query_002dpr-output">Formatting query-pr output</a></li>
<li><a href="#index-querying-individual-problem-reports-145">querying individual problem reports</a>: <a href="#query_002dpr">query-pr</a></li>
<li><a href="#index-querying-using-regexps-384">querying using regexps</a>: <a href="#Regexps">Regexps</a></li>
<li><a href="#index-_0040code_007bqueue_002dpr_007d-348"><code>queue-pr</code></a>: <a href="#queue_002dpr">queue-pr</a></li>
<li><a href="#index-_0040code_007bqueue_002dpr-_002dq_007d-221"><code>queue-pr -q</code></a>: <a href="#Aliases">Aliases</a></li>
<li><a href="#index-rationale-4">rationale</a>: <a href="#Introduction">Introduction</a></li>
<li><a href="#index-_0040code_007bReceived_002dBy_007d-headers-48"><code>Received-By</code> headers</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-regular-expressions-385">regular expressions</a>: <a href="#Regexps">Regexps</a></li>
<li><a href="#index-related-mail-141">related mail</a>: <a href="#follow_002dup-via-email">follow-up via email</a></li>
<li><a href="#index-related-mail-99">related mail</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bRelease_007d-field-77"><code>Release</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-reminder-message-356">reminder message</a>: <a href="#at_002dpr">at-pr</a></li>
<li><a href="#index-removing-a-problem-category-341">removing a problem category</a>: <a href="#rmcat">rmcat</a></li>
<li><a href="#index-removing-a-problem-category-243">removing a problem category</a>: <a href="#Management">Management</a></li>
<li><a href="#index-_0040code_007bReply_002dTo_007d-header-47"><code>Reply-To</code> header</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-Report-all-the-facts_0021-134">Report all the facts!</a>: <a href="#Helpful-hints">Helpful hints</a></li>
<li><a href="#index-reporting-problems-with-_0040code_007bsend_002dpr_007d-108">reporting problems with <code>send-pr</code></a>: <a href="#send_002dpr">send-pr</a></li>
<li><a href="#index-_0040code_007bresponsible_007d-289"><code>responsible</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bResponsible_007d-field-84"><code>Responsible</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bresponsible_007d-file-321"><code>responsible</code> file</a>: <a href="#responsible-file">responsible file</a></li>
<li><a href="#index-_0040code_007bresponsible_007d-file-259"><code>responsible</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-_0040code_007bResponsible_002dChanged_002d_003cFrom_003e_002d_003cTo_003e_007d-in-_0040code_007bAudit_002dTrail_007d-90"><code>Responsible-Changed-&lt;From&gt;-&lt;To&gt;</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bResponsible_002dChanged_002dBy_007d-in-_0040code_007bAudit_002dTrail_007d-92"><code>Responsible-Changed-By</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bResponsible_002dChanged_002dWhen_007d-in-_0040code_007bAudit_002dTrail_007d-94"><code>Responsible-Changed-When</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bResponsible_002dChanged_002dWhy_007d-in-_0040code_007bAudit_002dTrail_007d-96"><code>Responsible-Changed-Why</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007brmcat_007d-340"><code>rmcat</code></a>: <a href="#rmcat">rmcat</a></li>
<li><a href="#index-_0040code_007brmcat_007d-244"><code>rmcat</code></a>: <a href="#Management">Management</a></li>
<li><a href="#index-sample-Problem-Report-39">sample Problem Report</a>: <a href="#Fields">Fields</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_007d-165"><code>send-pr</code></a>: <a href="#Emacs-submitting">Emacs submitting</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_007d-160"><code>send-pr</code></a>: <a href="#Emacs-querying">Emacs querying</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_007d-105"><code>send-pr</code></a>: <a href="#send_002dpr">send-pr</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_007d-fields-121"><code>send-pr</code> fields</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_007d-fields-112"><code>send-pr</code> fields</a>: <a href="#send_002dpr-from-the-shell">send-pr from the shell</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_007d-within-Emacs-114"><code>send-pr</code> within Emacs</a>: <a href="#send_002dpr-in-Emacs">send-pr in Emacs</a></li>
<li><a href="#index-_0040code_007bsend_002dpr_002econf_007d-file-327"><code>send-pr.conf</code> file</a>: <a href="#send_002dpr_002econf-file">send-pr.conf file</a></li>
<li><a href="#index-_0040code_007bsend_002dsubmitter_002dack_007d-271"><code>send-submitter-ack</code></a>: <a href="#Overall-database-configuration">Overall database configuration</a></li>
<li><a href="#index-setting-up-GNATS-184">setting up GNATS</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-_0040code_007bseverity_007d-290"><code>severity</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bSeverity_007d-field-61"><code>Severity</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-shell-invocation-111">shell invocation</a>: <a href="#send_002dpr-from-the-shell">send-pr from the shell</a></li>
<li><a href="#index-Site-wide-configuration-files-252">Site wide configuration files</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-so-what-does-it-do-11">so what does it do</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-_0040code_007bstate_007d-291"><code>state</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bState_007d-field-83"><code>State</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-state_002d_002d_002d_0040dfn_007banalyzed_007d-27">state---<dfn>analyzed</dfn></a>: <a href="#States">States</a></li>
<li><a href="#index-state_002d_002d_002d_0040dfn_007bclosed_007d-31">state---<dfn>closed</dfn></a>: <a href="#States">States</a></li>
<li><a href="#index-state_002d_002d_002d_0040dfn_007bfeedback_007d-29">state---<dfn>feedback</dfn></a>: <a href="#States">States</a></li>
<li><a href="#index-state_002d_002d_002d_0040dfn_007bopen_007d-25">state---<dfn>open</dfn></a>: <a href="#States">States</a></li>
<li><a href="#index-state_002d_002d_002d_0040dfn_007bsuspended_007d-34">state---<dfn>suspended</dfn></a>: <a href="#States">States</a></li>
<li><a href="#index-_0040code_007bState_002dChanged_002d_003cFrom_003e_002d_003cTo_003e_007d-in-_0040code_007bAudit_002dTrail_007d-89"><code>State-Changed-&lt;From&gt;-&lt;To&gt;</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bState_002dChanged_002dBy_007d-in-_0040code_007bAudit_002dTrail_007d-91"><code>State-Changed-By</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bState_002dChanged_002dWhen_007d-in-_0040code_007bAudit_002dTrail_007d-93"><code>State-Changed-When</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bState_002dChanged_002dWhy_007d-in-_0040code_007bAudit_002dTrail_007d-95"><code>State-Changed-Why</code> in <code>Audit-Trail</code></a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bstates_007d-file-324"><code>states</code> file</a>: <a href="#states-file">states file</a></li>
<li><a href="#index-_0040code_007bstates_007d-file-262"><code>states</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-states-of-Problem-Reports-20">states of Problem Reports</a>: <a href="#States">States</a></li>
<li><a href="#index-_0040code_007bSubject_007d-header-45"><code>Subject</code> header</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-_0040code_007bsubmitter_002did_007d-292"><code>submitter-id</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bSubmitter_002dId_007d-field-122"><code>Submitter-Id</code> field</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-_0040code_007bSubmitter_002dId_007d-field-53"><code>Submitter-Id</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bsubmitters_007d-file-322"><code>submitters</code> file</a>: <a href="#submitters-file">submitters file</a></li>
<li><a href="#index-_0040code_007bsubmitters_007d-file-260"><code>submitters</code> file</a>: <a href="#GNATS-configuration">GNATS configuration</a></li>
<li><a href="#index-Submitting-a-PR-via-e_002dmail-128">Submitting a PR via e-mail</a>: <a href="#Submitting-via-e_002dmail">Submitting via e-mail</a></li>
<li><a href="#index-subsequent-mail-140">subsequent mail</a>: <a href="#follow_002dup-via-email">follow-up via email</a></li>
<li><a href="#index-subsequent-mail-98">subsequent mail</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-support-site-9">support site</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-_0040code_007bsynopsis_007d-293"><code>synopsis</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bSynopsis_007d-field-60"><code>Synopsis</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-syntax-of-regexps-386">syntax of regexps</a>: <a href="#Regexps">Regexps</a></li>
<li><a href="#index-template-117">template</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-template-comment-section-118">template comment section</a>: <a href="#PR-template">PR template</a></li>
<li><a href="#index-_0040code_007btext_007d-297"><code>text</code></a>: <a href="#Field-datatypes">Field datatypes</a></li>
<li><a href="#index-the-section-on-query_002dby_002dmail-needs-to-be-relocated-147">the section on query-by-mail needs to be relocated</a>: <a href="#Invoking-query_002dpr">Invoking query-pr</a></li>
<li><a href="#index-timely-reminders-353">timely reminders</a>: <a href="#at_002dpr">at-pr</a></li>
<li><a href="#index-_0040code_007bTo_007d-header-44"><code>To</code> header</a>: <a href="#Mail-header-fields">Mail header fields</a></li>
<li><a href="#index-_0040code_007bunformatted_007d-294"><code>unformatted</code></a>: <a href="#Individual-field-configuration">Individual field configuration</a></li>
<li><a href="#index-_0040code_007bUnformatted_007d-field-100"><code>Unformatted</code> field</a>: <a href="#Problem-Report-fields">Problem Report fields</a></li>
<li><a href="#index-_0040code_007bunlock_002ddatabase_007d-180"><code>unlock-database</code></a>: <a href="#Other-Emacs-commands">Other Emacs commands</a></li>
<li><a href="#index-_0040code_007bunlock_002dpr_007d-179"><code>unlock-pr</code></a>: <a href="#Other-Emacs-commands">Other Emacs commands</a></li>
<li><a href="#index-unpacking-the-distribution-186">unpacking the distribution</a>: <a href="#Configure-and-make">Configure and make</a></li>
<li><a href="#index-unparseable-incoming-PRs-15">unparseable incoming PRs</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-upgrade_002c-procedure-233">upgrade, procedure</a>: <a href="#Upgrading">Upgrading</a></li>
<li><a href="#index-upgrading-from-older-versions-231">upgrading from older versions</a>: <a href="#Upgrading">Upgrading</a></li>
<li><a href="#index-upgrading_002c-overview-232">upgrading, overview</a>: <a href="#Upgrading">Upgrading</a></li>
<li><a href="#index-usage-for-the-_0040sc_007bgnats_007d-user-tools-101">usage for the <span class="sc">gnats</span> user tools</a>: <a href="#GNATS-user-tools">GNATS user tools</a></li>
<li><a href="#index-Using-and-Porting-_0040sc_007bgnu_007d-CC-130">Using and Porting <span class="sc">gnu</span> CC</a>: <a href="#Helpful-hints">Helpful hints</a></li>
<li><a href="#index-using-_0040code_007bedit_002dpr_007d-135">using <code>edit-pr</code></a>: <a href="#edit_002dpr">edit-pr</a></li>
<li><a href="#index-using-_0040sc_007bgnats_007d-over-a-local-network-227">using <span class="sc">gnats</span> over a local network</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-using-_0040sc_007bgnats_007d-over-a-network-225">using <span class="sc">gnats</span> over a network</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-using-_0040sc_007bgnats_007d-over-a-network-223">using <span class="sc">gnats</span> over a network</a>: <a href="#Installing-the-daemon">Installing the daemon</a></li>
<li><a href="#index-using-_0040sc_007bgnats_007d-remotely-229">using <span class="sc">gnats</span> remotely</a>: <a href="#Installing-tools">Installing tools</a></li>
<li><a href="#index-using-_0040code_007bquery_002dpr_007d-142">using <code>query-pr</code></a>: <a href="#query_002dpr">query-pr</a></li>
<li><a href="#index-using-_0040code_007bsend_002dpr_007d-106">using <code>send-pr</code></a>: <a href="#send_002dpr">send-pr</a></li>
<li><a href="#index-using-_0040code_007bsend_002dpr_007d-from-within-Emacs-113">using <code>send-pr</code> from within Emacs</a>: <a href="#send_002dpr-in-Emacs">send-pr in Emacs</a></li>
<li><a href="#index-_0040code_007bview_002dpr_007d-152"><code>view-pr</code></a>: <a href="#Emacs-viewing">Emacs viewing</a></li>
<li><a href="#index-visual-map-of-data-flow-18">visual map of data flow</a>: <a href="#Flowchart">Flowchart</a></li>
<li><a href="#index-what-is-a-PR-12">what is a PR</a>: <a href="#Paradigm">Paradigm</a></li>
<li><a href="#index-where-_0040sc_007bgnats_007d-lives-367">where <span class="sc">gnats</span> lives</a>: <a href="#Locations">Locations</a></li>
<li><a href="#index-why-GNATS-8">why GNATS</a>: <a href="#Paradigm">Paradigm</a></li>
   </ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> If typing
<span class="samp">M-x&nbsp;send-pr</span><!-- /@w --> doesn't work, see your system administrator for
help loading <span class="file">gnats.el</span> into Emacs.</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> Upgraders from
older versions of <span class="sc">gnats</span> should note that category directories are
now created &ldquo;on-the-fly&rdquo; as needed by default.</p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> This approach may seem heavy-handed, but
it ensures that changes are not overwritten.</p>

   <p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> DES crypt is the standard password encryption
format used by most UNIX systems</p>

   <p class="footnote"><small>[<a name="fn-5" href="#fnd-5">5</a>]</small> MD5 is
only supported on platforms that have a <code>crypt()</code> function that
supports MD5. Among others, this currently includes <span class="sc">gnu</span> Linux and
OpenBSD.</p>

   <p class="footnote"><small>[<a name="fn-6" href="#fnd-6">6</a>]</small> Some systems support even more encryption
methods.  In FreeBSD, for instance, a prefix of <span class="samp">$2$</span> implies
Blowfish encoding.  <span class="sc">gnats</span> will happily accept any encryption that
the OS supports.</p>

   <p><hr></div>

</body></html>

